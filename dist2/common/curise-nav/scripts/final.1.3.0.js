function hot520(){function e(e){return'<span class="comm_cut none"><span class="comm_mian"><span class="comm_s"></span><em>'+e+"</em></span></span>"}var i="",t=(new Date).getTime(),s=new Date("2016/07/01").getTime();if(s>t){var a='即日起至6月30日凡购买同程邮轮任意产品,成功付款购买后将获得孝心口令，凭该口令在善诊公众号可以免费预约价值235元的健康体检，快来送爸妈（45周岁以上）一份守护。<a href="http://www.ly.com/news/detail-64433.html" target="_blank">查看详情</a>';i+='<p class="other_h"><span class="price_yh">促销优惠：<span class="other_a">买邮轮送体检'+e(a)+"</span></span></p>"}fish.one(".pr_mg").html("top",i)}function make_canael(e){var i=fish.one("#calendar_wrapper").attr("attr-url");fish.one(".calendar_wrapper").calendar({url:i+"&startdate={startdate}&enddate={enddate}&year={year}&month={month}",getMonthData:processData,getDayData:makeItem,click:function(i,t,s,a){var n=fish.one("#HidLineid").val(),o=(fish.one(this).attr("data-date"),"/youlun/linebook/"+n+"_"+t+"-"+s+"-"+a+".html");window.open(o.addParams(e))},clickable:function(e){return e&&e.price?0!=parseInt(e.price,10):!1}})}function processData(e){for(var i=[],t=1;31>=t;t++)i.push({price:0,day:t,shipname:0});for(var s=e.PriceList.length,t=0;s>t;t++){var a=new Date(fish.parseDate(e.PriceList[t].date)),n=parseInt(a.getDate())-1;i[n].price=e.PriceList[t].price}return i}function makeItem(e){var i="";return e&&e.price?0!=parseInt(e.price,10)&&(i='<div class="mcalpricebox"><span class="Yday_price">&yen;<strong>'+parseInt(e.price)+"</strong></span>起</div>"):i="",i}function GetQueryString(e){var i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(i);return null!=t?unescape(t[2]):null}function stringFromJson(e){var i="";for(var t in e)i+=t+"="+e[t]+"&";return i.substring(0,i.length-1)}!function(){function e(e){var i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),t=window.location.search.substr(1).match(i);return null!=t?unescape(t[2]):null}var i=e("refid"),t=e("Ip"),s=fish.one("#HidLineid").val();null!=i&&null!=t&&fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=AddMembersRecommendByCn",data:"lineId="+s+"&ouserId="+i+"&ShareIp="+t,type:"json",fn:function(e){}})}(),function(){function e(e){return this.DEFAULT={startTime:i?i:fish.one("#calendar_top li.on").attr("s_date"),endTime:"",time:"",showing_time:"",showing_time_begin:"",showing_time_end:"",prev_disabled:!1,next_disabled:!1,item_height:0,item_width:0},this.cache={datas:{},days:{},items:{}},this.getMonthData=function(e,i,t){return e.data},this.getDayData=function(e,i,t,s){return""},this.checkClickable=function(e,i,t,s){var a=fish.parseTime(i+"-"+t+"-"+s);return fish.parseDate(this.startTime).getTime()<=fish.parseDate(a).getTime()&&(this.endTime?fish.parseDate(a).getTime()<=fish.parseDate(this.endTime).getTime():!0)&&this.clickable(e,i,t,s)},this.clickable=function(e,i,t,s){return!0},e=fish.lang.extend(this.DEFAULT,e),this.init(e)}current=0,fish.extend({calendar:function(i){return this&&this.length?(i=i||{},i.target=this,new e(i)):void 0}});var i=fish.one("#calendar_wrapper").attr("attr_first");e.prototype={init:function(e){fish.lang.extend(this,e),this.render()},target:null,wrapper:null,render:function(){this.wrapper=fish.create('<div class="calendar"><div class="calendar_body"> <a href="#" class="btn prev"></a> <a href="#" class="btn next"></a><div class="calendar_items"> </div> </div> </div>');var e=this.time||this.startTime;if(this.time&&!this.isSameMonth(this.time,this.startTime)){var i=fish.parseDate(e);e=i.getFullYear()+"-"+(i.getMonth()+1)+"-01"}else this.time&&this.isSameMonth(this.time,this.startTime)&&(e=this.startTime);var t=fish.one("#calendar_top li.on").attr("s_date"),s=fish.one("#calendar_top li.on").attr("e_date");fish.all(".calendar_items",this.wrapper).append(this.renderItem(e,t,s)),function(e){fish.all(".prev",e.wrapper).on("click",function(i){fish.preventDefault(i),e.prev()}),fish.all(".next",e.wrapper).on("click",function(i){fish.preventDefault(i),e.next()})}(this),this.target.append(this.wrapper),this.setShowingTime(e),this.setBtnsStatus(),this.setItemHeight()},renderItem:function(e,i,t,s){var a=fish.create('<div class="calendar_item"></div>');return a.append(this.renderMonths(e,i,t,s))},renderMonths:function(e,i,t,s){var a=fish.create('<div class="calendar_months"></div>'),n=fish.parseDate(e);return a.append(this.renderMonth(n.getFullYear()+"-"+(n.getMonth()+1)+"-01",s)),this.updateCache("items",n.getFullYear()+"-"+(n.getMonth()+1)+"-01",!0),this.getData(n.getFullYear(),n.getMonth()+1,i,t),a},renderMonth:function(e,i,t,s){t=t||!1,s=void 0==s?!0:s,date=fish.parseDate(e);for(var a=date.getDay(),n=date.getDate(),o=new Date(date.getFullYear(),date.getMonth()+1,0).getDate(),l=date.getFullYear(),r=date.getMonth()+1,c=r+1>12?l+1:l,h=r+2>12?l+1:l,d=r+3>12?l+1:l,f=r+1>12?r-11:r+1,p=r+2>12?r-10:r+2,u=r+3>12?r-9:r+3,m='<table class="calendar_left"><tbody><tr><td attr="'+l+"-"+r+'-01" class="on">'+l+"年"+r+'月</td><td attr="'+c+"-"+f+'-01">'+c+"年"+f+'月</td><td attr="'+h+"-"+p+'-01">'+h+"年"+p+'月</td><td attr="'+d+"-"+u+'-01">'+d+"年"+u+"月</td></tr></tbody></table>",v="",_=0,g=fish.all(".calendar_left td"),C=0;4>C;C++)fish.one(g[C]).hasClass("on")&&(_=C+1);if(1==i){var y=fish.dom(".calendar_left").outerHTML;m=y}var b=n,w=1,x=1;count_date=fish.parseTime(e,{days:-a});for(var i=0;(s?6:3)>i;i++){var k="";for(C=0;7>C;C++){var T;0==i&&a>C?T="<td></td>":x>a&&o>=b?(T='<td><a href="#" data-date="'+count_date+'"><span class="date">'+(this.renderDate(count_date)||b)+'</span><span class="data"></span></a></td>',b++):t?(T='<td class="out_of_month"><a href="#" data-date="'+count_date+'"><span class="date">'+(this.renderDate(count_date)||w)+'</span><span class="data"></span></a></td>',w++):T='<td class="out_of_month"></td>',count_date=fish.parseTime(count_date,{days:1}),x++,k+=T}k="<tr>"+k+"</tr>",v+=k}v='<table class="calendar_right"><tbody><tr><th>日</th><th>一</th> <th>二</th> <th>三</th> <th>四</th> <th>五</th> <th>六</th></tr>'+v+"</tbody></table>",calendar_month=fish.create('<div class="calendar_month '+(this.isCurrentMonth(e)?"current_month":"")+' ">'+m+v+"</div>");for(var I=fish.all("a",calendar_month),i=0;i<I.length;i++)this.updateCache("day elem",fish.one(I[i]).attr("data-date"),fish.one(I[i]));return calendar_month},isCurrentMonth:function(e){var i=fish.parseDate(e),t=fish.parseDate(this.startTime);return t.getFullYear()==i.getFullYear()&&t.getMonth()==i.getMonth()},timeIsSingleMode:function(e){var i=fish.parseDate(e),t=new Date(i.getFullYear(),i.getMonth()+1,0).getDate()-i.getDate()+1;return Math.ceil((t+i.getDay())/7)>3},updateCache:function(e,i,t){var s=fish.parseDate(i),a=s.getFullYear(),n=s.getMonth()+1,o=s.getDate();if("day elem"==e){var l=a+"-"+n,r=this.cache.days;r[l]=r[l]||{},r[l][o]=r[l][o]||{elems:[],data:{}},r[l][o].elems.push(fish.dom(t))}else if("day data"==e){var l=a+"-"+n,r=this.cache.days;r[l]=r[l]||{},r[l][o]=r[l][o]||{elems:[],data:{}},r[l][o].data.push(t)}else if("datas"==e){var l=a+"-"+n,c=this.cache.datas;c[l]=t}else"items"==e&&(this.cache.items[i]=t)},getCache:function(e,i){var t=fish.parseDate(i),s=t.getFullYear(),a=t.getMonth()+1,n=t.getDate(),o=null;return"datas"==e?o=this.cache.datas[i]:"days"==e?this.cache.days[s+"-"+a]&&this.cache.days[s+"-"+a][n]&&(o=this.cache.days[s+"-"+a][n]):"day elems"==e?this.cache.days[s+"-"+a]&&this.cache.days[s+"-"+a][n]&&(o=this.cache.days[s+"-"+a][n],o=fish.all(o.elems)):"day data"==e?this.cache.days[s+"-"+a]&&this.cache.days[s+"-"+a][n]&&(o=this.cache.days[s+"-"+a][n],o=o.data):"items"==e&&(o=this.cache.items[i]),o},isEmpty:function(){},renderDate:function(e){var i="";return fish.parseTime()==fish.parseTime(e)&&(i="今天"),i||this.timeToFestival(e)},timeToFestival:function(e){for(var i=[{date:"2015-01-01",name:"元旦"},{date:"2015-02-19",name:"春节"},{date:"2015-04-04",name:"清明节"},{date:"2015-05-01",name:"劳动节"},{date:"2015-06-20",name:"端午节"},{date:"2015-09-27",name:"中秋节"},{date:"2015-10-01",name:"国庆节"}],t=0;t<i.length;t++)if(i[t].date==e)return i[t].name},getData:function(e,i,t,s){var a=this.url.replace("{startdate}",t).replace("{enddate}",s).replace("{year}",e).replace("{month}",i),n=this.getCache("datas",e+"-"+i+"-01");if(n){if("loading"==n)return;return void this.processMonthData(this.getMonthData(n,e,i),e,i)}!function(e,i,t){e.updateCache("datas",i+"-"+t+"-01","loading"),fish.ajax({url:a,type:"json",fn:function(s){e.updateCache("datas",i+"-"+t+"-01",s),e.processMonthData(e.getMonthData(s,i,t),i,t);var a=fish.one("#calendar_wrapper").attr("attrpromotion-url"),n=fish.one("#calendar_top li.on").attr("s_date"),o=fish.one("#calendar_top li.on").attr("e_date");fish.ajax({url:a,data:"startdate="+n+"&enddate="+o,type:"json",fn:function(e){if(e.PromotiondateList.length>0)for(var i=0,t=e.PromotiondateList.length;t>i;i++)for(var s=e.PromotiondateList[i].Promotiondate,a=0,n=fish.all(".calendar_right a").length;n>a;a++)if(s==fish.one(fish.all(".calendar_right a")[a]).attr("data-date")){var o=fish.one(fish.all(".calendar_right a")[a]);fish.one(".mcalpricebox",o).html("top","<span class='sale'>惠</span>")}}});for(var l=fish.all("#calendar_top li").length,r=0;l>r;r++)fish.all("#calendar_top li")[r].onclick=function(i){fish.preventDefault(i);var t=fish.getTarget(i);e.changeMonth(t),fish.all("#calendar_top li").removeClass("on"),fish.one(this).addClass("on")};var c=Math.ceil(fish.all("#calendar_top li").length/4);fish.one("#calendar_top .next")[0].onclick=function(i){if(!fish.one(this).hasClass("disabled")){if(current<c-1){current++,fish.one("#calendar_top ul").anim("left:"+-483*current+"px;"),fish.one("#calendar_top .prev").removeClass("disabled"),fish.all("#calendar_top li").removeClass("on"),fish.preventDefault(i);var t=fish.all("#calendar_top li")[4*current];e.changeMonth(t),fish.one(fish.all("#calendar_top li")[4*current]).addClass("on")}current>=c-1&&fish.one(this).addClass("disabled")}},fish.one("#calendar_top .prev")[0].onclick=function(i){if(!fish.one(this).hasClass("disabled")){if(current>=0){current--,fish.one("#calendar_top ul").anim("left:"+-483*current+"px;"),fish.one("#calendar_top .next").removeClass("disabled"),fish.all("#calendar_top li").removeClass("on"),fish.preventDefault(i);var t=fish.all("#calendar_top li")[4*current];e.changeMonth(t),fish.one(fish.all("#calendar_top li")[4*current]).addClass("on")}0==current&&fish.one(this).addClass("disabled")}}}})}(this,e,i)},processMonthData:function(e,i,t){for(var s=(new Date(i,t,0).getDate(),0);s<e.length;s++){var a=s+1;if(day_datas=this.cache.days[i+"-"+t][a],day_elems=null,day_data=null,day_datas){day_elems=fish.all(day_datas.elems),day_data=day_datas.data=e[s];for(var n=0;n<day_elems.length;n++){var o=fish.one(day_elems[n]);this.processDayClass(o,day_data,i,t,a),fish.one(".data",o).html(this.getDayData(day_data,i,t,a)),function(e,i){fish.one(i).on("click",function(i){fish.preventDefault(i);var t=fish.one(this).attr("data-date"),s=fish.parseDate(t),a=s.getFullYear(),n=s.getMonth()+1,o=s.getDate(),l=e.cache.days[a+"-"+n][o].data;e.beforeClick(l,a,n,o)&&e.click(l,a,n,o)}),fish.one(i).hover(function(){fish.one(this).addClass("hover")},function(){fish.one(this).removeClass("hover")})}(this,o)}}}},processDayClass:function(e,i,t,s,a){this.checkClickable(i,t,s,a)?e.addClass("enabled").removeClass("disabled"):e.addClass("disabled").removeClass("enabled");var n=fish.parseTime(t+"-"+s+"-"+a),o=fish.parseDate(n);fish.parseTime()==n&&e.addClass("today"),this.time==n&&e.addClass("active"),0!=o.getDay()&&6!=o.getDay()||e.addClass("festival"),"undefined"!=typeof this.timeToFestival(n)&&e.addClass("chinfestival")},beforeClick:function(e,i,t,s){var a=fish.parseTime(i+"-"+t+"-"+s);return this.checkClickable(e,i,t,s)?(this.time&&this.getCache("day elems",this.time).removeClass("active"),this.time=a,this.getCache("day elems",this.time).addClass("active"),!0):!1},setShowingTime:function(e){this.showing_time=e?fish.parseTime(e):this.startTime},setItemHeight:function(){this.item_width=this.item_width||fish.one(".calendar_item",this.wrapper).width()||parseInt(fish.one(".calendar_item",this.wrapper).getCss("width"))},next:function(){if(!this.next_disabled){var e=this.showing_time,i=e.split("-"),t=i[0]+"-"+(parseInt(i[1])+1)+"-01",s=fish.one(".calendar_items",this.wrapper),a=fish.one("#calendar_top li.on").attr("s_date"),n=fish.one("#calendar_top li.on").attr("e_date");s.html("").append(this.renderItem(t,a,n,0)),this.showing_time=t,this.setBtnsStatus()}},goThatMonth:function(e){var i=fish.one(e).attr("attr"),t=i.split("-"),s=t[0]+"-"+parseInt(t[1])+"-01",a=fish.all(".calendar_items",this.wrapper),n=fish.one("#calendar_top li.on").attr("s_date"),o=fish.one("#calendar_top li.on").attr("e_date");fish.one(e).hasClass("on")||(a.append(this.renderItem(s,n,o,1)),fish.one(".calendar_item").html("remove"),this.showing_time=s,this.setBtnsStatus())},prev:function(){if(!this.prev_disabled){var e=this.showing_time,i=fish.parseDate(e,{months:-1}),t="",s=fish.all(".calendar_items",this.wrapper),a=fish.one("#calendar_top li.on").attr("s_date"),n=fish.one("#calendar_top li.on").attr("e_date");t=i.getFullYear()!=fish.parseDate(this.startTime).getFullYear()||i.getMonth()!=fish.parseDate(this.startTime).getMonth()||this.timeIsSingleMode(this.startTime)?i.getFullYear()+"-"+(i.getMonth()+1)+"-01":this.startTime,s.html("").append(this.renderItem(t,a,n,2)),this.showing_time=t,this.setBtnsStatus()}},changeMonth:function(e){var i=fish.one(e).attr("s_date"),t=fish.all(".calendar_items",this.wrapper),s=fish.one(e).attr("s_date"),a=fish.one(e).attr("e_date");fish.one(e).hasClass("on")||(t.append(this.renderItem(i,s,a,0)),fish.one(".calendar_item").html("remove"),this.showing_time=i,this.setBtnsStatus())},setBtnsStatus:function(){fish.all(".calendar_right").children("tr").each(function(e){fish.one(e).children("td").each(function(i){0!=fish.one(e).children("td").indexOf(this)&&6!=fish.one(e).children("td").indexOf(this)||fish.one(i).children("a").css("background:#f1f9ff")})});var e=!0,i=!0,t=fish.all(".prev",this.wrapper),s=fish.all(".next",this.wrapper),a=fish.parseDate(this.showing_time),n=fish.parseDate(this.startTime);a.getTime()<=n.getTime()&&(e=!1),a.getTime()>n.getTime()&&a.getFullYear()==n.getFullYear()&&a.getMonth()==n.getMonth()&&this.timeIsSingleMode(this.startTime)&&(e=!1),this.endTime&&this.isSameMonth(fish.parseDate(this.showing_time,{month:1}),fish.parseDate(this.endTime))&&this.timeIsSingleMode(this.showing_time)&&(i=!1),e?t.removeClass("disabled"):t.addClass("disabled"),i?s.removeClass("disabled"):s.addClass("disabled"),this.prev_disabled=!e,this.next_disabled=!i},isSameMonth:function(e,i){return dateA=fish.parseDate(e),dateB=fish.parseDate(i),dateA.getFullYear()==dateB.getFullYear()&&dateA.getMonth()==dateB.getMonth()},appendItem:function(e){fish.all(".calendar_items",this.wrapper).append(this.renderItem(e))},insertItem:function(e){fish.all(".calendar_items",this.wrapper).append(this.renderItem(e))}}}(),hot520(),function(){function e(e,t){fish.ajax({url:n.oneCal.attr("attr-url"),data:"lineid="+n.lineId+"&startdate="+e+"&enddate="+t,type:"json",sync:!0,fn:function(e){e&&e.PriceList&&(n.page_cf=e.PriceList,e.PriceList.length>1&&(n.oneCal.addClass("act_date"),fish.one(".date_bg .data_input").val("查看更多航期").removeClass("no_act_date"),i()))}})}function i(){fish.require("Calendar",function(){var e=new fish.Calendar({monthNum:1,zIndex:1e3}),i=fish.parseDate(n.page_cf[0].date),s=fish.parseDate(n.page_cf[n.page_cf.length-1].date),a=i.getFullYear(),o=i.getMonth()+1,l=i.getDate(),r=s.getFullYear(),c=s.getMonth()+1,h=s.getDate();n.oneCal.on("focus",function(i){e.pick({elem:this,startDate:a+"-"+o+"-"+l,endDate:r+"-"+c+"-"+h,mode:"rangeFrom",fn:function(e,i,s,a){var n=fish.one(a);t({price:n.attr("_price"),retail:n.attr("_retail"),date:n.attr("_date"),addDays:parseInt(fish.one("#hidDays").val()),setWeek:["周日","周一","周二","周三","周四","周五","周六"]}),fish.all("#HidDate,#HidCalendarDate").val(fish.one("#oneCal").val()),fish.one("#hidRate").val(n.attr("_price")||0),fish.one("#hidTjBeginDate").val(fish.one("#oneCal").val());var o=new Date(fish.one("#oneCal").val().replace(/-/g,"/")).getTime()-864e5;o=new Date(o),o=o.getFullYear()+"-"+(o.getMonth()+1>9?o.getMonth()+1:"0"+(o.getMonth()+1))+"-"+(o.getDate()>9?o.getDate():"0"+o.getDate()),fish.one("#txtLeaveDate").val(o),itinerary(),getPrice()},buildContent:function(e,i,t){var s=n.page_cf;n.build(e,i,t,s)}})})})}function t(e){var e={price:e.price,retail:e.retail,disCont:(Math.round(e.price/e.retail*100)/10).toFixed(1),date:e.date,addDays:e.addDays,setWeek:e.setWeek,mHref:function(e){var i=this,t=e.split(/\.html\?/g)[1]||"",s=i.date.replace(/-([0-9]{2})/g,function(e,i){return"-"+parseInt(i,10)});return"/youlun/linebook/"+n.lineId+"_"+s+".html?"+t},setActDate:function(){var e=this,i=new Date(e.date.replace(/\-/gi,"/")),t=i.getTime(),s=new Date(t),a=s.getFullYear(),n=s.getMonth()+1,o=s.getDate();return a+"年"+n+"月"+o+"日 "+e.setWeek[s.getDay()]},setBackDate:function(){var e=this,i=new Date(e.date.replace(/\-/gi,"/")),t=i.getTime()+24*e.addDays*3600*1e3,s=new Date(t),a=s.getFullYear(),n=s.getMonth()+1,o=s.getDate();return a+"年"+n+"月"+o+"日 "+e.setWeek[s.getDay()]}};if(jsonBlankStage.length>0){for(var i=0,t=!1,s=0;s<jsonBlankStage.length;s++){var a=jsonBlankStage[s].date;if(a==e.date){i=s,t=!0;break}}t?(fish.one(".bait_infro").removeClass("none"),fish.one(".price_dom").removeClass("no_b_tip"),n.bait_f.html("可分"+jsonBlankStage[i].f+"期支付，出游更超值！"),n.bait_fi.html("免息"+jsonBlankStage[i].d+"期")):(fish.one(".bait_infro").addClass("none"),fish.one(".price_dom").addClass("no_b_tip"))}n.selPrice.html(e.price);var o=fish.one(".ylc-modal .eve_yusuan input");o&&o[0]&&parseInt(o.val(),10)<=0&&(o.val(e.price),o.attr("_placeholder",e.price)),n.prPrice.html(e.retail),e.disCont<=0||e.disCont>=10?n.disC.addClass("none").html(""):n.disC.removeClass("none").html(e.disCont+"折"),n.d_actt.html(e.setActDate()),n.d_back.html(e.setBackDate()),n.link_order.attr("href",e.mHref(n.link_order.attr("href"))),n.fix_order_link.attr("href",e.mHref(n.fix_order_link.attr("href")));var a=new Date(e.date.replace(/\-/gi,"/")).getTime();fish.all("#ins_shower .dayth em").each(function(e,i){fish.one(this).html("("+(new Date(a+1e3*i*60*60*24).getMonth()+1)+"月"+new Date(a+1e3*i*60*60*24).getDate()+"日)")})}function s(e){return n.memberId?void fish.ajax({url:"/youlun/MemberFavoritesHandler.ashx?type=searchnew&productId="+n.lineId,openType:"get",type:"json",fn:function(i){return i?(i.ResultFlag===!0&&n.collectLi.addClass("collected"),void(e&&e(i.ResultFlag))):!1}}):!1}function a(){n.collectLi.hasClass("collected")?fish.ajax({url:"/youlun/MemberFavoritesHandler.ashx?type=Delete&favoriteId="+n.lineId,openType:"get",type:"json",fn:function(e){return e?void(e.ResultFlag===!0&&n.collectLi.removeClass("collected")):!1}}):fish.ajax({url:"/youlun/MemberFavoritesHandler.ashx?type=Addnew&productId="+n.lineId,openType:"get",type:"json",fn:function(e){return e?void(e.ResultFlag===!0&&n.collectLi.addClass("collected")):!1}})}fish.admin.config({Calendar:{v:"0.3",css:1,g:20140333106},mLogin:{v:"2.0",css:1,g:2012112073101}});var n={};n.memberId=fish.cookie.get("cnUser","userid")||fish.cookie.get("us","userid")||0,n.oneCal=fish.one("#oneCal"),n.lineId=fish.one("#HidLineid").val(),n.collectLi=fish.one(".trip_msg li.collect_li"),n.isSaleEnd=fish.one("#hidIsValid").val(),n.isSaleEnd&&1==parseInt(n.isSaleEnd,10)&&fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=GetCruiseDate&lineid="+n.lineId,type:"json",sync:!0,fn:function(i){if(i&&i.MouthList&&!(i.MouthList.length<=0)){var t=i.MouthList.length;e(i.MouthList[0].startdate,i.MouthList[t-1].enddate)}}}),n.selPrice=fish.one(".pri_d span strong b"),n.prPrice=fish.one(".mark_p i"),n.disC=fish.one(".pri_dis"),n.d_back=fish.one(".date_box .back_date span"),n.d_actt=fish.one(".date_box .now_date span"),n.link_order=fish.one(".ele_topDom .link_order"),n.fix_order_link=fish.one(".fix_order .fix_order_link"),n.bait_f=fish.one(".bait_infro > span"),n.bait_fi=fish.one(".bait_infro .span2"),n.tmpl='<span class="date">{dateStr}</span><a class="dayjh" href="javascript:void(0);"></a><span class="dataprice">{priceStr}</span>',n.build=function(e,i,t,s){for(var a,n,o,l=i.getTime(),r=[],c=0,h=s.length-1;h>=c;c++){a=s[c];var d=Date.parse(a.date.replace(/\-/gi,"/"));if(d>=l&&l+864e5>d){n=a;break}}if(n||(n={}),n.dateStr=t?t:i.getDate(),n.date){n.priceStr=n.price+"元";for(key in n)e.setAttribute("_"+key,n[key])}else r.push("invalid-day");o=this.tmpl.replace(/{(\w+)}/g,function(e,i){return n[i]||""}),e.innerHTML=o,fish.one(e).addClass(r.join(" "))},s(),n.collectLi.on("click",function(){n.memberId?a():fish.mLogin({unReload:!0,maskClose:!0,loginSuccess:function(){n.memberId=fish.cookie.get("cnUser","userid")||fish.cookie.get("us","userid")||0,s(function(e){1!=e&&fish.ajax({url:"/youlun/MemberFavoritesHandler.ashx?type=Addnew&productId="+n.lineId,openType:"get",type:"json",fn:function(e){return e?void(e.ResultFlag===!0&&n.collectLi.addClass("collected")):!1}})})}})})}(),function(){fish.extend({append:function(e){return this&&this.length&&e&&e.length?(this[0].appendChild(e[0]),this):this}}),fish.extend({insert:function(e){function i(e){for(var i=[],t=0;t<e.childNodes.length;t++)1==e.childNodes[t].nodeType&&i.push(e.childNodes[t]);return fish.all(i)}if(!(this&&this.length&&e&&e.length))return this;var t=fish.dom(i(fish.dom(this)));t.parentNode&&t.parentNode.insertBefore(e[0],t)}})}(),String.prototype.addParams=function(e){var i=this,t="";if("object"==typeof e)for(var s in e)e[s]&&(t+="&"+s+"="+e[s]);return t&&(i+=i.indexOf("?")>-1?t:"?"+t.substring(1,t.length)),i+""},function(){function e(){fish.all(".c_btu span")[1]&&fish.all(".c_btu span")[1].click(),fish.all(".c_btu span")[2]&&fish.all(".c_btu span")[2].click()}function i(){var e=fish.all("#storeInfo .list_store li"),i=fish.all(".adress .adress_list"),t=fish.one("#HidId").val(),s=!1;e.each(function(){var i=fish.one(this);t==i.attr("province-id")&&(e.removeClass("active"),i.addClass("active"),s=!0)}).on("click",function(){var t=fish.one(this),s=t.attr("province-id");e.removeClass("active"),t.addClass("active"),i.each(function(){var e=fish.one(this);s==e.attr("province-id")&&(i.addClass("none"),e.removeClass("none"))})}),s||e.each(function(){var t=fish.one(this);25==t.attr("province-id")&&(e.removeClass("active"),t.addClass("active")),i.each(function(){var e=fish.one(this);25==e.attr("province-id")&&(i.addClass("none"),e.removeClass("none"))})})}function t(){window.onscroll=function(){var e=document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop,i=fish.one(".intr_tit"),t=i.offset().top;e>t?(fish.one(".f_tit").css({position:"fixed",top:0,"z-index":11}),fish.one(".fix_order").removeClass("none")):(fish.one(".f_tit").css({position:""}),fish.one(".fix_order").addClass("none")),fish.one(window).scrollTop()>50?fish.one(".top_link").removeClass("none"):fish.one(".top_link").addClass("none"),B.windowHeight=window.screen.availHeight,e>=fish.one("#itinerary").offset().top+20-B.windowHeight&&B.itinerary&&(B.itinerary=!1),e>=fish.one("#visitorsCommElem").offset().top+20-B.windowHeight&&B.commonFlag&&(B.commonFlag=!1,H="/youlun/dsfgw/dsf/gw/exec?basename=FvBZ8ovxctQvyzrdTcPWJzw5xC6m5KaEJibOLXiAGdmzbMe0VqcjZ7XDwHMkJeiS&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&pageSize=5&tagId=1&dpCruiseId="+B.cruiseId+"&SortType=0",_(H)),e>=fish.one(".tra_main").offset().top+110-B.windowHeight&&B.travels&&(B.travels=!1,P()),fish.all(".detail_con").each(function(i,t){var s=fish.one(i).offset().top,a=fish.one(".intr_tit").height(),n=isNaN(parseInt(fish.all(".detail_con").getCss("margin-top")))?parseInt(fish.one(".detail_con").getCss("marginTop")):parseInt(fish.all(".detail_con").getCss("margin-top"));e>s-a-n&&(fish.all(".f_tit li").removeClass("at"),fish.one(fish.all(".f_tit li")[t]).addClass("at"))});var a=fish.one(".dayList"),n=a.offset().top,o=fish.one("#dayList").height(),l=fish.one(".dayCon").height(),r=fish.all(".dayList_nav li").length,c=parseInt(r/8,10),h=r%8,d=35*(8*(c-1)+h);fish.one(".dayList").css("height:"+l+"px;"),e>=n-60&&n+l-o-60>e?fish.one("#dayList").css({position:"fixed",top:"60px",bottom:"","z-index":10}):e>n+l-o-60?fish.one("#dayList").css({position:"absolute",top:"",bottom:0,"z-index":10}):fish.one("#dayList").css({position:"",top:0,bottom:"","z-index":10}),fish.all(".travel_day").each(function(i,t){var s=fish.one(i).offset().top;if(e>=s-60){fish.all(".dayList_nav ul li").removeClass("on"),fish.one(fish.all(".dayList_nav ul li")[t]).addClass("on");var a=35*t;0==a?(fish.one(".up").removeClass("act"),fish.one(".down").addClass("act")):a>0&&d>a?fish.all(".up,.down").addClass("act"):(a=d,fish.one(".up").addClass("act"),fish.one(".down").removeClass("act")),fish.all(".dayListArrow").hasClass("none")||fish.one(".dayList_nav ul").anim("top:-"+a+"px;",500)}}),n>e&&(fish.all(".dayList_nav ul li").removeClass("on"),fish.one(fish.all(".dayList_nav ul li")[0]).addClass("on")),s()},fish.all(".f_tit li").each(function(e,i){fish.one(e).on("click",function(){5==i&&0==fish.one(fish.all(".detail_con")[i]).offset().top&&(i=4);var e=fish.one(fish.all(".detail_con")[i]).offset().top,t=fish.one(".intr_tit").height(),s=isNaN(parseInt(fish.all(".detail_con").getCss("margin-top")))?parseInt(fish.one(".detail_con").getCss("marginTop")):parseInt(fish.all(".detail_con").getCss("margin-top"));window.scrollTo(0,e-t-s+1)})}),fish.one("#linkTravel").on("click",function(){var e=fish.one("#itinerary").offset().top,i=fish.one(".intr_tit").height(),t=isNaN(parseInt(fish.all(".detail_con").getCss("margin-top")))?parseInt(fish.one(".detail_con").getCss("marginTop")):parseInt(fish.all(".detail_con").getCss("margin-top"));window.scrollTo(0,e-i-t+1)})}function s(){var e=fish.one(window),i=fish.one(".description"),t=fish.one(".description_tab",i),a=fish.one(".f_tit");(s=function(){var s=e.scrollTop(),n=i.offset().top,o=a.height(),l=n+i.height()-t.height();s>=n-o?s>=l-o?t.css("top:"+(l-n>0?l-n:0)+"px;"):t.css("top:"+(s-n+o+10)+"px;"):t.css("top:0px;")})()}function a(){var e=!1;(fish.one("#uname").hasClass("err_input")||fish.one("#uemail").hasClass("err_input"))&&(e=!0);var i=fish.trim(fish.one("#uname").val()),t=fish.trim(fish.one("#uemail").val()),s=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;""==i&&(fish.one("#uname").addClass("err_input").html("after","<span><em></em>请输入姓名</span>"),e=!0),""==i||n(i)||(fish.one("#uname").addClass("err_input").html("after","<span><em></em>姓名格式错误</span>"),e=!0),""==t&&(fish.one("#uemail").addClass("err_input").html("after","<span><em></em>请输入Email</span>"),e=!0),""==t||s.test(t)||(fish.one("#uemail").addClass("err_input").html("after","<span><em></em>邮箱格式错误</span>"),e=!0),e?fish.one(".saveBt").addClass("busy"):fish.one(".saveBt").removeClass("busy")}function n(e){return/^[a-zA-Z\s]+$/.test(e)?!0:!!(/^[\u4e00-\u9fa5]+$/.test(e)&&e.length>1)}function o(){function e(e){fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=CruiseSpecialStatistic",openType:"post",data:stringFromJson(e),fn:function(){}})}var i=GetQueryString("Key"),t=GetQueryString("SearchCondition"),s=GetQueryString("lid"),a={PageType:"DetailPage",Userid:"undefined"==typeof getMemberId?0:getMemberId(),Url:encodeURIComponent(location.href),v:(new Date).getTime()};if(i)a.Key=B.rateOption.Key=i,t&&(a.SearchCondition=B.rateOption.SearchCondition=t),e(a),D();else{var n={};n.LineIds=fish.one("#HidLineid").val(),s&&(n.Lid=GetQueryString("lid")),fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=GenerateSpecialStatisticKey",openType:"post",data:stringFromJson(n),type:"json",fn:function(i){i&&i.length&&i[0].Key?(B.rateOption.Key=a.Key=i[0].Key,t&&(B.rateOption.SearchCondition=a.SearchCondition=t),e(a),D()):(n.LineIds&&(a.LineId=n.LineIds),n.Lid&&(a.Lid=n.Lid),e(a))},err:function(){n.LineIds&&(a.LineId=n.LineIds),n.Lid&&(a.Lid=n.Lid),e(a)}})}}function l(e,i,t){var s=fish.one(e).offset();return{top:s.top+(i?i:0),left:s.left+(t?t:0)}}function r(e,i,t){var s=l(e),a=l(i),n=fish.one(e);if(s.left+n.width()+10>t){var o=fish.one(".comm_s",n),r=fish.one(i);o.removeClass("comm_s").addClass("comm_sr"),n.css("top:"+(a.top+r.height()+8)+"px;left:"+(a.left-367+r.width())+"px;")}}function c(e,i){fish.ajax({url:e,data:"type="+i,type:"json",fn:function(e){e&&(e.ResultFlag===!0||"加入收藏夹"===e.ResultMsg?fish.one("#collectLine").attr("title","可在“我的同程”查看和取消当前收藏").addClass("iscollect").html("已收藏"):fish.one("#collectLine").attr("title","收藏该航线").removeClass("iscollect").html("收藏"))}})}function h(){var e="http://www.ly.com/AjaxHelper/TopLoginHandler.aspx?channel=YouLun&action=getTelephone",i=getRefid();fish.ajax({url:e,data:"&asyncRefid="+i,type:"jsonp",fn:function(e){var i=e.telephone;fish.all(".hot_line span,.zx_rx span").html(i)},err:function(){fish.all(".hot_line span,.zx_rx span").html("4007-740-075")}})}function d(e,i,t,s,a){function n(e){return document.getElementById(e)}function o(e,i){return e.currentStyle?e.currentStyle[i]:getComputedStyle(e,!1)[i]}function l(e,i){e.timer&&clearInterval(e.timer),e.timer=setInterval(function(){for(var t in i){var s=parseInt(o(e,t));s=s?s:0;var a=(i[t]-s)/3;a=a>0?Math.ceil(a):Math.floor(a),e.style[t]=s+a+"px",s==i[t]&&clearInterval(e.timer)}},30)}function r(){l(C,{left:-x*b}),g>3&&(T>x?l(y,{left:0}):g>x+T?l(y,{left:-(x-T)*w}):l(y,{left:-(g-k)*w}));for(var e=0;g>e;e++)v[e].className="",e==x&&(v[e].className="current")}function c(){newtime=setInterval(function(){v[x].index=x,v[x].onclick=function(){x=this.index,r()},v[x].click(),x++,x==g&&(x=0)},3e3)}function h(e){fish.one(e).on("mouseover",function(){clearInterval(newtime)}),fish.one(e).hover(function(){clearInterval(newtime)},function(){c()})}var d=n(e),f=n(i),p=n(t),u=n(s),m=d.getElementsByTagName("li"),v=f.getElementsByTagName("li"),_=m.length,g=v.length,C=d.getElementsByTagName("ul")[0],y=f.getElementsByTagName("ul")[0],b=m[0].offsetWidth,w=v[0].offsetWidth;w+=a,C.style.width=b*_+"px",y.style.width=w*g+"px";var x=0,k=4,T=Math.ceil(k/3);u.onclick=u.onclick=function(){x++,x=x==g?0:x,r()},p.onclick=p.onclick=function(){x--,x=-1==x?g-1:x,r()};for(var I=0;g>I;I++)v[I].index=I,v[I].onclick=function(){x=this.index,r()};v[0].click(),c(),h(d),h(f),h(p),h(u)}function f(){var e=fish.one(".yhsm"),i=fish.one(".note_right",e),t=fish.one(".note div",e),s=fish.one(".note_more",e);t.height()>52?s.removeClass("none"):s.addClass("none"),i.hover(function(){e.addClass("note_active")},function(){e.removeClass("note_active")})}function m(e,i,t,s,a){function n(){window.open([l,p].join(""),"mb",["toolbar=0,status=0,resizable=1,width=620,height=450,left=",(screen.width-620)/2,",top=",(screen.height-450)/2].join(""))||(u.href=[l,p].join(""))}var o=encodeURIComponent,l=e;u=i,p=["url=",o(u),"&title=",o(t),"&summary=",s,"&pic=",o(a)].join(""),/Firefox/.test(navigator.userAgent)?setTimeout(n,0):n()}function v(e,i,t){for(var s=fish.all("script"),a=0,n=s.length;n>a;a++)if(s[a].src.indexOf(e)>=0)return"function"==typeof i&&i(),s[a];var o=Math.floor(1e12*Math.random()),l=document.createElement("script");return l.type="text/javascript",l.async=!0,"function"==typeof i?l.onload=l.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(l.onload=l.onreadystatechange=null,i())}:t=i,l.src=e+(t?"?v="+o++:""),document.getElementsByTagName("script")[0].parentNode.appendChild(l),l}function _(e,i){var s,a=e.split("&"),n={pageSize:a[3].split("=")[1],dpCruiseId:a[5].split("=")[1],SortType:a[6].split("=")[1],tagId:a[4].split("=")[1]};e=a[0]+"&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&param="+JSON.stringify(n),s=e.substring(0,e.length-1),fish.all("#ctrlPager").mPage({startWithAjax:!0,callback:function(e){if(e&&e.CountInfo){var s=e.CountInfo,a=e.CommentInfos;if((!a||a.length<1)&&fish.one(".satisfaction_wrap").html().length<1)return fish.one("#visitorsCommElem").html("remove"),fish.all(".f_tit li").each(function(e){var i=fish.one(e).attr("attr-id");5==i&&fish.one(e).html("remove")}),void t();var n='<div class="rates">                                <strong>{{=it[0].Satisfaction}}%</strong><span>满意度</span>                             </div>                             <div class="rates_list">                                <div class="line_dp clearfix">                                    <span class="r_position">好评率</span>                                    <div class="rates_box r_position">                                        <span class="pray_bg"><span class="yellow_bg" style="width: {{=it[0].GoodFaction}}%;"></span></span></span>                                </div>                                <span class="r_num r_position">{{=it[0].GoodFaction}}%</span>                                </div>                                <div class="line_dp clearfix">                                    <span class="r_position">中评率</span>                                    <div class="rates_box r_position">                                        <span class="pray_bg"><span class="yellow_bg" style="width: {{=it[0].ModeFaction}}%;"></span></span>                                    </div>                                    <span class="r_num r_position">{{=it[0].ModeFaction}}%</span>                                </div>                                <div class="line_dp bad_line_dp clearfix">                                    <span class="r_position">差评率</span>                                    <div class="rates_box r_position">                                        <span class="pray_bg"><span class="yellow_bg" style="width: {{=it[0].BadFation}}%;"></span></span>                                    </div>                                    <span class="r_num r_position">{{=it[0].BadFation}}%</span>                                </div>                             </div>                            <div class="scores">                                <strong class="s_num"><span class="s_text1">{{=it[0].ServiceScore > 0 ? it[0].CompositeScore : Math.round(((it[0].DinnerScore+it[0].PlayScore+it[0].TravelScore+5)/4)*100)/100}}</span>分</strong><span class="s_text2">综合得分</span>                            </div>                            <div class="scores_litem">                                <div class="s_list4">餐饮住宿<span>{{=it[0].DinnerScore}}</span></div>                                <div class="s_list4">娱乐活动<span>{{=it[0].PlayScore}}</span></div>                                <div class="s_list4">岸上观光<span>{{=it[0].TravelScore}}</span></div>                                <div class="s_list4">同程服务<span>{{=it[0].ServiceScore <= 0 ? 5.0 : it[0].ServiceScore}}</span></div>                            </div>                            <div class="rules">                                <p>您可对已购订单立刻发表点评</p>                                <a class="dp_link" href="http://member.ly.com/orderlist.aspx">立即点评</a>                                <span class="pre_t present_tip"><span></span>点评奖金规则</span>                            </div>',o='<label for="reviewInt1" class="lab_sty"><input type="radio" id="reviewInt1" name="reviewType" checked="checked" class="reviewInput" attr-total="{{=it[0].all}}" sttr-url="/youlun/dsfgw/dsf/gw/exec?basename=FvBZ8ovxctQvyzrdTcPWJzw5xC6m5KaEJibOLXiAGdmzbMe0VqcjZ7XDwHMkJeiS&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&pageSize=5&tagId=1">所有点评({{=it[0].All}})</label>                               <label for="reviewInt2" class="lab_sty"><input type="radio" id="reviewInt2" name="reviewType" class="reviewInput" sttr-url="/youlun/dsfgw/dsf/gw/exec?basename=FvBZ8ovxctQvyzrdTcPWJzw5xC6m5KaEJibOLXiAGdmzbMe0VqcjZ7XDwHMkJeiS&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&pageSize=5&tagId=2">好评({{=it[0].Good}})</label>                               <label for="reviewInt3" class="lab_sty"><input type="radio" id="reviewInt3" name="reviewType" class="reviewInput" sttr-url="/youlun/dsfgw/dsf/gw/exec?basename=FvBZ8ovxctQvyzrdTcPWJzw5xC6m5KaEJibOLXiAGdmzbMe0VqcjZ7XDwHMkJeiS&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&pageSize=5&tagId=3">中评({{=it[0].Moderate}})</label>                               <label for="reviewInt4" class="lab_sty"><input type="radio" id="reviewInt4" name="reviewType" class="reviewInput" sttr-url="/youlun/dsfgw/dsf/gw/exec?basename=FvBZ8ovxctQvyzrdTcPWJzw5xC6m5KaEJibOLXiAGdmzbMe0VqcjZ7XDwHMkJeiS&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&pageSize=5&tagId=4">差评({{=it[0].Negative}})</label>                               <label for="reviewInt5" class="lab_sty"><input type="radio" id="reviewInt5" name="reviewType" class="reviewInput" sttr-url="/youlun/dsfgw/dsf/gw/exec?basename=FvBZ8ovxctQvyzrdTcPWJzw5xC6m5KaEJibOLXiAGdmzbMe0VqcjZ7XDwHMkJeiS&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&pageSize=5&tagId=5">有图({{=it[0].Photo}})</label>                               <div class="review_select">                                    <span class="paixu at" attr-type="0">默认排序</span><span class="paixu" attr-type="1">最有价值 ↑</span><span class="paixu" attr-type="3">时间排序 ↑</span>                                </div>',l='{{for(var n = 0,m = it.length;n < m; n++){ }}                              <div class="review_lists clearfix">                                  {{? it[n].IsElite == "1"}}<span class="essence_reviews"></span>{{?}}                                  <div class="author">                                      {{? it[n].UserAvatar == ""}}<span class="rev_tip user_0{{=it[n].Level + 1}}"></span>{{??}}<span class="rev_tip user_0{{=it[n].Level + 1}}"></span>{{?}}                                      <p class="">{{=it[n].NickName}}</p>                                      <img src="http://js.40017.cn/cn/public/module/memberLevel/0.4/lev{{=it[n].Level + 1}}.gif" class="rev_lev">                                  </div>                                  <div class="right_main">                                    <!-- 游客点评内容  -->                                    <div class="c_details">                                        <p><span>{{=it[n].Comment}}</span><a class="checkmore" style="display: none;"><span>展开全部</span></a></p>                                    </div>                                    <!-- 图片展示 -->                                    {{? it[n].PhotoSizeList == ""}}{{??}}                                    <div class="pic_show clearfix"  attr-img="{{=it[n].PhotoSizeList}}" attr-maxImg="{{=it[n].PhotoList}}">                                        <div class="pic_box">                                            {{for(var i = 0,j = it[n].PhotoSizeList.length;i < j; i++){}}                                              <img class="pic_right" src="{{=it[n].PhotoSizeList[i]}}" alt="" imgid="{{=i}}">                                            {{?}}                                        </div>                                        <a class="pic_right" imgid="0" style="display: none">查看更多</a>                                    </div>{{?}}                                    <!-- 发表时间 -->                                    <div class="c_dates clearfix">                                        <div class="reward_type">                                            <span class="family_t">{{=it[n].WalkAimDes}}</span>                                        </div>                                        <span class="reward_time">                                            {{=it[n].CreateDateSoa}}&nbsp;                                            发表于{{? it[n].CommentSource == 2}}<i class="pc"></i>{{??}}<i class="app"></i>{{?}}                                            {{=it[n].CommentSourceDes}}                                        </span>                                    </div>                                    <!-- 同程回复 -->                                    {{? it[n].Response ==""}}                                    {{??}}                                    <div class="tc_review">                                        <p>                                   			<span>同程回复：</span>{{=it[n].Response}}                                        </p>                                    </div>                                    {{?}}                                  </div>                                {{? it[n].Response == 0}}                                <span class="reward_support none" resId="{{=it[n].ResId}}"><span><em>{{=it[n].PraiseCount}}</em>有用</span></span>                                {{??}}                                <span class="reward_support none reward_supported" resId="{{=it[n].ResId}}"><span><em>{{=it[n].PraiseCount}}</em>有用</span></span>                                {{?}}                                </div>                                {{ } }}';
i&&fish.mPop.close(),fish.trim(fish.one(".satisfaction_wrap").html()).length<1&&fish.one(".satisfaction_wrap").html(fish.template(n,s)),fish.trim(fish.one(".dp_tab").html()).length<1&&fish.one(".dp_tab").html(fish.template(o,s)),a?fish.one(".dp_list").html(fish.template(l,a)):fish.one(".dp_list").html(""),fish.one("#ctrlPager").html().length>0||!a?fish.one("#ctrlPager").removeClass("none"):fish.one("#ctrlPager").addClass("none"),t(),fish.all(".reward_support").on("click",function(){var e=this,i=this.getAttribute("resId"),t=fish.cookie.get("us","userid");if(!fish.one(e).hasClass("reward_supported"))if(t){fish.one(e).addClass("reward_supported"),fish.one("em",e).html(parseInt(fish.one("em",e).html())+1),fish.ajax({url:"/youlun/CruiseTours/CruiseToursAjax.aspx?Type=GetCommentPraise",data:"praiseId="+i+"&userId="+t,type:"json",fn:function(i){var t=fish.one("#dp_tip"),s=fish.one(e).offset().left+40,a=fish.one(e).offset().top,n=30,o=400;t.css("top:"+a+"px;left:"+s+"px;display:block;opacity:0;filter:alpha(opacity=0)"),t.anim("top:"+(parseInt(a,10)-n)+"px;left:"+parseInt(s,10)+"px;opacity:1;filter:alpha(opacity=100)",o,{fn:function(){t.css("display:none;top:;left:;opacity:;filter:;")},easeing:function(){}})}})}else fish.mLogin()}),fish.all(".c_details p").each(function(e,i){var t=fish.one(e),s=t.height();if(s>72){var a=fish.one("span",t).html(),n=a.substring(0,200)+"...";t.css("height:72px;"),fish.one("span",t).html(n),fish.one(".checkmore",this).css("display:block").on("click",function(){fish.one(this).hasClass("hide")?(fish.one(this).removeClass("hide"),t.css("height:72px;"),fish.one("span",t).html(n),fish.one("span",this).html("展开全部")):(fish.one(this).addClass("hide"),t.css("height:auto;"),fish.one("span",t).html(a),fish.one("span",this).html("收起全部"))})}}),C()}},preSortTotal:function(e){return e.PageCount&&e.PageCount<=1?0:e.PageCount},ajaxObj:{type:"json",url:s+',"page":"{pagenum}"}',fn:function(e){return JSON.parse(e.result)}},skip:"true"})}function g(){var e=0,i=!0;fish.all(".review_select span").each(function(){fish.one(this).hasClass("at")&&(e=fish.one(this).attr("attr-type"))}),fish.all("#visitorsCommElem .dp_tab input").each(function(){if(fish.dom(this).checked){var t=fish.one(this).attr("sttr-url");t+="&dpCruiseId="+B.cruiseId+"&SortType="+e,fish.mPop({content:fish.one("#popOut #inline_example_load"),afterOpen:function(){_(t,i),window.scrollTo(0,fish.one(".reviews").offset().top-fish.one(".f_tit").height())}})}})}function C(){fish.all(".pic_show").each(function(e,i){var t=fish.all("img",e).length,s=fish.one(e).attr("attr-img").split(","),a=fish.one(e).attr("attr-maxImg").split(",");if(t>4){for(var n="",i=0;4>i;i++)n+="<img src='"+s[i]+"' class='pic_right' alt='' imgid='"+i+"'/>";fish.one(".pic_box",e).html(n),fish.all(".pic_right",e).css("display:block")}fish.all(".pic_right",e).on("click",function(){var e=parseInt(fish.one(this).attr("imgid"),10),i=a[e],s="<ul class='photo-list' page='1'>",n="";0==e&&(i=a[e]);for(var o=0;t>o;o++)s+='<li picunm="'+(o+1)+'"><img src="'+a[o]+'" alt=""/><i></i></li>';s+="</ul><a href='javascript:;' class='pa-l'></a><a href='javascript:;' class='pa-r'></a>",n+='<div class="big-photo">                            <img src="'+i+'">                            <span class="big-p-num">'+(e+1)+"/"+t+'</span>                         </div>                         <div class="pa-box">'+s+"</div>",fish.one(".popc-con").html(n),fish.mPop({content:fish.one("#popOut .photo-album"),afterOpen:function(){var i=Math.ceil(t/4);5>t&&fish.all(".pa-l,.pa-r").html("remove"),fish.one(".photo-list").css("width:"+184*t+"px;"),fish.one(".photo-album .popName").html(fish.one("#HidShipName").val()),fish.one(fish.all(".photo-list li")[e]).addClass("photo-at"),fish.all(".photo-list li").each(function(e,i){fish.one(e).on("mouseover",function(){y(i,t)})}),fish.one(".pa-l").on("click",function(){var e=parseInt(fish.one(".photo-list").attr("page"),10);1!=e&&(e-=1,fish.one(".photo-list").attr("page",e),fish.one(".photo-list").anim("left:"+-(736*(e-1))+"px;",100),y(4*e-4,t))}),fish.one(".pa-r").on("click",function(){var e=parseInt(fish.one(".photo-list").attr("page"),10);e!=i&&(fish.one(".photo-list").anim("left:"+-(736*e)+"px;",100),e+=1,fish.one(".photo-list").attr("page",e),y(4*e-4,t))})}})})})}function y(e,i){fish.one(".big-photo img").attr("src",fish.one(fish.all(".photo-list li img")[e]).attr("src")),fish.one(".big-p-num").html(fish.one(fish.all(".photo-list li")[e]).attr("picunm")+"/"+i),fish.all(".photo-list li").removeClass("photo-at"),fish.one(fish.all(".photo-list li")[e]).addClass("photo-at")}function b(e){var i=document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop;window.scrollTo(0,i+(e?e:1)),setTimeout(function(){var i=document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop;window.scrollTo(0,i-(e?e:1))})}function w(){var e=fish.one("#mSlider").attr("attr-url");fish.ajax({url:e,type:"json",fn:function(e){if(e){if(""==e.imgList)return;var i=e.imgList[0].imgurl,t=e.imgList[0].name,s='<img src="'+i+'" alt="'+t+'"/>';fish.one(".line_img").html(s)}}})}function x(){var e=fish.one("#HidCalendarDate").val();fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=GetFinalPrice&lineid="+N+"&saildate="+e,type:"json",fn:function(e){if(e){fish.one(".pri_d").html("<span><strong>&yen;<b>"+e.calPrice+"</b></strong>起</span>");var i=fish.one(".ylc-modal .eve_yusuan input");i&&i[0]&&parseInt(i.val(),10)<=0&&(i.val(e.calPrice),i.attr("_placeholder",e.calPrice))}}})}function k(){""!=fish.trim(fish.one(".reason").html())&&"<P><BR></P>"!=fish.trim(fish.one(".reason").html()).toUpperCase()&&"<P><BR/></P>"!=fish.trim(fish.one(".reason").html()).toUpperCase()||(fish.one("#recommend").addClass("none"),fish.one(fish.all(".f_tit li")[0]).addClass("none")),t()}function T(){var e=fish.one("#room").attr("attr-url");fish.ajax({url:e,type:"json",fn:function(e){if(e){if(""==e.RoomPicList)return;var i='<div id="r_slider" class="r_slider mSlider_con"><ul>{{for(var n = 0,m = it.length; n < m; n++){ }}<li><a href="/youlun/linebook/'+N+'.html" target="_blank"><img src="{{=it[n].ImgUrl}}"/><div class="minprice"><div><span>{{=it[n].roomname}}<em><b>&yen;</b><strong>{{=it[n].Minprice}}</strong></em><i>起</i></span></div></div></a></li>{{ } }}</ul></div><a id="room_prev" class=" btn prev" href="javascript:void(0)"></a><a id="room_next" class="btn next" href="javascript:void(0)"></a><div id="r_bottom" class="r_bottom"><ul>{{for(var n = 0,m = it.length; n < m; n++){ }}<li><img src="{{=it[n].ImgUrl}}"/><div></div><span>{{=it[n].roomname}}</span></li>{{ } }}</ul></div>',t=e.RoomPicList;fish.one("#room").html(fish.template(i,t)),fish.all(".minprice strong").each(function(){0!=fish.one(this).html()&&void 0!=fish.one(this).html()||fish.one(this).parent(".minprice").css("display:none")}),fish.trim(fish.one(".room").html())&&d("r_slider","r_bottom","room_prev","room_next",10)}}})}function I(){var e=fish.one("#calendar_top").attr("attr-url");fish.ajax({url:e,type:"json",fn:function(e){if(e){if(""==e.MouthList)return;var i='<a class="btn prev disabled"></a><div class="calendar_top_con"><ul>{{for(var n = 0,m = it.length; n < m; n++){ }}<li s_date="{{=it[n].startdate}}" e_date="{{=it[n].enddate}}">{{=it[n].data}}</li>{{ } }}</ul></div><a class="btn next disabled"></a>',t=e.MouthList;fish.one("#calendar_top").html(fish.template(i,t)),fish.one("#calendar_top li").addClass("on");var s=fish.all("#calendar_top li").length;1==s?fish.all("#calendar_top li").css("width:100%"):2==s?fish.all("#calendar_top li").css("width:50%"):3==s?fish.all("#calendar_top li").css("width:33.33%"):(fish.one("#calendar_top ul").css("width:"+120*s+"px;"),fish.all("#calendar_top li").css("width:120px;"),fish.one("#calendar_top .next").removeClass("disabled")),make_canael(B.rateOption)}}})}function j(){function e(e){for(var i='{{?it.index > 0 && it.StayTimeDesc}}                            <div class="transfer_sit_line">                                <p><span><em class="e_l"></em>{{=it.DepartureCityName}}中转 停留{{=it.StayTimeDesc}}<em class="e_r"></em></span></p>                            </div>                        {{?}}                        <div class="air_tr_lines clearfix">                            <p class="air_p01">{{=it.AirlineName}}<br/><span class="m_l_0 sp0">{{=it.FlightNo}}</span><span class="sp0">{{=it.CraftType}}</span><span class="sp0">{{=it.ClassType}}</span></p>                            <p class="air_p02 "><span class="f_s_14">{{=it.DepartureTime.substr(0,16)}}<br/><span class="c_666">{{=it.DeparturePort}}</span></p>                            <div class="table_line"><span class="c_l"></span><span class="c_r"></span></div>                            <p class="air_p02 "><span class="f_s_14">{{=it.ArrivalTime.substr(0,16)}}<br/><span class="c_666">{{=it.ArrivalPort}}</span></p>                            <p class="air_p03"><span class="c_666">飞行时长：</span>约{{=it.DurationTimeDesc}}</p>                        </div>',t="",s="",a=0,n=e.length;n>a;a++)e[a].index=a,0==e[a].ClassType?e[a].ClassType="经济舱":1==e[a].ClassType?e[a].ClassType="公务舱":2==e[a].ClassType?e[a].ClassType="头等舱":e[a].ClassType="",t+=fish.template(i,e[a]),s+='<span class="tit_span">'+e[a].DepartureCityName+"-"+e[a].ArrivalCityName+"</span>";return'<div class="air_t_info"><h4 class="tr_l_ports">'+s+"</h4>"+t+"</div>"}var i=fish.one("#airMsg");fish.ajax({url:"/youlun/CruiseTours/CruiseToursAjax_Book.aspx?type=GetLineAirlinePrdouctInfo",data:"LineId="+fish.trim(fish.one("#HidLineid").val())+"&lineDate="+fish.trim(fish.one("#oneCal").val()),type:"json",err:function(){},fn:function(t){if(!t||t.length<=0)return void i.addClass("none");for(var s="",a="",n="",o="",l=t.length,r=0;l>r;r++){var c=t[r].CruiseFlightTicketDepartureModel,h=t[r].CruiseFlightTicketArrivalModel;s+='<li class="air_buts" _n="'+r+'">航班'+(r+1)+"</li>",n='<div class="trip_con clearfix"><span class="trip_span"><em>去程</em></span>'+e(c)+"</div>",o='<div class="trip_con clearfix"><span class="trip_span"><em>返程</em></span>'+e(h)+"</div>",lineStr='<div class="arrow_line"></div>',(!c||c.length<=0)&&(n="",lineStr=""),(!h||h.length<=0)&&(o="",lineStr=""),a+='<div class="air_msg_con none" _n="'+r+'">'+n+lineStr+o+"</div>",n=o=""}i.html('<h4 class="air_tit"><span class="sp_t"><em></em>航班信息</span>（航班仅供参考，具体航班以出团通知书为准，起飞与抵达时间以当地时间为准）</h4><ul class="air_ul_tab'+(l>=2?" ":" none ")+'">'+s+"</ul>"+a).removeClass("none"),fish.all(".airport_msg .air_buts")[0]&&fish.all(".airport_msg .air_buts")[0].click()}}),fish.all(".airport_msg").on("click",function(e){var i=fish.getTarget(e),t=fish.one(i);do if(t.hasClass("air_buts")){var s=t.parent(".airport_msg")[0],a=fish.all(".air_buts",s),n=fish.all(".air_msg_con",s),o=parseInt(fish.trim(t.attr("_n")),10);return a.removeClass("act"),t.addClass("act"),n.addClass("none"),void fish.one(n[o]).removeClass("none")}while(i=i.parentNode)});var s="/youlun/AjaxCall_Cruise.aspx?Type=TravelTripFinal&lineid="+N+"&saildate="+fish.one("#oneCal").val();fish.ajax({url:s,type:"json",fn:function(e){if(e){if(e.Date=fish.one("#HidDate").val(),!e.SummayTravel)return fish.one("#itinerary").html("remove"),fish.all(".f_tit li").each(function(e){var i=fish.one(e).attr("attr-id");1==i&&fish.one(e).html("remove")}),void t();for(var i='<h5>行程概述</h5>                                <div class="overviews">                                    <div class="routeMap"><img src="{{=it.TripImage}}" alt=""/></div>                                    {{var date = new Date(it.Date.replace(/-/gi, "/")).getTime(),addenglish = 0;}}                                    {{? it.IsInterLine == 1}}                                    {{? it.IsLongLine == 1 && it.IsSinglePicket == 1}}{{addenglish = 1;}}{{?}}                                        <div class="routeTable">                                            <dl class="head">                                                <dd class="dayth">行程</dd>                                                <dd class="throuth">国家/城市</dd>                                                <dd class="arrive">抵达<span>当地时间</span></dd>                                                <dd class="sail">启航<span>当地时间</span></dd>                                            </dl>                                            <div id="ins_container">                                                <div id="ins_shower">                                                {{for(var a = 0,b = it.SummayTravel.CalendarTravelList,c = b.length; a < c; a++){ }}                                                    <dl {{? addenglish}}class="english {{? a%2 == 1}}even{{?}}"{{??}}class="{{? a%2 == 1}}even{{?}}"{{?}}>                                                        <dd class="dayth">第{{=b[a].Date}}天<em>({{=new Date(date+a*1000*60*60*24).getMonth() + 1}}月{{=new Date(date+a*1000*60*60*24).getDate()}}日)</em></dd>                                                        <dd class="throuth">{{=b[a].CountryOrSight}}{{?addenglish}}<br/>{{=b[a].CountryEn}}{{?}}</dd>                                                        <dd class="arrive">{{=b[a].ArrTime}}&nbsp;</dd>                                                        <dd class="sail">{{=b[a].SetUpTime}}</dd>                                                    </dl>                                                {{ } }}                                                </div>                                            </div>                                            <div id="ins_scroller">                                                <div  id="ins_scroll_bar"></div>                                            </div>                                        </div>                                    {{??}}                                        <div class="routeTable">                                            <dl class="head">                                                <dd class="dayth">行程</dd>                                                <dd class="throuth">途径景点</dd>                                                <dd class="arrive">入住</dd>                                                <dd class="sail"></dd>                                            </dl>                                            <div id="ins_container">                                                <div id="ins_shower">                                                {{for(var a = 0,b = it.SummayTravel.CalendarTravelList,c = b.length; a < c; a++){ }}                                                    <dl {{? a%2 == 1}}class="even" {{??}}{{?}}>                                                        <dd class="dayth">第{{=b[a].Date}}天<em>({{=new Date(date+a*1000*60*60*24).getMonth() + 1}}月{{=new Date(date+a*1000*60*60*24).getDate()}}日)</em></dd>                                                        <dd class="throuth">{{=b[a].CountryOrSight}}</dd>                                                        <dd class="arrive">{{=b[a].TravelLive}}&nbsp;</dd>                                                        <dd class="sail"></dd>                                                    </dl>                                                {{ } }}                                                </div>                                            </div>                                            <div id="ins_scroller">                                                <div  id="ins_scroll_bar"></div>                                            </div>                                        </div>                                    {{?}}                                    <p class="routeNote"><span style="color:#ff6600;">*</span>上述抵达与启航时间均为参考信息，具体信息请以邮轮实际行程为准</p>                                </div>                                {{? it.CruiseTravelAllModel.CruiseTravelDayModList.length > 0}}                                <h5> 行程详情                                    <div class="itinerary_print">                                        <span onclick="_tcTraObj._tcTrackEvent(\'click\',\'PCtours-xlts\',\'email\');" class="email_pbt" a-url="/youlun/CruiseTours/CruiseToursAjax.aspx?Type=GetEmailRoute&amp;lineid=printid">Email行程</span>                                        <a onclick="_tcTraObj._tcTrackEvent(\'click\',\'PCtours-xlts\',\'dayin\');" _href="/youlun/tour/GetourToMember.aspx?lineid=printid" class="print_link">打印行程</a>                                    </div>                                </h5>                                <div class="routeDetail">                                    <div class="dayList">                                        <div id="dayList">                                            <div class="dayListArrow up none"></div>                                            <div class="dayList_nav">                                                <ul attr-top="0">                                                {{for(var a = 1,b = it.CruiseTravelAllModel.CruiseTravelDayModList,c = b.length; a <= c; a++){ }}                                                    <li>第{{=a}}天</li>                                                {{ } }}                                                </ul>                                            </div>                                            <div class="dayListArrow down act none"></div>                                        </div>                                    </div>                                    {{? it.IsInterLine == 1}}                                        <div class="dayCon">                                            {{for(var a = 0,b = it.CruiseTravelAllModel.CruiseTravelDayModList,c = b.length; a < c; a++){ }}                                                <div class="travel_day" id="day{{=(a + 1)}}">                                                    <span class="travel_day_logo {{? b[a].IsTravelSea == 0}}shore {{??}}{{?}}"></span>                                                    <p class="travel_day_title"><span>第{{=(a + 1)}}天</span><span>{{=b[a].LineCity}}</span>{{? b[a].ArrTime != ""}}<span>抵达时间 {{=b[a].ArrTime}}</span>{{??}}{{?}}{{? b[a].SetUpTime !=""}}<span>启航时间 {{=b[a].SetUpTime}}</span>{{??}}{{?}}</p>                                                    <div class="travel_day_con">                                                        {{? b[a].EatModel != null || b[a].TravelLive !=""}}<p class="eat">{{? b[a].EatModel != null}}{{for(var i = 0, j = b[a].EatModel.length; i < j; i++){}}<span>邮轮{{=b[a].EatModel[i].EatName}}：{{=b[a].EatModel[i].IsContain}}</span>{{}}}{{??}}{{?}}{{? b[a].TravelLive != ""}}<span class="home">入住：{{=b[a].TravelLive}}</span>{{??}}{{?}}</p>{{??}}{{?}}                                                        <div class="route">{{=b[a].Description}}</div>                                                        <div class="route_img">                                                            <div class="mSlider_con">                                                                    <ul>                                                                    {{? b[a].SightCruiseTravelScenicImg}}                                                                        {{for(var x = 0,y = b[a].SightCruiseTravelScenicImg,z = y.length; x < z; x++){ }}                                                                            <li>                                                                                <img src="{{=y[x].ImgUrl}}"/>                                                                                <div class="layer">{{=y[x].Name}}</div>                                                                            </li>                                                                        {{ } }}                                                                    {{??}}{{?}}                                                                    </ul>                                                                </div>                                                            <a class="slider_left"></a>                                                            <a class="slider_right"></a>                                                        </div>                                                    </div>                                                    {{? b[a].CruiseTravelDetailMod.length > 0}}                                                        <div class="excusion">                                                            <p class="nochange"><span>岸上观光</span>（一条线路是贯穿整个旅行的，如选择A线，则所有岸上游都是A线的行程）</p>                                                            {{for(var x = 0,y = b[a].CruiseTravelDetailMod,z = y.length; x < z; x++){}}                                                                {{var time = y[x].DetailExcursion.CLTDETravelTime,hours = parseInt(time/60,10),minus = time%60,Breakfast = y[x].DetailExcursion.CLTDEIsIncludeBreakfast,Lunch = y[x].DetailExcursion.CLTDEIsIncludeLunch,Dinner = y[x].DetailExcursion.CLTDEIsIncludeDinner,foot = "岸上餐食：";}}                                                                {{? Breakfast == 0 && Lunch == 0 && Dinner == 0}}{{foot = "";}}{{??}}{{? Breakfast == 1}}{{foot += "早餐,";}}{{??}}{{?}}{{? Lunch == 1}}{{foot += "午餐,";}}{{??}}{{?}}{{? Dinner == 1}}{{foot += "晚餐,";}}{{??}}{{?}}{{foot = foot.replace(/,$/g,"")+"包含";}}{{?}}                                                                <div class="excusion_type">                                                                    <p class="vaca"><span>{{=y[x].TypeName}}</span><span>景点：{{for(var j = 0,k = y[x].VisitNameList,l = k.length;j < l; j++){}} {{? j != l-1}}{{=k[j]}}-{{??}}{{=k[j]}}{{?}}{{}}}</span><em></em></p>                                                                    <div class="scenic none">                                                                        {{? time > 0 || foot.length > 0}}<p class="scenic_time clearfix">{{? time > 0}}<span class="time">行程总时长约：{{? hours > 0}}{{=hours}}小时{{??}}{{?}}{{? minus > 0}}{{=minus}}分钟{{??}}{{?}}{{??}}{{?}}</span><span>{{=foot}}</span></p>{{??}}{{?}}                                                                        {{for(var j = 0,k = y[x].CruiseTravelSightDetailModList,l = k.length;j < l;j++){}}                                                                            <p class="scenic_name"><span>【{{=k[j].Name}}】</span>{{=k[j].Description == null ? "" : k[j].Description}}</p>                                                                        {{}}}                                                                        <p class="scenic_weath">以上岸上观光行程安排可能因天气、路况等原因做顺序上的相应调整，请您谅解。</p>                                                                        {{? y[x].CruiseTravelScenicImg.length > 0}}                                                                            <ul>                                                                            {{for(var j = 0,k = y[x].CruiseTravelScenicImg,l = k.length;j < l; j++){}}                                                                                <li><img src="{{=k[j].ImgUrl}}"><p>{{=k[j].Name}}</p></li>                                                                            {{}}}                                                                            </ul>                                                                        {{??}}{{?}}                                                                    </div>                                                                </div>                                                            {{ } }}                                                        </div>                                                    {{??}}{{?}}                                                </div>                                            {{ } }}                                        </div>                                        {{??}}                                            <div class="dayCon">                                                {{for(var a = 0,b = it.CruiseTravelAllModel.CruiseTravelDayModList,c = b.length; a < c; a++){ }}                                                    <div class="travel_day" id="day{{=(a + 1)}}">                                                        <span class="travel_day_logo {{? b[a].IsTravelSea == 0}}shore {{??}}{{?}}"></span>                                                        <p class="travel_day_title"><span>第{{=(a + 1)}}天</span><span>{{=b[a].LineCity}}</span></p>                                                        <div class="travel_day_con">                                                            {{? b[a].EatModel != null || b[a].TravelLive !=""}}<p class="eat">{{? b[a].EatModel != null}}{{for(var i = 0, j = b[a].EatModel.length; i < j; i++){}}<span>游轮{{=b[a].EatModel[i].EatName}}：{{=b[a].EatModel[i].IsContain}}</span>{{}}}{{??}}{{?}}{{? b[a].TravelLive != ""}}<span class="home">入住：{{=b[a].TravelLive}}</span>{{??}}{{?}}</p>{{??}}{{?}}                                                            <div class="route">{{=b[a].Description}}</div>                                                            <div class="route_img">                                                                <div class="mSlider_con">                                                                    <ul>                                                                    {{? b[a].SightCruiseTravelScenicImg}}                                                                        {{for(var x = 0,y = b[a].SightCruiseTravelScenicImg,z = y.length; x < z; x++){ }}                                                                            <li>                                                                                <img src="{{=y[x].ImgUrl}}"/>                                                                                <div class="layer">{{=y[x].Name}}</div>                                                                            </li>                                                                        {{ } }}                                                                    {{??}}{{?}}                                                                    </ul>                                                                </div>                                                                <a class="slider_left"></a>                                                                <a class="slider_right"></a>                                                        </div>                                                        </div>                                                        {{? b[a].CruiseTravelDetailMod.length > 0}}                                                            <div class="excusion">                                                                <p class="nochange"><span>岸上观光</span></p>                                                                {{for(var x = 0,y = b[a].CruiseTravelDetailMod,z = y.length; x < z; x++){}}                                                                    <div class="excusion_type">                                                                        <p class="vaca"><span>当日游玩景点</span><span>{{for(var j = 0,k = y[x].VisitNameList,l = k.length;j < l; j++){}} {{? j != l-1}}{{=k[j]}}-{{??}}{{=k[j]}}{{?}}{{}}}</span><em></em></p>                                                                        <div class="scenic none">                                                                            {{for(var j = 0,k = y[x].CruiseTravelSightDetailModList,l = k.length;j < l;j++){}}                                                                                <p class="scenic_name"><span>【{{=k[j].Name}}】</span>{{=k[j].Description}}</p>                                                                            {{}}}                                                                            <p class="scenic_weath">以上岸上观光行程安排可能因天气、路况等原因做顺序上的相应调整，请您谅解。</p>                                                                            {{? y[x].CruiseTravelScenicImg.length > 0}}                                                                                <ul>                                                                                {{for(var j = 0,k = y[x].CruiseTravelScenicImg,l = k.length;j < l; j++){}}                                                                                    <li><img src="{{=k[j].ImgUrl}}"><p>{{=k[j].Name}}</p></li>                                                                                {{}}}                                                                                </ul>                                                                            {{??}}{{?}}                                                                        </div>                                                                    </div>                                                                {{ } }}                                                            </div>                                                        {{??}}{{?}}                                                    </div>                                                {{ } }}                                            </div>                                        {{?}}                                </div>                                {{??}}{{?}}',s='<div class="route_infro"><em class="t_tit">行程概要：</em>',a=e.SummayTravel.CalendarTravelList,n=0,o=a.length;o>n;n++)5>n&&(s+="<span>",s+=0==n?"":'<em class="d_i"></em>',s+="&nbsp;D"+a[n].Date+'<em class="d_city">'+a[n].CountryOrSight.replace(/飞机/g,'</em><em class="d_i"></em><em class="d_city">').replace(/动车/g,'</em><em class="d_i"></em><em class="d_city">').replace(/火车/g,'</em><em class="d_i"></em><em class="d_city">').replace(/汽车/g,'</em><em class="d_i"></em><em class="d_city">').replace(/巴士/g,'</em><em class="d_i"></em><em class="d_city">').replace(/邮轮/g,'</em><em class="d_i"></em><em class="d_city">').replace(/大巴/g,'</em><em class="d_i"></em><em class="d_city">').replace(/轮船/g,'</em><em class="d_i"></em><em class="d_city">')+"</em></span>");a.length>5&&(s+='<span class="detail_l"><em class="d_i"></em>&nbsp;D6<em>...</em><a id="linkTravel">详情</a></span></div>'),fish.all(".route_infro").html("remove"),fish.one(".trip_msg").html("after",s),fish.all(".route_infro .d_city").each(function(){var e=fish.one(this).html();e.length>5&&(e=e.substr(0,5)+"..."),fish.one(this).html(e)});var l=fish.template(i,e);l=l.replace(/printid/g,N),fish.one(".specialty").html(l),fish.one(".travel_day").css("margin-top:0"),fish.one(".dayList_nav li").addClass("on"),fish.all(".travel_day_title span,.routeTable .throuth").each(function(){var e=fish.one(this).html();e=e.replace(/飞机/g,"<em class='plane'></em>").replace(/动车/g,"<em class='train'></em>").replace(/火车/g,"<em class='train'></em>").replace(/汽车/g,"<em class='bus'></em>").replace(/巴士/g,"<em class='bus'></em>").replace(/邮轮/g,"<em class='crise'></em>").replace(/大巴/g,"<em class='bus'></em>").replace(/轮船/g,"<em class='crise'></em>"),fish.one(this).html(e)}),fish.all(".travel_day_con").each(function(){0==fish.all(".route_img li",this).length&&(fish.one(".route_img",this).html("remove"),fish.one(".route",this).css("width:100%"))}),t(),fish.all("#ins_shower dl").length>5&&(fish.mScrollpane({wheelNum:10,container:"#ins_container",shower:"#ins_shower",scroller:"#ins_scroller",scroll_bar:"#ins_scroll_bar",defaultStyle:!0}),fish.one("#ins_container").css("margin-top:33px;"));var r=fish.all(".dayList_nav li").length,c=parseInt(r/8,10),h=r%8,d=35*(8*(c-1)+h);fish.all(".dayListArrow").on("click",function(){var e=parseInt(fish.one(".dayList_nav ul").attr("attr-top"),10);fish.one(this).hasClass("act")&&(fish.all(".dayListArrow").addClass("act"),fish.one(this).hasClass("up")&&(e-=175,0>=e&&(e=0,fish.one(this).removeClass("act")),fish.one(".dayList_nav ul").attr("attr-top",e)),fish.one(this).hasClass("down")&&(e+=175,e>=d&&(e=d,fish.one(this).removeClass("act")),fish.one(".dayList_nav ul").attr("attr-top",e)),fish.one(".dayList_nav ul").anim("top:-"+e+"px;",500));
}),fish.all(".dayList_nav ul li").each(function(e,i){fish.one(e).on("click",function(){var e=fish.one(this),t=35*i;0==t?fish.one(".up").removeClass("act"):t>0&&d>t?fish.all(".up,.down").addClass("act"):(t=d,fish.one(".down").removeClass("act")),fish.all(".dayListArrow").hasClass("none")||fish.one(".dayList_nav ul").anim("top:-"+t+"px;",500),fish.all(".dayList_nav ul li").removeClass("on"),e.addClass("on"),window.scrollTo(0,fish.one(fish.all(".travel_day")[i]).offset().top-fish.one(".f_tit").height())})}),fish.all(".dayList_nav li").length<=8?fish.all(".dayList_nav,.dayList ul").css("height:auto;"):fish.all(".dayListArrow").removeClass("none"),fish.all(".excusion_type").each(function(){var e=fish.one(this);fish.one("p",e).on("click",function(){if(fish.one("em",this).hasClass("show")){fish.one("em",this).removeClass("show"),fish.one(".scenic",e).addClass("none");var i=fish.one(".dayCon").height();fish.one(".dayList").css("height:"+i+"px;"),fish.one("#dayList").offset().top>fish.one(".dayList").offset().top+fish.one(".dayList").height()-fish.one("#dayList").height()&&fish.one("#dayList").css({position:"absolute",bottom:0,top:"auto"})}else fish.one("em",this).addClass("show"),fish.one(".scenic",e).removeClass("none")})}),fish.all(".route_img").each(function(){fish.all("li",this).length>1?fish.one(this).mSlider({autoScroll:!0,showNav:!1,circle:!0,arrows:!0,moveTime:5e3,prevBtn:".slider_left",nextBtn:".slider_right"}):fish.all("a",this).css("display:none;")})}}})}function D(){var e=B.rateOption,i=fish.one("#TopProductElem .link_order"),t=fish.one(".elem_intr .fix_order .fix_order_link");fish.one("#TopProductElem .link_order").length>0&&i.attr("href",i.attr("href").addParams(e)),fish.one(".elem_intr .fix_order").length>0&&t.attr("href",t.attr("href").addParams(e))}function L(){var e=fish.one("#HidLineid").val(),i=fish.one("#oneCal").val();fish.ajax({url:fish.one("#contentRoomEle").attr("attr-url"),data:"lineid="+e+"&Date="+i+"&IsSelectPromotion=1",type:"json",fn:function(e){if(e&&e.ProList&&e.ProList.length>0){var i="",t=(new Date).getTime(),s=new Date("2016/05/25").getTime(),a=new Date("2016/06/20").getTime();t>=s&&a>t&&(i='<span class="hot616"></span>'),fish.one(".pro_tit .h2_title").html("bottom",i);for(var n="<span class='other_a showsale'>立减优惠</span>",o="",l=0;l<e.ProList.length;l++)o+="<p>"+e.ProList[l]+"</p>";fish.one(".other_h").removeClass("none"),fish.one(".pr_mg .price_yh").html("bottom",n),fish.one("#cuxiao .comm_mian").html("bottom",o),fish.one("#showsale").hover()}if(e&&e.GiftList&&e.GiftList.length>0){for(var n="<span class='other_a libao'>礼包</span>",o="",l=0;l<e.GiftList.length;l++)o+="<p>"+e.GiftList[l]+"</p>";fish.one(".pr_mg .price_yh").html("bottom",n),fish.one("#libao .comm_mian").html("bottom",o),fish.one("#libao").hover()}}})}function P(){fish.ajax({url:"/youlun/CruiseShipTeam/CruiseShipTeamAjax.aspx?type=GetYouJiInfo",data:"shipName="+encodeURIComponent(fish.one("#HidShipName").val())+"&length=158",type:"json",fn:function(e){if(!(e&&e.length>0))return fish.one("#travelsCommElem").html("remove"),fish.all(".f_tit li").each(function(e){var i=fish.one(e).attr("attr-id");6==i&&fish.one(e).html("remove")}),void t();var i='{{for(var n = 0, m = it.length; n < m; n++ ){}}                                <div class="tra_list">                                    <div class="tra_list_l">                                        <img src="{{=it[n].RmAuthorHeadImg}}" alt=""/>                                        <a class="tra_mr" href="http://go.ly.com/user/{{=it[n].AesRmMemberId}}/" target="_blank">{{=it[n].RmUserName}}</a>                                        <span class="tra_num tra_mr">{{=it[n].ReviewCount}}</span>                                        <span class="tra_lnum tra_mr">{{=it[n].ReRecommendCount}}</span>                                    </div>                                    <div class="tra_list_r">                                        <a class="tra_tit" href="http://go.ly.com/youji/{{=it[n].RmId}}.html" target="_blank">{{=it[n].RmTitle}}</a>                                        <p class="tra_info"><a target="_blank" href="http://go.ly.com/youji/{{=it[n].RmId}}.html">{{=it[n].Contentxt}}<span style="color: #167cd8">详情&gt;&gt;</span></a></p>                                        {{? it[n].RmImageList.length > 0}}<ul>{{for(var i = 0, j = it[n].RmImageList.length > 5 ? 5 : it[n].RmImageList.length; i < j; i++){ }}<li><a class="tra_tit" href="http://go.ly.com/youji/{{=it[n].RmId}}.html" target="_blank"><img src="{{=it[n].RmImageList[i]}}" alt=""/></a></li>{{}}}</ul>{{??}}{{?}}                                    </div>                                </div>                                {{?n != m - 1}}                                <div class="tra_lsty"></div>                                {{?}}                                {{}}}',s=e.length,a=fish.one("#HidCompanyId").val()||"",n=fish.one("#HidCruiseId").val()||"",o="/youlun/gonglve/",l="0"==fish.trim(fish.one("#HidYouJiType").val())&&s>1?"":" none ";a&&n&&(o="/youlun/gonglve_"+a+"_"+n+"/"),fish.one(".tra_main").html(fish.template(i,e)+'<a class="more_stra '+l+'" target="_blank" href="'+o+'"></a>')},err:function(){}})}function S(){fish.one(".boat_link").on("click",function(){var e=fish.one("#HidCruiseId").val(),i=window.location.href,t="/youlun"+i.split("?")[0].split("&")[0].split("/youlun")[1];fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=CruiseShipTeamStatistic",data:"Url="+t+"&cruiseid="+e+"&pagetype=1",type:"json",fn:function(e){}})})}function M(){var e=new Date,i=new Date("2016/04/18 00:00:00"),t=new Date("2016/04/30 00:00:00");return 72517==fish.one("#HidLineid").val()&&e.getTime()>i.getTime()&&e.getTime()<t.getTime()?(fish.one("#bannerImg").html('<a href="https://www.lancai.cn/?cid=108002" target="_blank"><img src="http://img1.40017.cn/cn/y/16/p/lancai.png"></a>'),fish.one("#bannerImg").anim("height:90px",1e3),!1):void fish.ajax({url:"/youlun/CruiseTours/CruiseToursAjax.aspx",data:"Type=GetCruiseSliderPicList&num=1",type:"json",fn:function(e){return e&&e[0]&&e[0].LineUrl?(e?fish.one("#bannerImg").html('<a href="'+e[0].LineUrl+'" target="_blank"><img src="'+e[0].ImgUrl+'"></a>'):"",void fish.one("#bannerImg").anim("height:90px",1e3)):!1},err:function(){fish.one("#bannerImg").anim("height:90px",1e3)}})}function F(e){return/^1[3,4,5,7,8]\d{9}$/i.test(e)}function O(){if(R("2016/06/02 00:00:00","2016/06/20 00:00:00")){fish.one(".workendactive").removeClass("none");var e=localStorage.lastOpenTime||0;0==e||e!=fish.parseDate()?(localStorage.lastOpenTime=fish.parseDate(),fish.one(".bonus_box").css({left:0}),fish.one(".aside_tag").css({left:"-136px;"})):(fish.one(".bonus_box").css({left:"-100%;"}),fish.one(".aside_tag").css({left:0}))}R("2016/06/02 00:00:00","2016/06/09 00:00:00")&&(fish.one(".searchSale").attr("href","http://www.ly.com/zhuanti/youlundashiji"),fish.one(".searchSale img").attr("src","http://img1.40017.cn/cn/y/16/h/3.0.3/dashijian.gif")),fish.one(".bonus_form a").on("click",function(){if(!fish.one(this).hasClass("getting")){var e=fish.trim(fish.one(".phone").val()),i=fish.trim(fish.one(".code").val());if(!F(e))return void fish.one(".bonus_tip").html("<span>亲，请输入正确手机号</span>").removeClass("none");if(""==i)return void fish.one(".bonus_tip").html("<span>亲，请输入正确验证码</span>").removeClass("none");fish.one(this).addClass("getting"),fish.ajax({url:"/youlun/CruiseRedPacket/CruiseRedPacketajax.aspx?type=GetGiftPacketByMobile&mobile="+e+"&checkCode="+i,type:"json",fn:function(e){var i="/youlun/CruiseRedPacket/CruiseRedPacketajax.aspx";return fish.one(".bonus_form img").attr("src",i+"?type=GetRedPackCheckCode&module=1&height=40&width=60&r="+Math.random()),5==e.ResultCode?(fish.one(".bonus_tip").html("<span>亲，请输入正确验证码</span>").removeClass("none"),fish.one(".code").val(""),void fish.one(".bonus_form a").removeClass("getting")):void(0==e.ResultCode?(fish.all(".bonus_bg,.bonus_box").addClass("none"),fish.all(".bonus_mask,.bonus_suc").removeClass("none"),fish.one(".bonus_form a").removeClass("getting")):3==e.ResultCode&&(fish.all(".bonus_bg,.bonus_box").addClass("none"),fish.all(".bonus_mask,.bonus_suc").removeClass("none"),fish.one(".bonus_suc img").attr("src","http://img1.40017.cn/cn/y/15/h/hb2.jpg?v=1"),fish.one(".bonus_form a").removeClass("getting")))}})}}),fish.all(".phone,.code").on("focus",function(){fish.one(".bonus_tip").addClass("none")}),fish.one(".bonus_form img").on("click",function(){fish.one(".code").val("");var e="/youlun/CruiseRedPacket/CruiseRedPacketajax.aspx";fish.one(".bonus_form img").attr("src",e+"?type=GetRedPackCheckCode&module=1&height=40&width=60&r="+Math.random())}),fish.all(".bonus_suc .close,.use").on("click",function(){fish.all(".bonus_bg,.bonus_box").anim("left:-100%",800,function(){fish.one(".aside_tag").anim("left:0px;",200)}),fish.all(".bonus_mask,.bonus_suc").addClass("none")}),fish.one(".bonus_box .close").on("click",function(){fish.all(".bonus_bg,.bonus_box").anim("left:-100%",800,function(){fish.all(".bonus_bg,.bonus_box").addClass("none"),fish.one(".aside_tag").anim("left:0px;",200)})}),fish.one(".aside_tag").on("click",function(){var e=fish.one(this).width();fish.one(".aside_tag").anim("left:-"+e+"px;",200,function(){fish.all(".bonus_bg,.bonus_box").removeClass("none").anim("left:0%",800)})}),fish.browser("ms")&&fish.all(".bonus_box input").each(function(){var e=fish.one(this).attr("placeholder");fish.one(this).val(e).css({color:"#666"}).on("focus",function(){fish.one(this).val()==e&&fish.one(this).val("")}).on("blur",function(){""==!fish.one(this).val()?fish.one(this).css({color:"#333"}):fish.one(this).val(e)})})}function R(e,i){var t=new Date,s=new Date(e),a=new Date(i),n=t.getTime(),e=s.getTime(),i=a.getTime();return n>e&&i>n}fish.admin.config({mScrollpane:{v:"0.1",css:"1",g:2122}});var B={};B.rateOption={},B.cruiseId=fish.one("#HidCruiseId").val(),B.HidTransport=encodeURIComponent(fish.one("#HidTransport").val());var N=fish.one("#HidLineid").val();fish.extend({block:function(){this.css("display:block;")},none:function(){this.css("display:none")}}),B.usi=fish.cookie.get("us","userid"),fish.on("click",function(e){var i=fish.getTarget(e);do{var t=i.className;if(t&&t.indexOf("enshrine")>-1){var s=fish.one(i);if(s.hasClass("iscollect"))return;return void(B.usi?c(s.attr("attr-url"),"Addnew"):fish.mLogin({unReload:!0,loginSuccess:function(){var e=window.location.href;window.location.href=e+"?islogin=1",c(s.attr("attr-url"),"Addnew")}}))}if(t&&t.indexOf("top_proInfo")>-1)return}while(i=i.parentNode)},"#TopProductElem"),fish.on("mouseover",function(e){var i=fish.getTarget(e);do{var t=i.className;if(t&&t.indexOf("up_price")>-1){B.showC=!0;var s=l(i,23,-8),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#upPriceInfo").css("top:"+s.top+"px;left:"+s.left+"px;display:block;"),void r("#upPriceInfo",i,a)}if(t&&t.indexOf("up_baiti")>-1){B.showC=!0;var s=l(i,30,-227),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#upBitiaoInfo").css("top:"+s.top+"px;left:"+s.left+"px;display:block;"),void r("#upBitiaoInfo",i,a)}if(t&&t.indexOf("tip_top")>-1){B.showC=!0;var s=l(i,23,-8),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#prizeRules").css("top:"+s.top+"px;left:"+s.left+"px;display:block;"),void r("#prizeRules",i,a)}if(t&&t.indexOf("pre_t")>-1){B.showC=!0;var s=l(i,33,-8),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#prizeRules").css("top:"+s.top+"px;left:"+s.left+"px;display:block;"),void r("#prizeRules",i,a)}if(t&&t.indexOf("usered")>-1){B.showC=!0;var s=l(i,33,-58),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#redpacket").css("top:"+s.top+"px;left:"+s.left+"px;display:block;"),void r("#redpacket",i,a)}if(t&&t.indexOf("banked")>-1){B.showC=!0;var s=l(i,33,-88),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#bankpacket").css("top:"+s.top+"px;left:"+s.left+"px;display:block;"),void r("#bankpacket",i,a)}if(t&&t.indexOf("hot_train")>-1){B.showC=!0;var s=l(i,33,0),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#trainpacket").css("top:"+s.top+"px;left:"+s.left+"px;display:block;"),void r("#trainpacket",i,a)}if(t&&t.indexOf("showsale")>-1){B.showC=!0;var s=l(i,33,0),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#cuxiao").css("top:"+s.top+"px;left:"+s.left+"px;display:block;"),void r("#cuxiao",i,a)}if(t&&t.indexOf("libao")>-1){B.showC=!0;var s=l(i,33,-58),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#libao").css("top:"+s.top+"px;left:"+s.left+"px;display:block;"),void r("#libao",i,a)}if(t&&t.indexOf("sale_active")>-1)return B.showC=!0,fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules").none(),fish.all("#active span").css("font-size:12px;"),void fish.one("#active").css("top:"+(fish.one(".sale_active").offset().top-fish.one(".ul_list").offset().top+fish.one(".sale_active").height())+"px;display:block;");if(t&&t.indexOf("top_proInfo")>-1)return}while(i=i.parentNode)},".content"),fish.on("mouseout",function(e){var i=fish.getTarget(e);do{var t=i.className;if(t&&t.indexOf("up_price")>-1)return B.showC=!1,void setTimeout(function(){B.showC||fish.one("#upPriceInfo").none()},100);if(t&&t.indexOf("up_baiti")>-1)return B.showC=!1,void setTimeout(function(){B.showC||fish.one("#upBitiaoInfo").none()},100);if(t&&t.indexOf("tip_top")>-1)return B.showC=!1,void setTimeout(function(){B.showC||fish.one("#prizeRules").none()},100);if(t&&t.indexOf("pre_t")>-1)return B.showC=!1,void setTimeout(function(){B.showC||fish.one("#prizeRules").none()},100);if(t&&t.indexOf("usered")>-1)return B.showC=!1,void setTimeout(function(){B.showC||fish.one("#redpacket").none()},100);if(t&&t.indexOf("banked")>-1)return B.showC=!1,void setTimeout(function(){B.showC||fish.one("#bankpacket").none()},100);if(t&&t.indexOf("hot_train")>-1)return B.showC=!1,void setTimeout(function(){B.showC||fish.one("#trainpacket").none()},100);if(t&&t.indexOf("showsale")>-1)return B.showC=!1,void setTimeout(function(){B.showC||fish.one("#cuxiao").none()},100);if(t&&t.indexOf("libao")>-1)return B.showC=!1,void setTimeout(function(){B.showC||fish.one("#libao").none()},100);if(t&&t.indexOf("writeYouji")>-1)return B.showC=!1,void setTimeout(function(){B.showC||fish.one("#write").none()},100);if(t&&t.indexOf("sale_active")>-1)return B.showC=!1,void setTimeout(function(){B.showC||fish.one("#active").none()},100);if(t&&t.indexOf("top_proInfo")>-1)return}while(i=i.parentNode)},".content"),fish.on("mouseover",function(){B.showC=!0},"#upPriceInfo"),fish.on("mouseout",function(){B.showC=!1,setTimeout(function(){B.showC||fish.one("#upPriceInfo").none()},100)},"#upPriceInfo"),fish.on("mouseover",function(){B.showC=!0},"#upBitiaoInfo"),fish.on("mouseout",function(){B.showC=!1,setTimeout(function(){B.showC||fish.one("#upBitiaoInfo").none()},100)},"#upBitiaoInfo"),fish.on("mouseover",function(){B.showC=!0},"#prizeRules"),fish.on("mouseout",function(){B.showC=!1,setTimeout(function(){B.showC||fish.one("#prizeRules").none()},100)},"#prizeRules"),fish.on("mouseover",function(){B.showC=!0},"#redpacket"),fish.on("mouseout",function(){B.showC=!1,setTimeout(function(){B.showC||fish.one("#redpacket").none()},100)},"#redpacket"),fish.on("mouseover",function(){B.showC=!0},"#bankpacket"),fish.on("mouseout",function(){B.showC=!1,setTimeout(function(){B.showC||fish.one("#bankpacket").none()},100)},"#bankpacket"),fish.on("mouseover",function(){B.showC=!0},"#trainpacket"),fish.on("mouseout",function(){B.showC=!1,setTimeout(function(){B.showC||fish.one("#trainpacket").none()},100)},"#trainpacket"),fish.on("mouseover",function(){B.showC=!0},"#cuxiao"),fish.on("mouseout",function(){B.showC=!1,setTimeout(function(){B.showC||fish.one("#cuxiao").none()},100)},"#cuxiao"),fish.on("mouseover",function(){B.showC=!0},"#libao"),fish.on("mouseout",function(){B.showC=!1,setTimeout(function(){B.showC||fish.one("#libao").none()},100)},"#libao"),fish.on("mouseover",function(){B.showC=!0},"#write"),fish.on("mouseout",function(){B.showC=!1,setTimeout(function(){B.showC||fish.one("#write").none()},100)},"#write"),fish.on("mouseover",function(e){var i=fish.getTarget(e),t=l(i,80,-5),s=fish.one(i).attr("src");fish.all(".reviews_main li").removeClass("on"),fish.one(this).parent().addClass("on"),fish.one(".reviews_img").css("top:"+t.top+"px;left:"+t.left+"px;display:block;").html("<img src='"+s+"'/>")},".reviews_main .rev_img li img"),fish.on("mouseout",function(){fish.all(".reviews_main li").removeClass("on"),fish.one(".reviews_img").css("display:none;")},".reviews_main .rev_img li img"),fish.all(".reviews_main dl ul").on("mouseover",function(){var e=fish.all("li.good",this).length,i=fish.one(this);fish.one(".star_con").html(e+"分,很满意</div>"),fish.one(".star").css("top:"+(i.offset().top+i.height())+"px;left:"+i.offset().left+"px;display:block;")}).on("mouseout",function(){fish.one(".star").css("display:none;")}),fish.on("click",function(e){var i=fish.getTarget(e);do{var t=i.className;if(t&&t.indexOf("reviewInput")>-1)return setTimeout(function(){g()},10),void b(10);if(t&&t.indexOf("paixu")>-1)return fish.all(".review_select span").removeClass("at"),fish.one(i).addClass("at"),setTimeout(function(){g()},10),void b(10);if(t&&t.indexOf("link_quick")>-1)return fish.one(".linkName").val("请问如何称呼您").css("color:#999"),fish.one(".linkPhone").val("请问如何联系您").css("color:#999"),fish.all("#needElem .place_l").removeClass("place_at"),void fish.mPop({content:fish.dom("#needElem"),width:636});if(t&&t.indexOf("look")>-1)window.scrollTo(0,fish.one(".calbox").offset().top-fish.one(".intr_tit").height());else if(t&&t.indexOf("top_proInfo")>-1)return}while(i=i.parentNode)},"body"),fish.all(".description_con p").css("font-family:'microsoft yahei';background:none;"),fish.all(".con_height").each(function(){var e=fish.one(this);if(e.height()>104){var i=e.parent(".description"),t=fish.one(".c_btu",i);t.removeClass("none"),e.css("height:100px; overflow:hidden")}}),fish.all(".c_btu span").on("click",function(){var e=fish.one(this),i=e.parent(".description"),t=fish.one(".con_height",i);t.css("height:auto;");var s=t.height();if(t.css("height:104px;"),e.hasClass("ctrl_open"))e.removeClass("ctrl_open").html("收起"),t.anim("height:"+s+"px;",500);else{e.addClass("ctrl_open").html("展开"),t.anim("height: 104px;",2e3);var a=t.height();window.scrollTo(0,t.offset().top-a)}}),e(),fish.all(".visa li").each(function(e,i){var t=fish.one(this);t.on("click",function(){fish.all(".visa li").removeClass("on"),t.addClass("on"),fish.all(".visa_area").addClass("none"),fish.one(fish.all(".visa_area")[i]).removeClass("none")})}),fish.all(".visa_con_tab").each(function(){var e=fish.one(this),i=e.parent(".visa_area");fish.all("a",e).each(function(t,s){fish.one(t).on("click",function(){fish.all("a",e).removeClass("on"),fish.one(t).addClass("on"),fish.all(".tab_table",i).addClass("none"),fish.one(fish.all(".tab_table",i)[s]).removeClass("none")})})}),fish.all(".description_tab li").each(function(e,i){var t=fish.one(this);t.on("click",function(){fish.all(".description_tab li").removeClass("at"),t.addClass("at"),fish.all(".description_con").addClass("none"),fish.one(fish.all(".description_con")[i]).removeClass("none"),window.scrollTo(0,fish.one(fish.dom(".description_con").parentNode.parentNode).offset().top-36)})}),i(),fish.one(".weix_share").on("mouseover",function(){fish.one(".weix_share .wx_tip").removeClass("none")}).on("mouseout",function(){fish.one(".weix_share .wx_tip").addClass("none")}),B.itinerary=!0,B.commonFlag=!0,B.travels=!0,fish.one("#Transport").on("click",function(){var e=fish.one(fish.all(".detail_con")[parseInt(fish.one(this).attr("_num"),10)]).offset().top,i=fish.one(".intr_tit").height(),t=isNaN(parseInt(fish.all(".detail_con").getCss("margin-top")))?parseInt(fish.one(".detail_con").getCss("marginTop")):parseInt(fish.all(".detail_con").getCss("margin-top"));window.scrollTo(0,e-i-t+1)}),fish.all(".cancelBt,.againBt").on("click",function(){fish.mPop.close(),fish.one(".fail_tips").addClass("none"),fish.one(".email_form").removeClass("none")}),fish.one(".saveBt").on("click",function(){if(a(),!fish.one(this).hasClass("busy")&&!fish.one("#uname").hasClass("err_input")&&!fish.one("#uemail").hasClass("err_input")){var e=fish.one(".email_pbt").attr("a-url")+"&email="+fish.one("#uemail").val()+"&startTime="+fish.one("#oneCal").val()+"&addDays="+fish.one("#hidDays").val();fish.ajax({url:e,openType:"post",type:"string",fn:function(e){fish.one(".saveBt").removeClass("busy"),e?fish.mPop.close():(fish.one(".fail_tips").removeClass("none"),fish.one(".email_form").addClass("none"))}})}}),fish.one(".content").delegate(".print_link","click",function(e){var i=fish.getTarget(e),t=fish.one(i).attr("_href")+"&startTime="+fish.one("#oneCal").val()+"&addDays="+fish.one("#hidDays").val();window.open(t)}),fish.all("#uname,#uemail").on("focus",function(){fish.one(this).removeClass("err_input").next().html("remove")}),fish.one(".content").delegate(".email_pbt","click",function(){fish.all("#uname,#uemail").val("").removeClass("err_input").next().html("remove"),fish.one(".email_form").removeClass("none"),fish.one(".fail_tips").addClass("none"),fish.mPop({title:"&nbsp;",content:fish.one(".email_pop"),dragable:!1,width:405})}),fish.one(".top_link").on("click",function(){window.scrollTo(0,0)}),h();var E=function(e){var i,t,s,a,n,o=fish.all(e.elem);t=e.title?e.title:document.title+"@同程旅游",i=e.url?e.url:document.location.href,s=e.summary?e.summary:"",a=e.wxurl?e.wxurl:document.location.href,n=e.pic?e.pic:"",fish.all("a",o).on("click",function(){var e=this.getAttribute("share-data");z[e](i,t,s,n,a)})},z={sina:function(e,i,t,s,a){m("http://v.t.sina.com.cn/share/share.php?",e,i,t,s,a)},weixin:function(e,i,t,s,a){v("http://js.40017.cn/cn/min/??/cn/c/c/qrcode.js",function(){if(fish.dom(".tc_show_wx_w2m"))fish.mPop({content:fish.one(".tc_show_wx_w2m"),width:274,height:320});else{var e=document.createElement("div");e.className="tc_show_wx_w2m",e.innerHTML='<p class="tc_weixin_pop_head"><span>分享到微信朋友圈</span><a class="tc_weixin_pop_close">×</a></p><div class="qr_con"></div><div class="tc_weixin_pop_foot">打开微信，点击“发现”，<br>使用“扫一扫”即可将网页分享至朋友圈。</div>',document.body.appendChild(e),fish.one(".tc_show_wx_w2m .tc_weixin_pop_close").on("click",function(){fish.mPop.close()}),fish.mPop({content:fish.one(".tc_show_wx_w2m"),width:274,height:320,afterOpen:function(){var e=new QRCode(fish.dom(".tc_show_wx_w2m .qr_con"),{width:200,height:200});e.makeCode(a)}})}},!0)},qzone:function(e,i,t,s){m("http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?",e,i,t,s)}};fish.admin.config({mPage:{v:"0.5.6",g:2016022501,css:1}}),fish.admin.config({mLogin:{v:"2.0",css:1,g:2012112073101}});var A=fish.one("#visitorsCommElem"),H=A.attr("attr-url");fish.one("#ctrlPager").delegate("a","click",function(e){var i=fish.getTarget(e);fish.one(i).hasClass("currentpage")||fish.one(i).hasClass("prevGrey")||fish.one(i).hasClass("nextGrey")||window.scrollTo(0,fish.one(".reviews").offset().top-fish.one(".f_tit").height())}).delegate(".page_btn","click",function(){window.scrollTo(0,fish.one(".reviews").offset().top-fish.one(".f_tit").height())}),window.getPrice=x,window.itinerary=j,fish.ready(function(){M(),x(),fish.all(".description span").css("font-family:'microsoft yahei'"),fish.all(".mSlider_con ul li img").lazyLoad({attr:"data-img-src",preSpace:50}),fish.one("#visaCommElem").length<=0&&fish.all(".f_tit li").each(function(e){var i=fish.one(e).attr("attr-id");3==i&&fish.one(e).html("remove")}),w(),f(),k(),j(),L(),T(),I(),b(),o(),S(),O(),B.usi?c(fish.one("#collectLine").attr("attr-url"),"searchnew"):"";var e=fish.one("#ip").attr("val"),i=fish.cookie.get("us","userid"),t=fish.one("#CurrentUrl").attr("val"),s=fish.one("#shareText").attr("val"),a=fish.one("#sharesummary").attr("val"),n="";n=i?t+"?refid="+i+"&Ip="+e:t,E({elem:fish.one("#shareContent .share_d"),url:n,title:s,summary:a,wxurl:n})}),fish.loaded(function(){b()})}(),fish.admin.config({Calendar:{v:"0.3",css:"0.3",g:2015032101}}),!function(e,i,t){var s=s||{};e.lang.extend(s,{init:function(){this.bindEvent()},bindEvent:function(){function i(i){var t=e.one(this),s=t.val();t&&t[0]&&s.length&&t.removeClass("placeholder")}function t(i){var t=e.one(this),s=t.val();t&&t[0]&&!s.length&&t.addClass("placeholder")}e.all("#TopProductElem .prn-btn").once("jjtxObj",function(){e.one(this).on("click",function(){var i=e.one(this).parent(".p_infro");i=e.one(".pri_d b",i[0]).html(),i=parseInt(i,10),i=isNaN(i)?1:1>i?1:i>999999?999999:i,e.one(".ylc-modal-priceremind #iptPrnPrice").val(i),e.mPop({content:e.one(".pri-rem-notice"),beforeClose:function(){s.$cal.hide()}}),e.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=CruiseHomePageWindowStatistic&value=CutPriceNotifyClick"})})}),e.all(".ylc-modal-priceremind .ylc-m-close").once("jjtxObj",function(){e.one(this).on("click",function(){e.mPop.close()})}),e.all(".ylc-modal-priceremind #iptPrnPrice").once("jjtxObj",function(){function i(i){var t,s=e.one(this);t=parseInt(e.trim(s.val()),10),t=isNaN(t)?1:1>t?1:t>999999?999999:t,s.val(t)}e.one(this).on("change",i).on("blur",i),i.call(this,e.getEvent())}),e.all(".ylc-modal-priceremind #iptPrnStartTime").once("jjtxObj",function(){var i=new Date,t=new Date;t=new Date(t.setFullYear(t.getFullYear()+5)),e.require("Calendar",function(){var a=new e.Calendar({skin:"white",startDate:e.parseTime(i),endDate:e.parseTime(t)});s.$cal=a,e.one(".ylc-modal-priceremind #iptPrnStartTime").on("click",function(){e.one(this).addClass("ylc-calendar-target");var s=e.trim(e.one(".ylc-modal-priceremind #iptPrnEndTime").val());s.length&&(t=e.parseDate(s,{days:-1})),a.pick({elem:this,currentDate:i,startDate:new Date,endDate:t,fn:function(i,s,n,o,l){e.one(this.elem).removeClass("placeholder"),e.one(".ylc-modal-priceremind #iptPrnEndTime").removeClass("placeholder");var r=e.parseTime(e.one(l).val(),{days:1}),c=new Date;t=new Date(c.setFullYear(c.getFullYear()+5)),a.pick({elem:e.dom(".ylc-modal-priceremind #iptPrnEndTime"),startDate:r,currentDate:[r],endDate:t})}})}),e.one(".ylc-modal-priceremind #iptPrnEndTime").on("click",function(){e.one(this).addClass("ylc-calendar-target");var s=e.trim(e.one(".ylc-modal-priceremind #iptPrnStartTime").val());s.length&&(i=e.parseDate(s,{days:1}));var n=new Date;t=new Date(n.setFullYear(n.getFullYear()+5)),a.pick({elem:this,startDate:i,endDate:t,fn:function(i,t,s,a,n){e.one(this.elem).removeClass("placeholder")}})})})}),e.all(".ylc-modal-priceremind #iptPrnName").once("jjtxObj",function(){function s(){var e=/^[^@\/\'\\\"#$%&\^\*\(!\^\*\;\:\>\<\-\|]+$/;return e.test(arguments[0])}e.one(this).on("focus",i).on("input",i).on("keydown",i).on("keyup",i).on("blur",t).on("change",t).on("change",function(){var i=e.trim(e.one(this).val()||"");e.one(this).removeClass("error"),i.length&&(i.length>30||!s(i))&&e.one(this).addClass("error")})}),e.all(".ylc-modal-priceremind #iptPrnPhone").once("jjtxObj",function(){function s(){var e=/^1[34578][0-9]\d{8,8}$/;return e.test(arguments[0])}e.one(this).on("focus",i).on("input",i).on("keydown",i).on("keyup",i).on("blur",t).on("change",t).on("change",function(){var i=e.trim(e.one(this).val()||"");e.one(this).removeClass("error"),e.one(".prn-err",this.parentNode).css("display:none;"),i.length&&i.length<31&&s(i)||(e.one(this).addClass("error"),e.one(".prn-err",this.parentNode).css("display:block;"))})}),e.one(".pri-rem-notice .ylc-m-ok").once("jjtxObj",function(){e.one(this).on("click",function(){s.submitFn.call(s)})}),e.one(".pri-rem-ok .ylc-m-ok").once("jjtxObj",function(){e.one(this).on("click",function(){e.mPop.close()})}),e.one(".pri-rem-fail .ylc-m-ok").once("jjtxObj",function(){e.one(this).on("click",function(){e.mPop.close(),e.mPop({content:e.one(".pri-rem-notice"),beforeClose:function(){s.$cal.hide()}})})}),e.one(".pri-rem-notice").once("jjtxObj",function(){e.one(this).on("click",function(i){var t=e.one(e.getTarget(i)),a=!1,n=s.$cal;a=a||t.hasClass("ylc-calendar-target"),a=a||t.hasClass("calendar-panel"),a=a||t.parent(".calendar-panel").length>0,a=a&&t.parent(".ylc-modal-priceremind").length>0,!a&&n&&n.hide&&n.hide()})})},submitFn:function(){function i(){var e=/^[^@\/\'\\\"#$%&\^\*\(!\^\*\;\:\>\<\-\|]+$/;return e.test(arguments[0])}function t(){var e=/^1[34578][0-9]\d{8,8}$/;return e.test(arguments[0])}var s="expectedPrice={0}&startDate={1}&endDate={2}&customerName={3}&customerMobile={4}",a=[],n=!0,o=e.one(".ylc-modal-priceremind #iptPrnPrice").val();return o=isNaN(o)?1:1>o?1:o>999999?999999:o,a.push(o),o=e.trim(e.one(".ylc-modal-priceremind #iptPrnStartTime").val()),a.push(o),o=e.trim(e.one(".ylc-modal-priceremind #iptPrnEndTime").val()),a.push(o),o=e.trim(e.one(".ylc-modal-priceremind #iptPrnName").val()),e.one(".ylc-modal-priceremind #iptPrnName").removeClass("error"),o.length?o.length>30||!i(o)?(n=!1,e.one(".ylc-modal-priceremind #iptPrnName").addClass("error"),a.push("-")):a.push(o):a.push("-"),o=e.trim(e.one(".ylc-modal-priceremind #iptPrnPhone").val()),e.one(".ylc-modal-priceremind #iptPrnPhone").removeClass("error"),e.one(".prn-err",e.dom(".ylc-modal-priceremind #iptPrnPhone").parentNode).css("display:none;"),o.length&&o.length<31&&t(o)?a.push(o):(n=!1,e.one(".ylc-modal-priceremind #iptPrnPhone").addClass("error"),e.one(".prn-err",e.dom(".ylc-modal-priceremind #iptPrnPhone").parentNode).css("display:block;"),a.push("-")),n?(this.submitFn.ajaxObj&&this.submitFn.ajaxObj.abort(),void(this.submitFn.ajaxObj=e.ajax({url:"/youlun/CruiseRequireOrder/FinalPageRequireOrder.ashx",openType:"post",data:s.format.apply(s,a),fn:function(i){e.mPop.close(),"suc"==i&&e.mPop({content:e.one(".pri-rem-ok")}),i.indexOf("fail")>=0&&e.mPop({content:e.one(".pri-rem-fail")})},err:function(){e.mPop.close(),e.mPop({content:e.one(".pri-rem-fail")})}}))):!1}}),e.ready(function(){s.init()})}(fish,window,document),function(e){function i(e){var i={showCon:fish.one(""),shadowBg:fish.one(""),clickBgClose:!0,closeBut:fish.one(""),closeAfterFn:function(e,i){},showBeforeFn:function(e,i){}};fish.lang.extend(i,e);var t=i,s={show:function(){t.showBeforeFn(t.showCon,t.shadowBg),t.shadowBg.removeClass("none"),t.showCon.removeClass("none")},close:function(){t.shadowBg.addClass("none"),t.showCon.addClass("none"),t.closeAfterFn(t.showCon,t.shadowBg)}};return t.closeBut.on("click",function(){s.close()}),t.clickBgClose===!0&&t.shadowBg.on("click",function(){s.close()}),s}function t(e){if(!e||!e[0])return!1;var i=e.width(),t=e.height();e.css("position:fixed;left:50%;top:50%;marginLeft:"+-i/2+"px;marginTop:"+-t/2+"px;")}fish.admin.config({Calendar:{v:"0.3",css:"0.3",g:2015032101}});var s={init:function(){this.formConBox=i({showCon:fish.one(".tj_con_box"),shadowBg:fish.one(".tj_shadow"),closeBut:fish.one(".tj_con_box .s_close"),showBeforeFn:function(e,i){t(e)}}),this.msgForm=i({showCon:fish.one(".tj_alert_box"),shadowBg:fish.one(".tj_shadow"),closeBut:fish.one(".tj_alert_box .alert_close"),showBeforeFn:function(e,i){t(e)}}),this.codeObj.init(),this.bindEvent()},restAllInput:function(){for(var e=fish.all(".dl_tj_cos dl dd input"),i=0,t=e.length;t>i;i++){var s=fish.one(e[i]);s.attr("_placeholder")?s.addClass("place_holder").val(s.attr("_placeholder")):s.val("")}fish.one(".dl_tj_cos dl.is_adjust dd span.is_check_adjust").removeClass("is_checked"),
fish.one(".dl_tj_cos dl dd input.input_is_adjust").val(0),fish.all(".dl_tj_cos dl dd").removeClass("has_error"),this.codeObj.resetCode()},bindEvent:function(){var e=this,i=fish.one(".dl_tj_cos a.sub_data"),t=fish.all(".dl_tj_cos dl.eve_yusuan dd input,.dl_tj_cos dl.cust_name dd input,.dl_tj_cos dl.cust_mobile dd input,.dl_tj_cos dl.code dd input"),a=fish.one(".dl_tj_cos dl.is_adjust dd span.is_check_adjust"),n=fish.one(".dl_tj_cos dl dd input.input_is_adjust");this.inputObj.bindPlaceHolder(t),this.inputObj.filterKeyUp(fish.one(".dl_tj_cos dl.travel_num dd input"),"[^\\d]",3),this.inputObj.filterKeyUp(fish.one(".dl_tj_cos dl.eve_yusuan dd input"),"[^\\d]",13),i.on("click",function(){return i.hasClass("sub_no_act")?!1:void(e.subCheck()&&(fish.one("#hidFinalLineId").val(fish.one("#HidLineid").val()),i.addClass("sub_no_act").html("提交中..."),fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx",data:"action=SpecialReserOrder&"+e.getInputDataToStr(),openType:"post",type:"json",fn:function(t){if(i.removeClass("sub_no_act").html("提交"),!t)return e.alertMsgFn(0),!1;switch(t.ResultCode){case-100:s.msgCtrl.show(fish.dom(".dl_tj_cos dl.code dd input"),"验证码输入错误！");break;case 1:e.alertMsgFn(1),e.restAllInput();break;case 8:e.alertMsgFn(2),e.restAllInput();break;default:e.alertMsgFn(0)}}})))}),fish.one(".tj_alert_box .s_con").delegate(".close_but","click",function(){e.msgForm.close()}),fish.one(".price_btn .but_tjyy").on("click",function(){var i=fish.dom(".ylc-nav .ylc-special-price");if(i)return i.click(),e.statcClick(),!1;var t=fish.one(".dl_tj_cos dl.eve_yusuan dd input"),s=fish.one("#hidRate").val();t.hasClass("place_holder")&&t.val()==t.attr("_placeholder")&&t.val(s),t.attr("_placeholder",s),e.formConBox.show(),e.statcClick()}),a.on("click",function(){a.hasClass("is_checked")?(a.removeClass("is_checked"),n.val(0)):(a.addClass("is_checked"),n.val(1))}),fish.all(".dl_tj_cos dl.cust_name dd input,.dl_tj_cos dl.cust_mobile dd input,.dl_tj_cos dl.code dd input").on("focus",function(){e.msgCtrl.close(this)})},inputObj:{bindPlaceHolder:function(e){return e&&e[0]?void e.on("focus",function(){var e=fish.one(this);thisVal=e.val(),thisPlaceHolder=e.attr("_placeholder"),thisVal==thisPlaceHolder&&e.hasClass("place_holder")&&e.val("").removeClass("place_holder")}).on("blur",function(){var e=fish.one(this);thisVal=e.val(),thisPlaceHolder=e.attr("_placeholder"),thisVal.length<=0&&e.val(thisPlaceHolder).addClass("place_holder")}):!1},filterKeyUp:function(e,i,t){if(!(e&&e[0]&&i&&t))return!1;var s=new RegExp(i,"g");e.on("keyup",function(){var e=fish.one(this),i=e.val().substr(0,t).replace(s,"");e.val(i)})}},msgCtrl:{show:function(e,i){return!e||!i||i.length<=0?!1:($parent=fish.one(e).parent("dd"),$parent.addClass("has_error"),void fish.one(".err_msg",$parent[0]).html("<i></i>"+i))},close:function(e){return e?($parent=fish.one(e).parent("dd"),$parent.removeClass("has_error"),void fish.one(".err_msg",$parent[0]).html("<i></i>")):!1}},codeObj:{init:function(){this.getCodeFlag=!0,this.bindEvent()},bindEvent:function(){var e=this;fish.one(".dl_tj_cos dl.code dd span.get_code").on("click",function(){s.checkObj.checkPhone()&&e.getCodeFlag===!0&&(e.getCode(),e.timerCode(6e4))})},getCode:function(){fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx",data:"action=GetSmsAuthCode&custMobile="+fish.one(".dl_tj_cos dl.cust_mobile dd input").val(),fn:function(){}})},timerCode:function(e){var i=this,t=fish.one(".dl_tj_cos dl.code dd span.get_code"),s=fish.one("span i",t[0]),a=e||3e4,n=500;this.timerD=setInterval(function(){0>=a&&(i.getCodeFlag=!0,t.removeClass("no_active"),clearInterval(i.timerD)),s.html(Math.round(a/1e3)),a-=n},n),s.html(Math.round(a/1e3)),this.getCodeFlag=!1,t.addClass("no_active")},resetCode:function(){var e=fish.one(".dl_tj_cos dl.code dd span.get_code"),i=fish.one("span i",e[0]);this.getCodeFlag=!0,e.removeClass("no_active"),i.html("0"),this.timerD&&clearInterval(this.timerD)}},subCheck:function(){return this.checkObj.checkName()&this.checkObj.checkPhone()&this.checkObj.checkCode()},checkObj:{checkName:function(){var e=fish.one(".dl_tj_cos dl.cust_name dd input"),i=/^[^@\/\'\\\"#$%&\^\*\(!\^\*\;\:\>\<\-\|]+$/,t=fish.trim(e.val()),a=fish.trim(e.attr("_placeholder"));return t=e.hasClass("place_holder")&&t==a?"":t,t.length<=0?(s.msgCtrl.show(e[0],"请填写联系人姓名！"),!1):i.test(t)?(s.msgCtrl.close(e[0]),!0):(s.msgCtrl.show(e[0],"姓名中包含非法字符！"),!1)},checkPhone:function(){var e=fish.one(".dl_tj_cos dl.cust_mobile dd input"),i=/^(13[0-9]|15[0-9]|17[0-9]|18[0-9]|147)\d{8}$/,t=fish.trim(e.val()),a=fish.trim(e.attr("_placeholder"));return t=e.hasClass("place_holder")&&t==a?"":t,t.length<=0?(s.msgCtrl.show(e[0],"请输入手机号！"),!1):i.test(t)?(s.msgCtrl.close(e[0]),!0):(s.msgCtrl.show(e[0],"请输入正确的手机号！"),!1)},checkCode:function(){var e=fish.one(".dl_tj_cos dl.code dd input"),i=fish.trim(e.val()),t=fish.trim(e.attr("_placeholder"));return i=e.hasClass("place_holder")&&i==t?"":i,i.length<=0?(s.msgCtrl.show(e[0],"请输入验证码！"),!1):(s.msgCtrl.close(e[0]),!0)}},getInputDataToStr:function(){for(var e=fish.all(".dl_tj_cos input"),i="",t=0,s=e.length;s>t;t++){var a=fish.one(e[t]),n=a.attr("_placeholder"),o=a.hasClass("place_holder")&&a.val()==n?"":a.val(),l=a.attr("name");i+="&"+l+"="+encodeURIComponent(fish.trim(o))}return i.substr(1)},alertMsgFn:function(e){var i="";switch(e){case 2:i='<h4 class="h4_txt">亲~您已经提交过哦</h4>					        <p class="ps">客服将尽快联系您<br/>请不要拒接0512开头的电话</p>					        <span class="msg_dbg success_sbg"></span>					        <span class="close_but">关闭</span>';break;case 0:i='<h4 class="h4_txt">提交失败！</h4>					        <span class="msg_dbg fail_sbg"></span>					        <span class="close_but">关闭</span>';break;case 1:i='<h4 class="h4_txt">通知预约成功！</h4>					        <p class="ps">客服将尽快联系您<br/>请不要拒接0512开头的电话</p>					        <span class="msg_dbg success_sbg"></span>					        <span class="close_but">关闭</span>'}i.length>=0&&(fish.one(".tj_alert_box .s_con").html(i),this.formConBox.close(),this.msgForm.show())},statcClick:function(){var e=fish.one("#hidIsFinalPage").val();fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx?action=SpecialReserClick&isFinal="+e,fn:function(){}})}};fish.one(document).ready(function(){s.init()})}(window),function(e){function i(e,i){if(i.k&&(i.k=decodeURIComponent(i.k)),i.ct&&(i.ct=decodeURIComponent(i.ct)),!e||!e.trim())return!1;var t="";for(key in i)null!==i[key]&&void 0!==i[key]&&""!==i[key]&&(t+="|*|"+key+":"+i[key]);try{t.length>0&&(t+="|*|"),_tcTraObj._tcTrackEvent("search","/cruises/detail",e,t)}catch(s){}}function t(e){var t={type:1,lable:"",value:{}};fish.lang.extend(t,e);var s=t.lable.replace(/\//g,"_");1==t.type?fish.cookie.set(s,1):2==t.type&&1==fish.cookie.get(s)&&(fish.cookie.remove(s),i(t.lable,t.value))}String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var s=fish.one("#HidLineid").val();t({lable:"/show",type:2,value:{resId:s}}),fish.all(".ele_topDom .link_order,.fix_order .fix_order_link").each(function(e,t){e.index=t,fish.one(e).on("click",function(e){i("/book",{pos:this.index-0+1,pjId:"2007",resId:s})})}),e.searchTrackEvent=i,e.trackEventUseCookie=t}(window);