function hot520(){function e(e){return'<span class="comm_cut none"><span class="comm_mian"><span class="comm_s"></span><em>'+e+"</em></span></span>"}var t="",s=(new Date).getTime(),i=new Date("2016/07/01").getTime();if(i>s){var a='即日起至6月30日凡购买同程邮轮任意产品,成功付款购买后将获得孝心口令，凭该口令在善诊公众号可以免费预约价值235元的健康体检，快来送爸妈（45周岁以上）一份守护。<a href="http://www.ly.com/news/detail-64433.html" target="_blank">查看详情</a>';t+='<p class="other_h"><span class="price_yh">促销优惠：<span class="other_a">买邮轮送体检'+e(a)+"</span></span></p>"}fish.one(".pr_mg").html("top",t)}function make_canael(e){var t=fish.one("#calendar_wrapper").attr("attr-url");fish.one(".calendar_wrapper").calendar({url:t+"&startdate={startdate}&enddate={enddate}&year={year}&month={month}",getMonthData:processData,getDayData:makeItem,click:function(t,s,i,a){var n=fish.one("#HidLineid").val(),o=(fish.one(this).attr("data-date"),"/youlun/linebook/"+n+"_"+s+"-"+i+"-"+a+".html");window.open(o.addParams(e))},clickable:function(e){return e&&e.price?0!=parseInt(e.price,10):!1}})}function processData(e){for(var t=[],s=1;31>=s;s++)t.push({price:0,day:s,shipname:0});for(var i=e.PriceList.length,s=0;i>s;s++){var a=new Date(fish.parseDate(e.PriceList[s].date)),n=parseInt(a.getDate())-1;t[n].price=e.PriceList[s].price}return t}function makeItem(e){var t="";return e&&e.price?0!=parseInt(e.price,10)&&(t='<div class="mcalpricebox"><span class="Yday_price">&yen;<strong>'+parseInt(e.price)+"</strong></span>起</div>"):t="",t}function GetQueryString(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),s=window.location.search.substr(1).match(t);return null!=s?unescape(s[2]):null}function stringFromJson(e){var t="";for(var s in e)t+=s+"="+e[s]+"&";return t.substring(0,t.length-1)}fish.admin.config({Calendar:{v:"0.3",css:"0.3",g:2015032101},anim:{v:"0.3",g:2016061704}});var ylcNavObj=ylcNavObj||{};!function(e,t,s,i){function a(e){return e=parseInt(e,10),isNaN(e)?0:0>e?0:e}e.lang.extend(ylcNavObj,{init:function(){var i=this;setTimeout(function(){i.specReserTips.init.call(i.specReserTips)},3e3),o.changePic(),e.one(".ylc-nav .ylc-item").once("ylcNavObj",function(){e.one(this).on("click",function(){e.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=CruiseHomePageWindowStatistic&value=ActivityClick"})})}),e.one(".ylc-nav .ylc-gotop").once("ylcNavObj",function(){e.one(this).on("click",function(){e.dom("body").scrollTop=0,e.dom("html").scrollTop=0})});var a=function(){e.one(this).scrollTop()>50?e.one(".ylc-nav .ylc-gotop").css("visibility: visible;"):e.one(".ylc-nav .ylc-gotop").css("visibility: hidden;")};e.one(t).once("ylcNavObj",function(){e.one(t).on("scroll",a),a()}),e.one(".ylc-nav .ylc-plus .ylc-plus-close").once("ylcNavObj",function(){e.one(this).on("click",function(){var t=(e.one(this),e.one(".ylc-nav .ylc-plus")),s=fish.browser();"ms"==s.name&&s.version<10?t.html("remove"):(t.removeClass("fadeInDown").addClass("fadeInUp"),setTimeout(function(){t.html("remove")},1600))})}),e.one(".ylc-nav .ylc-plus .ylc-plus-cont").once("ylcNavObj",function(){e.one(this).on("click",function(){var t=(e.one(this),e.one(".ylc-nav .ylc-plus .ylc-plus-tips"));t.length&&t.css({display:"block"}),e.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=CruiseDetailPageWindowStatistic&value=DiscountClick"})})}),e.one(s).once("ylcNavObj",function(){e.one(this).on("click",function(t){var s=e.one(fish.getTarget(t)),i=s.parent(".ylc-plus");s.hasClass("ylc-plus")||i.length>0||e.one(".ylc-nav .ylc-plus .ylc-plus-tips").length&&e.one(".ylc-nav .ylc-plus .ylc-plus-tips").css({display:"none"})})})},specReserDialog:{init:function(){},bindEvent:function(){},isFinal:function(){var t=e.one("#hidIsFinalPage"),s=e.one("#hidFinalLineId"),i=e.one("#hidTjBeginDate");return t&&t[0]&&a(t.val())&&s&&s[0]&&a(s.val())&&i&&i[0]&&e.trim(i.val()).length>0}},specReserTips:{poll:function(){var t=this;return this.tipTimer&&clearInterval(this.tipTimer),this.hideTimer&&(clearTimeout(this.hideTimer),e.one(".ylc-nav .ylc-tips").removeClass("open")),this.DATA&&this.DATA.length?(this.show(),this.hideTimer=setTimeout(function(){e.one(".ylc-nav .ylc-tips").removeClass("open")},3e3),void(this.tipTimer=setInterval(function(){var s=a(e.one(".ylc-modal-tips p").attr("t-attr"));e.one(".ylc-modal-tips p").anim("top:"+(0-s-22)+"px",600,function(){var s=a(e.one(".ylc-modal-tips p").attr("t-attr"));s>=22*t.DATA.length&&(e.one(".ylc-modal-tips p").css({top:"0px"}),e.one(".ylc-modal-tips p").attr("t-attr",0))}),e.one(".ylc-modal-tips p").attr("t-attr",s+22)},4200))):!1},show:function(){if(!this.DATA||!this.DATA.length)return!1;var t=e.all(".ylc-nav .ylc-tips"),s=e.all(".ylc-modal-tips"),i="{0}成功预约{1}人出游",a="";sytObj.forEach(this.DATA,function(e,t){a+=("<span>"+i+"</span>").format(t.Mobile||"",t.PersonNum||"")}),a+=("<span>"+i+"</span>").format(this.DATA[0].Mobile||"",this.DATA[0].PersonNum||""),t.html(i.format(this.DATA[0].Mobile||"",this.DATA[0].PersonNum||"")),e.one("p",s).html(a),e.one("p",s).attr("t-attr",0),e.one("p",s).css({top:"0"}),t.addClass("open"),s.addClass("open")},hide:function(){var t=e.all(".ylc-nav .ylc-tips,.ylc-modal-tips");t.removeClass("open")},load:function(){var t=this;this.loadTimer&&clearTimeout(this.loadTimer),e.ajax({url:"/youlun/cruiserequireorder/homepageRequireorder.ashx?action=GetRequireOrder&top=10",type:"json",fn:function(e){e&&e.length&&e[0]&&"object"==typeof e&&(t.DATA=e,t.poll.call(t)),t.loadTimer=setTimeout(function(){t.load.call(t)},18e4)}})},init:function(){this.load()}}});var n=n||{};e.lang.extend(n,{init:function(){ylcNavObj.specReserDialog.isFinal()?(o.setDialogTitle(),e.all(".ylc-m-title").removeClass("none"),e.all(".ylc-m-time").addClass("none")):(e.all(".ylc-m-title").addClass("none"),e.all(".ylc-m-time").removeClass("none")),this.formConBox=n.alertFormCtrl({showCon:fish.one(".ylc-modal"),shadowBg:fish.one(".ylc-modal-layer"),closeBut:fish.one(".ylc-modal .ylc-modal-head a"),showBeforeFn:function(e,t){n.cirCenter(e)}}),this.msgForm=n.alertFormCtrl({showCon:fish.one(".ylc-modal-rs"),shadowBg:fish.one(".ylc-modal-layer"),closeBut:fish.one(".ylc-modal-rs .ylc-mr-close"),showBeforeFn:function(e,t){n.cirCenter(e)}}),this.cruiseObj.init(),this.tripDateObj.init(),this.codeObj.init(),this.bindEvent()},restAllInput:function(){for(var e=fish.all(".ylc-modal dl dd input"),t=0,s=e.length;s>t;t++){var i=fish.one(e[t]);i.attr("_placeholder")?i.addClass("place_holder").val(i.attr("_placeholder")):i.val("")}fish.one(".ylc-modal dl dd span.no_enter").removeClass("checked"),this.tripDateObj.noDateflag=!1,fish.all(".ylc-modal dl dd").removeClass("has_error"),this.codeObj.resetCode()},bindEvent:function(){var e=this,t=fish.one(".ylc-modal .ylc-modal-foot a.sub_data"),s=fish.all(".ylc-modal dl.eve_yusuan dd input,.ylc-modal dl.cust_name dd input,.ylc-modal dl.cust_mobile dd input,.ylc-modal dl.code dd input");this.inputObj.bindPlaceHolder(s),this.inputObj.filterKeyUp(fish.all(".ylc-modal dl.travel_num dd input"),"[^\\d]",3),this.inputObj.filterKeyUp(fish.one(".ylc-modal dl.eve_yusuan dd input"),"[^\\d]",13),t.on("click",function(){return t.hasClass("sub_no_act")?!1:void(e.subCheck()&&(t.addClass("sub_no_act").html("提交中..."),fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx",data:"action=SpecialReserOrder&"+e.getInputDataToStr(),openType:"post",type:"json",fn:function(s){if(t.removeClass("sub_no_act").html("提交"),!s)return e.alertMsgFn(0),!1;switch(s.ResultCode){case-100:n.msgCtrl.show(fish.dom(".ylc-modal dl.code dd input"),"验证码输入错误！");break;case 1:e.alertMsgFn(1),e.restAllInput();break;case 8:e.alertMsgFn(2),e.restAllInput();break;default:e.alertMsgFn(0)}}})))}),fish.one(".ylc-modal-rs .s_con").delegate(".close_but","click",function(){e.msgForm.close()}),fish.one(".ylc-nav .ylc-special-price").on("click",function(){e.cruiseObj.drawLine(),e.formConBox.show(),e.statcClick(),o.setDialogTitle()}),fish.all(".ylc-modal dl.cust_name dd input,.ylc-modal dl.cust_mobile dd input,.ylc-modal dl.code dd input").on("focus",function(){e.msgCtrl.close(this)})},inputObj:{bindPlaceHolder:function(e){return e&&e[0]?void e.on("focus",function(){var e=fish.one(this);thisVal=e.val(),thisPlaceHolder=e.attr("_placeholder"),thisVal==thisPlaceHolder&&e.hasClass("place_holder")&&e.val("").removeClass("place_holder")}).on("blur",function(){var e=fish.one(this);thisVal=e.val(),thisPlaceHolder=e.attr("_placeholder"),thisVal.length<=0&&e.val(thisPlaceHolder).addClass("place_holder")}):!1},filterKeyUp:function(e,t,s){if(!(e&&e[0]&&t&&s))return!1;var i=new RegExp(t,"g");e.on("keyup",function(){var e=fish.one(this),t=e.val().substr(0,s).replace(i,"");e.val(t)})}},msgCtrl:{show:function(e,t){return!e||!t||t.length<=0?!1:($parent=fish.one(e).parent("dd"),$parent.addClass("has_error"),void fish.one(".err_msg",$parent[0]).html("<i></i>"+t))},close:function(e){return e?($parent=fish.one(e).parent("dd"),$parent.removeClass("has_error"),void fish.one(".err_msg",$parent[0]).html("<i></i>")):!1}},cruiseObj:{init:function(){this.bindEvent()},bindEvent:function(){var t=fish.one(".ylc-modal .ylc-sltport"),i=fish.one(".ylc-modal dl.route_port dd input");i.addClass("scon_tar_show"),i.on("click",function(){var s=e.one(this).offset().left,i=e.one(this).offset().top+30;s-=e.one(".ylc-modal").offset().left,i-=e.one(".ylc-modal").offset().top,t.css("display:block;top:"+i+"px;left:"+s+"px;")}),t.addClass("scon_tar_show").delegate(".ylc-sltport-content a","click",function(e){var s=fish.one(fish.getTarget(e));i.removeClass("place_holder").val(s.attr("attr-val")),t.css({display:"none"})}),fish.one(s).on("click",function(e){var s=fish.getTarget(e),i=fish.one(s),a=i.parent(".scon_tar_show");return i.hasClass("scon_tar_show")||a.length>=1?!0:void t.css({display:"none"})}),fish.one(".ylc-sltport-close",t[0]).on("click",function(){t.css({display:"none"})})},drawLine:function(){return this.drawLineHasData?!1:(this.drawLineHasData=!0,void fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx?action=SearchRouteData",type:"json",fn:function(e){if(!e||!e[0])return!1;for(var t="",s=0,i=e.length;i>s;s++)t+="<a class='{0}' href='javascript:;' {2} attr-val='{1}'>{1}</a>".format("",fish.trim(e[s].CrName||""),"");fish.all(".ylc-modal .ylc-sltport-body").html("<div class='ylc-sltport-content '>"+t+"</div>")}}))}},tripDateObj:{init:function(){this.bindEvent(),this.noDateflag=!1},bindEvent:function(){var e=this,t=fish.one(".ylc-modal dl.tour_date dd input.input_start_date"),i=fish.one(".ylc-modal dl.tour_date dd input.input_end_date"),a=fish.one(""),n=fish.one("");fish.one(".ylc-modal dl dd span.no_enter").on("click",function(){var s=fish.one(this);s.hasClass("checked")?(s.removeClass("checked"),e.noDateflag=!1):(s.addClass("checked"),t.val(t.attr("_placeholder")).addClass("place_holder"),i.val(i.attr("_placeholder")).addClass("place_holder"),e.noDateflag=!0)}),fish.require("Calendar",function(){var s=new Date;s.setFullYear(s.getFullYear()+5),t.on("focus",function(o){if(e.noDateflag)return!1;a.html("remove");var l=new fish.Calendar({skin:"white",style:"show",wrapper:fish.all(".ylc-modal dl.tour_date dd .s_show_div")[0],elem:this,startDate:new Date,endDate:i.val()&&i.val()!=i.attr("_placeholder")?new Date(new Date(i.val().replace(/-/g,"/")).getTime()-864e5):s,fn:function(o,l,r,c,h){a.addClass("none"),t.removeClass("place_holder"),i.removeClass("place_holder");var d=new Date(o+"/"+l+"/"+r).getTime()+864e5;n.html("remove");var f=new fish.Calendar({skin:"white",style:"show",wrapper:fish.all(".ylc-modal dl.tour_date dd .s_show_div")[1],startDate:new Date(d),endDate:s,elem:i[0],currentDate:[new Date(d)],fn:function(e,t,s,i,a){n.addClass("none")}});n=fish.one(f.panel),n.parent(".s_show_div").addClass("tar_cal_jenvent"),n.css("position:absolute;top:30px;left:0;z-index:2;"),e.setCalPosition(n)}});a=fish.one(l.panel),a.parent(".s_show_div").addClass("tar_cal_jenvent"),a.css("position:absolute;top:36px;left:0;z-index:2;"),e.setCalPosition(a)}),i.on("focus",function(a){if(e.noDateflag)return!1;var o=t.val()&&t.val()!=t.attr("_placeholder")?new Date(new Date(t.val().replace(/-/g,"/")).getTime()+864e5):new Date((new Date).getTime()+864e5);n.html("remove");var l=new fish.Calendar({skin:"white",style:"show",wrapper:fish.all(".ylc-modal dl.tour_date dd .s_show_div")[1],elem:this,startDate:o,endDate:s,fn:function(e,t,s,a,o){i.removeClass("place_holder"),n.addClass("none")}});n=fish.one(l.panel),n.parent(".s_show_div").addClass("tar_cal_jenvent"),n.css("position:absolute;top:36px;left:0;z-index:2;"),e.setCalPosition(n)})}),fish.one(s).on("click",function(e){var t=fish.one(fish.getTarget(e)),s=t.parent(".tar_cal_jenvent");return t.hasClass("tar_cal_jenvent")||s.length>=1?!1:(a.addClass("none"),void n.addClass("none"))}),t.on("click",function(e){n.addClass("none")}),i.on("click",function(e){a.addClass("none")})},setCalPosition:function(e){var s=e.parent(".ylc-modal"),i=fish.one(t).width(),a=s.width(),n=e.width(),o=e.offset().left+n-s.offset().left-a,l=(i-a)/2-o;0>l&&e.css("left:"+l+"px;")}},calCreateFn:function(e){},codeObj:{init:function(){this.getCodeFlag=!0,this.bindEvent()},bindEvent:function(){var e=this;fish.one(".ylc-modal dl.code dd span.get_code").on("click",function(){n.checkObj.checkPhone()&&e.getCodeFlag===!0&&(e.getCode(),e.timerCode(6e4))})},getCode:function(){fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx",data:"action=GetSmsAuthCode&custMobile="+fish.one(".ylc-modal dl.cust_mobile dd input").val(),fn:function(){}})},timerCode:function(e){var t=this,s=fish.one(".ylc-modal dl.code dd span.get_code"),i=fish.one("span i",s[0]),a=e||3e4,n=500;this.timerD=setInterval(function(){0>=a&&(t.getCodeFlag=!0,s.removeClass("no_active"),clearInterval(t.timerD)),i.html(Math.round(a/1e3)),a-=n},n),i.html(Math.round(a/1e3)),this.getCodeFlag=!1,s.addClass("no_active")},resetCode:function(){var e=fish.one(".ylc-modal dl.code dd span.get_code"),t=fish.one("span i",e[0]);this.getCodeFlag=!0,e.removeClass("no_active"),t.html("0"),this.timerD&&clearInterval(this.timerD)}},subCheck:function(){return this.checkObj.checkName()&this.checkObj.checkPhone()&this.checkObj.checkCode()},checkObj:{checkName:function(){var e=fish.one(".ylc-modal dl.cust_name dd input"),t=/^[^@\/\'\\\"#$%&\^\*\(!\^\*\;\:\>\<\-\|]+$/,s=fish.trim(e.val()),i=fish.trim(e.attr("_placeholder"));return s=e.hasClass("place_holder")&&s==i?"":s,s.length<=0?(n.msgCtrl.show(e[0],"请填写联系人姓名！"),!1):t.test(s)?(n.msgCtrl.close(e[0]),!0):(n.msgCtrl.show(e[0],"姓名中包含非法字符！"),!1)},checkPhone:function(){var e=fish.one(".ylc-modal dl.cust_mobile dd input"),t=/^(13[0-9]|15[0-9]|17[0-9]|18[0-9]|147)\d{8}$/,s=fish.trim(e.val()),i=fish.trim(e.attr("_placeholder"));return s=e.hasClass("place_holder")&&s==i?"":s,s.length<=0?(n.msgCtrl.show(e[0],"请输入手机号！"),!1):t.test(s)?(n.msgCtrl.close(e[0]),!0):(n.msgCtrl.show(e[0],"请输入正确的手机号！"),!1)},checkCode:function(){var e=fish.one(".ylc-modal dl.code dd input"),t=fish.trim(e.val()),s=fish.trim(e.attr("_placeholder"));return t=e.hasClass("place_holder")&&t==s?"":t,t.length<=0?(n.msgCtrl.show(e[0],"请输入验证码！"),!1):(n.msgCtrl.close(e[0]),!0)}},getInputDataToStr:function(){var t,s="";t=ylcNavObj.specReserDialog.isFinal()?e.all("#hidIsFinalPage,#hidFinalLineId,#hidTjBeginDate,.ylc-m-title .eve_yusuan input,.ylc-m-title .travel_num input,.cust_name input,.cust_mobile input,.code input",e.one(".ylc-modal")):e.all(".ylc-m-time .route_port input,.ylc-m-time .travel_num input,.ylc-m-time .tour_date input,.cust_name input,.cust_mobile input,.code input",e.one(".ylc-modal"));for(var i=0,a=t.length;a>i;i++){var n=fish.one(t[i]),o=n.attr("_placeholder"),l=n.hasClass("place_holder")&&n.val()==o?"":n.val(),r=n.attr("name");s+="&"+r+"="+encodeURIComponent(l)}return s.substr(1)},alertMsgFn:function(e){var t="";switch(e){case 2:t='<h4 class="h4_txt">亲~您已经提交过哦</h4>                            <p class="ps">客服将尽快联系您<br/>请不要拒接0512开头的电话</p>                            <span class="msg_dbg success_sbg"></span>                            <span class="close_but">关闭</span>';break;case 0:t='<h4 class="h4_txt">提交失败！</h4>                            <span class="msg_dbg fail_sbg"></span>                            <span class="close_but">关闭</span>';break;case 1:t='<h4 class="h4_txt">通知预约成功！</h4>                            <p class="ps">客服将尽快联系您<br/>请不要拒接0512开头的电话</p>                            <span class="msg_dbg success_sbg"></span>                            <span class="close_but">关闭</span>'}t.length>=0&&(fish.one(".ylc-modal-rs .s_con").html(t),this.formConBox.close(),this.msgForm.show())},statcClick:function(){var e=fish.one("#hidIsFinalPage").val();fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx?action=SpecialReserClick&isFinal="+e,fn:function(){}})},alertFormCtrl:function(e){var t={showCon:fish.one(""),shadowBg:fish.one(""),clickBgClose:!0,closeBut:fish.one(""),closeAfterFn:function(e,t){},showBeforeFn:function(e,t){}};fish.lang.extend(t,e);var s=t,i={show:function(){s.showBeforeFn(s.showCon,s.shadowBg),s.shadowBg.removeClass("none"),s.showCon.removeClass("none")},close:function(){s.shadowBg.addClass("none"),s.showCon.addClass("none"),s.closeAfterFn(s.showCon,s.shadowBg)}};return s.closeBut.on("click",function(){i.close()}),s.clickBgClose===!0&&s.shadowBg.on("click",function(){i.close()}),i},cirCenter:function(e){if(!e||!e[0])return!1;var t=e.width(),s=e.height();e.css("position:fixed;left:50%;top:50%;marginLeft:"+-t/2+"px;marginTop:"+-s/2+"px;")}});var o=o||{};e.lang.extend(o,{changePic:function(){var t=e.one(".ylc-nav .ylc-item");this.isDuring("2016-06-02","2016-06-17")&&(e.one("img",t).attr("src","http://img1.40017.cn/cn/y/16/h/ylnav616-top.jpg"),e.one(".ylc-more img",t).attr("src","http://img1.40017.cn/cn/y/16/h/cruisesale616.jpg")),this.isDuring("2016-06-20","2017-06-20")&&(e.one("img",t).attr("src","http://img1.40017.cn/cn/y/16/c/ylnav-top-1.jpg"),e.one(".ylc-more img",t).attr("src","http://img1.40017.cn/cn/y/16/c/cruisesale-1.jpg")),e.ajax({url:"/youlun/cruiseactivity/TopicActivityAjax.aspx?Type=GetTodayHotLine&specialId=330&moduleId=911",type:"json",fn:function(s){if(s.stlSortNo>0){var i=e.one("img",t),a=e.one("script",t),n=e.one(".ylc-more",t);i.attr("src",i.attr("src-attr")),n.html(a.html().format(s.image,s.stlRecommend,parseInt(s.price,10))),t.attr("href",s.url||"javascript:;")}}})},isDuring:function(t,s){var i=e.parseDate().getTime(),t=e.parseDate(t).getTime(),s=e.parseDate(s).getTime();return i>=t&&s>=i},setDialogTitle:function(){if(ylcNavObj.specReserDialog.isFinal()){var t=e.create("<div></div>");t.html(e.one(".pro_tit .h2_title").html()),e.all("*",t).html("remove"),t=e.trim(t.html()),t&&t.length||(t=e.trim(e.one(".content .location .h2_local").html())),t&&t.length||(t="邮轮特价预约线路"),e.one(".ylc-modal .ylc-m-title .route-tit").html(t)}}}),fish.ready(function(){ylcNavObj.init(),n.init();var t=e.one("#onlineSellPriceDefault");e.dom(t)&&(t=t.val(),t=parseInt(t,10),t=isNaN(t)?0:0>t?0:t,t>=50&&e.one(".ylc-nav .ylc-plus").css({display:"block"}).addClass("fadeInDown"))})}(fish,window,window.document),function(){function e(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),s=window.location.search.substr(1).match(t);return null!=s?unescape(s[2]):null}var t=e("refid"),s=e("Ip"),i=fish.one("#HidLineid").val();null!=t&&null!=s&&fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=AddMembersRecommendByCn",data:"lineId="+i+"&ouserId="+t+"&ShareIp="+s,type:"json",fn:function(e){}})}(),function(){function e(e){return this.DEFAULT={startTime:t?t:fish.one("#calendar_top li.on").attr("s_date"),endTime:"",time:"",showing_time:"",showing_time_begin:"",showing_time_end:"",prev_disabled:!1,next_disabled:!1,item_height:0,item_width:0},this.cache={datas:{},days:{},items:{}},this.getMonthData=function(e,t,s){return e.data},this.getDayData=function(e,t,s,i){return""},this.checkClickable=function(e,t,s,i){var a=fish.parseTime(t+"-"+s+"-"+i);return fish.parseDate(this.startTime).getTime()<=fish.parseDate(a).getTime()&&(this.endTime?fish.parseDate(a).getTime()<=fish.parseDate(this.endTime).getTime():!0)&&this.clickable(e,t,s,i)},this.clickable=function(e,t,s,i){return!0},e=fish.lang.extend(this.DEFAULT,e),this.init(e)}current=0,fish.extend({calendar:function(t){return this&&this.length?(t=t||{},t.target=this,new e(t)):void 0}});var t=fish.one("#calendar_wrapper").attr("attr_first");e.prototype={init:function(e){fish.lang.extend(this,e),this.render()},target:null,wrapper:null,render:function(){this.wrapper=fish.create('<div class="calendar"><div class="calendar_body"> <a href="#" class="btn prev"></a> <a href="#" class="btn next"></a><div class="calendar_items"> </div> </div> </div>');var e=this.time||this.startTime;if(this.time&&!this.isSameMonth(this.time,this.startTime)){var t=fish.parseDate(e);e=t.getFullYear()+"-"+(t.getMonth()+1)+"-01"}else this.time&&this.isSameMonth(this.time,this.startTime)&&(e=this.startTime);var s=fish.one("#calendar_top li.on").attr("s_date"),i=fish.one("#calendar_top li.on").attr("e_date");fish.all(".calendar_items",this.wrapper).append(this.renderItem(e,s,i)),function(e){fish.all(".prev",e.wrapper).on("click",function(t){fish.preventDefault(t),e.prev()}),fish.all(".next",e.wrapper).on("click",function(t){fish.preventDefault(t),e.next()})}(this),this.target.append(this.wrapper),this.setShowingTime(e),this.setBtnsStatus(),this.setItemHeight()},renderItem:function(e,t,s,i){var a=fish.create('<div class="calendar_item"></div>');return a.append(this.renderMonths(e,t,s,i))},renderMonths:function(e,t,s,i){var a=fish.create('<div class="calendar_months"></div>'),n=fish.parseDate(e);return a.append(this.renderMonth(n.getFullYear()+"-"+(n.getMonth()+1)+"-01",i)),this.updateCache("items",n.getFullYear()+"-"+(n.getMonth()+1)+"-01",!0),this.getData(n.getFullYear(),n.getMonth()+1,t,s),a},renderMonth:function(e,t,s,i){s=s||!1,i=void 0==i?!0:i,date=fish.parseDate(e);for(var a=date.getDay(),n=date.getDate(),o=new Date(date.getFullYear(),date.getMonth()+1,0).getDate(),l=date.getFullYear(),r=date.getMonth()+1,c=r+1>12?l+1:l,h=r+2>12?l+1:l,d=r+3>12?l+1:l,f=r+1>12?r-11:r+1,p=r+2>12?r-10:r+2,u=r+3>12?r-9:r+3,m='<table class="calendar_left"><tbody><tr><td attr="'+l+"-"+r+'-01" class="on">'+l+"年"+r+'月</td><td attr="'+c+"-"+f+'-01">'+c+"年"+f+'月</td><td attr="'+h+"-"+p+'-01">'+h+"年"+p+'月</td><td attr="'+d+"-"+u+'-01">'+d+"年"+u+"月</td></tr></tbody></table>",v="",_=0,g=fish.all(".calendar_left td"),C=0;4>C;C++)fish.one(g[C]).hasClass("on")&&(_=C+1);if(1==t){var y=fish.dom(".calendar_left").outerHTML;m=y}var b=n,w=1,k=1;count_date=fish.parseTime(e,{days:-a});for(var t=0;(i?6:3)>t;t++){var x="";for(C=0;7>C;C++){var T;0==t&&a>C?T="<td></td>":k>a&&o>=b?(T='<td><a href="#" data-date="'+count_date+'"><span class="date">'+(this.renderDate(count_date)||b)+'</span><span class="data"></span></a></td>',b++):s?(T='<td class="out_of_month"><a href="#" data-date="'+count_date+'"><span class="date">'+(this.renderDate(count_date)||w)+'</span><span class="data"></span></a></td>',w++):T='<td class="out_of_month"></td>',count_date=fish.parseTime(count_date,{days:1}),k++,x+=T}x="<tr>"+x+"</tr>",v+=x}v='<table class="calendar_right"><tbody><tr><th>日</th><th>一</th> <th>二</th> <th>三</th> <th>四</th> <th>五</th> <th>六</th></tr>'+v+"</tbody></table>",calendar_month=fish.create('<div class="calendar_month '+(this.isCurrentMonth(e)?"current_month":"")+' ">'+m+v+"</div>");for(var j=fish.all("a",calendar_month),t=0;t<j.length;t++)this.updateCache("day elem",fish.one(j[t]).attr("data-date"),fish.one(j[t]));return calendar_month},isCurrentMonth:function(e){var t=fish.parseDate(e),s=fish.parseDate(this.startTime);return s.getFullYear()==t.getFullYear()&&s.getMonth()==t.getMonth()},timeIsSingleMode:function(e){var t=fish.parseDate(e),s=new Date(t.getFullYear(),t.getMonth()+1,0).getDate()-t.getDate()+1;return Math.ceil((s+t.getDay())/7)>3},updateCache:function(e,t,s){var i=fish.parseDate(t),a=i.getFullYear(),n=i.getMonth()+1,o=i.getDate();if("day elem"==e){var l=a+"-"+n,r=this.cache.days;r[l]=r[l]||{},r[l][o]=r[l][o]||{elems:[],data:{}},r[l][o].elems.push(fish.dom(s))}else if("day data"==e){var l=a+"-"+n,r=this.cache.days;r[l]=r[l]||{},r[l][o]=r[l][o]||{elems:[],data:{}},r[l][o].data.push(s)}else if("datas"==e){var l=a+"-"+n,c=this.cache.datas;c[l]=s}else"items"==e&&(this.cache.items[t]=s)},getCache:function(e,t){var s=fish.parseDate(t),i=s.getFullYear(),a=s.getMonth()+1,n=s.getDate(),o=null;return"datas"==e?o=this.cache.datas[t]:"days"==e?this.cache.days[i+"-"+a]&&this.cache.days[i+"-"+a][n]&&(o=this.cache.days[i+"-"+a][n]):"day elems"==e?this.cache.days[i+"-"+a]&&this.cache.days[i+"-"+a][n]&&(o=this.cache.days[i+"-"+a][n],o=fish.all(o.elems)):"day data"==e?this.cache.days[i+"-"+a]&&this.cache.days[i+"-"+a][n]&&(o=this.cache.days[i+"-"+a][n],o=o.data):"items"==e&&(o=this.cache.items[t]),o},isEmpty:function(){},renderDate:function(e){var t="";return fish.parseTime()==fish.parseTime(e)&&(t="今天"),t||this.timeToFestival(e)},timeToFestival:function(e){for(var t=[{date:"2015-01-01",name:"元旦"},{date:"2015-02-19",name:"春节"},{date:"2015-04-04",name:"清明节"},{date:"2015-05-01",name:"劳动节"},{date:"2015-06-20",name:"端午节"},{date:"2015-09-27",name:"中秋节"},{date:"2015-10-01",name:"国庆节"}],s=0;s<t.length;s++)if(t[s].date==e)return t[s].name},getData:function(e,t,s,i){var a=this.url.replace("{startdate}",s).replace("{enddate}",i).replace("{year}",e).replace("{month}",t),n=this.getCache("datas",e+"-"+t+"-01");if(n){if("loading"==n)return;return void this.processMonthData(this.getMonthData(n,e,t),e,t)}!function(e,t,s){e.updateCache("datas",t+"-"+s+"-01","loading"),fish.ajax({url:a,type:"json",fn:function(i){e.updateCache("datas",t+"-"+s+"-01",i),e.processMonthData(e.getMonthData(i,t,s),t,s);var a=fish.one("#calendar_wrapper").attr("attrpromotion-url"),n=fish.one("#calendar_top li.on").attr("s_date"),o=fish.one("#calendar_top li.on").attr("e_date");fish.ajax({url:a,data:"startdate="+n+"&enddate="+o,type:"json",fn:function(e){if(e.PromotiondateList.length>0)for(var t=0,s=e.PromotiondateList.length;s>t;t++)for(var i=e.PromotiondateList[t].Promotiondate,a=0,n=fish.all(".calendar_right a").length;n>a;a++)if(i==fish.one(fish.all(".calendar_right a")[a]).attr("data-date")){var o=fish.one(fish.all(".calendar_right a")[a]);fish.one(".mcalpricebox",o).html("top","<span class='sale'>惠</span>")}}});for(var l=fish.all("#calendar_top li").length,r=0;l>r;r++)fish.all("#calendar_top li")[r].onclick=function(t){fish.preventDefault(t);var s=fish.getTarget(t);e.changeMonth(s),fish.all("#calendar_top li").removeClass("on"),fish.one(this).addClass("on")};var c=Math.ceil(fish.all("#calendar_top li").length/4);fish.one("#calendar_top .next")[0].onclick=function(t){if(!fish.one(this).hasClass("disabled")){if(current<c-1){current++,fish.one("#calendar_top ul").anim("left:"+-483*current+"px;"),fish.one("#calendar_top .prev").removeClass("disabled"),fish.all("#calendar_top li").removeClass("on"),fish.preventDefault(t);var s=fish.all("#calendar_top li")[4*current];e.changeMonth(s),fish.one(fish.all("#calendar_top li")[4*current]).addClass("on")}current>=c-1&&fish.one(this).addClass("disabled")}},fish.one("#calendar_top .prev")[0].onclick=function(t){if(!fish.one(this).hasClass("disabled")){if(current>=0){current--,fish.one("#calendar_top ul").anim("left:"+-483*current+"px;"),fish.one("#calendar_top .next").removeClass("disabled"),fish.all("#calendar_top li").removeClass("on"),fish.preventDefault(t);var s=fish.all("#calendar_top li")[4*current];e.changeMonth(s),fish.one(fish.all("#calendar_top li")[4*current]).addClass("on")}0==current&&fish.one(this).addClass("disabled")}}}})}(this,e,t)},processMonthData:function(e,t,s){for(var i=(new Date(t,s,0).getDate(),0);i<e.length;i++){var a=i+1;if(day_datas=this.cache.days[t+"-"+s][a],day_elems=null,day_data=null,day_datas){day_elems=fish.all(day_datas.elems),day_data=day_datas.data=e[i];for(var n=0;n<day_elems.length;n++){var o=fish.one(day_elems[n]);this.processDayClass(o,day_data,t,s,a),fish.one(".data",o).html(this.getDayData(day_data,t,s,a)),function(e,t){fish.one(t).on("click",function(t){fish.preventDefault(t);var s=fish.one(this).attr("data-date"),i=fish.parseDate(s),a=i.getFullYear(),n=i.getMonth()+1,o=i.getDate(),l=e.cache.days[a+"-"+n][o].data;e.beforeClick(l,a,n,o)&&e.click(l,a,n,o)}),fish.one(t).hover(function(){fish.one(this).addClass("hover")},function(){fish.one(this).removeClass("hover")})}(this,o)}}}},processDayClass:function(e,t,s,i,a){this.checkClickable(t,s,i,a)?e.addClass("enabled").removeClass("disabled"):e.addClass("disabled").removeClass("enabled");var n=fish.parseTime(s+"-"+i+"-"+a),o=fish.parseDate(n);fish.parseTime()==n&&e.addClass("today"),this.time==n&&e.addClass("active"),0!=o.getDay()&&6!=o.getDay()||e.addClass("festival"),"undefined"!=typeof this.timeToFestival(n)&&e.addClass("chinfestival")},beforeClick:function(e,t,s,i){var a=fish.parseTime(t+"-"+s+"-"+i);return this.checkClickable(e,t,s,i)?(this.time&&this.getCache("day elems",this.time).removeClass("active"),this.time=a,this.getCache("day elems",this.time).addClass("active"),!0):!1},setShowingTime:function(e){this.showing_time=e?fish.parseTime(e):this.startTime},setItemHeight:function(){this.item_width=this.item_width||fish.one(".calendar_item",this.wrapper).width()||parseInt(fish.one(".calendar_item",this.wrapper).getCss("width"))},next:function(){if(!this.next_disabled){var e=this.showing_time,t=e.split("-"),s=t[0]+"-"+(parseInt(t[1])+1)+"-01",i=fish.one(".calendar_items",this.wrapper),a=fish.one("#calendar_top li.on").attr("s_date"),n=fish.one("#calendar_top li.on").attr("e_date");i.html("").append(this.renderItem(s,a,n,0)),this.showing_time=s,this.setBtnsStatus()}},goThatMonth:function(e){var t=fish.one(e).attr("attr"),s=t.split("-"),i=s[0]+"-"+parseInt(s[1])+"-01",a=fish.all(".calendar_items",this.wrapper),n=fish.one("#calendar_top li.on").attr("s_date"),o=fish.one("#calendar_top li.on").attr("e_date");fish.one(e).hasClass("on")||(a.append(this.renderItem(i,n,o,1)),fish.one(".calendar_item").html("remove"),this.showing_time=i,this.setBtnsStatus())},prev:function(){if(!this.prev_disabled){var e=this.showing_time,t=fish.parseDate(e,{months:-1}),s="",i=fish.all(".calendar_items",this.wrapper),a=fish.one("#calendar_top li.on").attr("s_date"),n=fish.one("#calendar_top li.on").attr("e_date");s=t.getFullYear()!=fish.parseDate(this.startTime).getFullYear()||t.getMonth()!=fish.parseDate(this.startTime).getMonth()||this.timeIsSingleMode(this.startTime)?t.getFullYear()+"-"+(t.getMonth()+1)+"-01":this.startTime,i.html("").append(this.renderItem(s,a,n,2)),this.showing_time=s,this.setBtnsStatus()}},changeMonth:function(e){var t=fish.one(e).attr("s_date"),s=fish.all(".calendar_items",this.wrapper),i=fish.one(e).attr("s_date"),a=fish.one(e).attr("e_date");fish.one(e).hasClass("on")||(s.append(this.renderItem(t,i,a,0)),fish.one(".calendar_item").html("remove"),this.showing_time=t,this.setBtnsStatus())},setBtnsStatus:function(){fish.all(".calendar_right").children("tr").each(function(e){fish.one(e).children("td").each(function(t){0!=fish.one(e).children("td").indexOf(this)&&6!=fish.one(e).children("td").indexOf(this)||fish.one(t).children("a").css("background:#f1f9ff")})});var e=!0,t=!0,s=fish.all(".prev",this.wrapper),i=fish.all(".next",this.wrapper),a=fish.parseDate(this.showing_time),n=fish.parseDate(this.startTime);a.getTime()<=n.getTime()&&(e=!1),a.getTime()>n.getTime()&&a.getFullYear()==n.getFullYear()&&a.getMonth()==n.getMonth()&&this.timeIsSingleMode(this.startTime)&&(e=!1),this.endTime&&this.isSameMonth(fish.parseDate(this.showing_time,{month:1}),fish.parseDate(this.endTime))&&this.timeIsSingleMode(this.showing_time)&&(t=!1),e?s.removeClass("disabled"):s.addClass("disabled"),t?i.removeClass("disabled"):i.addClass("disabled"),this.prev_disabled=!e,this.next_disabled=!t},isSameMonth:function(e,t){return dateA=fish.parseDate(e),dateB=fish.parseDate(t),dateA.getFullYear()==dateB.getFullYear()&&dateA.getMonth()==dateB.getMonth()},appendItem:function(e){fish.all(".calendar_items",this.wrapper).append(this.renderItem(e))},insertItem:function(e){fish.all(".calendar_items",this.wrapper).append(this.renderItem(e));
}}}(),hot520(),function(){function e(e,s){fish.ajax({url:n.oneCal.attr("attr-url"),data:"lineid="+n.lineId+"&startdate="+e+"&enddate="+s,type:"json",sync:!0,fn:function(e){e&&e.PriceList&&(n.page_cf=e.PriceList,e.PriceList.length>1&&(n.oneCal.addClass("act_date"),fish.one(".date_bg .data_input").val("查看更多航期").removeClass("no_act_date"),t()))}})}function t(){fish.require("Calendar",function(){var e=new fish.Calendar({monthNum:1,zIndex:1e3}),t=fish.parseDate(n.page_cf[0].date),i=fish.parseDate(n.page_cf[n.page_cf.length-1].date),a=t.getFullYear(),o=t.getMonth()+1,l=t.getDate(),r=i.getFullYear(),c=i.getMonth()+1,h=i.getDate();n.oneCal.on("focus",function(t){e.pick({elem:this,startDate:a+"-"+o+"-"+l,endDate:r+"-"+c+"-"+h,mode:"rangeFrom",fn:function(e,t,i,a){var n=fish.one(a);s({price:n.attr("_price"),retail:n.attr("_retail"),date:n.attr("_date"),addDays:parseInt(fish.one("#hidDays").val()),setWeek:["周日","周一","周二","周三","周四","周五","周六"]}),fish.all("#HidDate,#HidCalendarDate").val(fish.one("#oneCal").val()),fish.one("#hidRate").val(n.attr("_price")||0),fish.one("#hidTjBeginDate").val(fish.one("#oneCal").val());var o=new Date(fish.one("#oneCal").val().replace(/-/g,"/")).getTime()-864e5;o=new Date(o),o=o.getFullYear()+"-"+(o.getMonth()+1>9?o.getMonth()+1:"0"+(o.getMonth()+1))+"-"+(o.getDate()>9?o.getDate():"0"+o.getDate()),fish.one("#txtLeaveDate").val(o),itinerary(),getPrice()},buildContent:function(e,t,s){var i=n.page_cf;n.build(e,t,s,i)}})})})}function s(e){var e={price:e.price,retail:e.retail,disCont:(Math.round(e.price/e.retail*100)/10).toFixed(1),date:e.date,addDays:e.addDays,setWeek:e.setWeek,mHref:function(e){var t=this,s=e.split(/\.html\?/g)[1]||"",i=t.date.replace(/-([0-9]{2})/g,function(e,t){return"-"+parseInt(t,10)});return"/youlun/linebook/"+n.lineId+"_"+i+".html?"+s},setActDate:function(){var e=this,t=new Date(e.date.replace(/\-/gi,"/")),s=t.getTime(),i=new Date(s),a=i.getFullYear(),n=i.getMonth()+1,o=i.getDate();return a+"年"+n+"月"+o+"日 "+e.setWeek[i.getDay()]},setBackDate:function(){var e=this,t=new Date(e.date.replace(/\-/gi,"/")),s=t.getTime()+24*e.addDays*3600*1e3,i=new Date(s),a=i.getFullYear(),n=i.getMonth()+1,o=i.getDate();return a+"年"+n+"月"+o+"日 "+e.setWeek[i.getDay()]}};if(jsonBlankStage.length>0){for(var t=0,s=!1,i=0;i<jsonBlankStage.length;i++){var a=jsonBlankStage[i].date;if(a==e.date){t=i,s=!0;break}}s?(fish.one(".bait_infro").removeClass("none"),fish.one(".price_dom").removeClass("no_b_tip"),n.bait_f.html("可分"+jsonBlankStage[t].f+"期支付，出游更超值！"),n.bait_fi.html("免息"+jsonBlankStage[t].d+"期")):(fish.one(".bait_infro").addClass("none"),fish.one(".price_dom").addClass("no_b_tip"))}n.selPrice.html(e.price);var o=fish.one(".ylc-modal .eve_yusuan input");o&&o[0]&&parseInt(o.val(),10)<=0&&(o.val(e.price),o.attr("_placeholder",e.price)),n.prPrice.html(e.retail),e.disCont<=0||e.disCont>=10?n.disC.addClass("none").html(""):n.disC.removeClass("none").html(e.disCont+"折"),n.d_actt.html(e.setActDate()),n.d_back.html(e.setBackDate()),n.link_order.attr("href",e.mHref(n.link_order.attr("href"))),n.fix_order_link.attr("href",e.mHref(n.fix_order_link.attr("href")));var a=new Date(e.date.replace(/\-/gi,"/")).getTime();fish.all("#ins_shower .dayth em").each(function(e,t){fish.one(this).html("("+(new Date(a+1e3*t*60*60*24).getMonth()+1)+"月"+new Date(a+1e3*t*60*60*24).getDate()+"日)")})}function i(e){return n.memberId?void fish.ajax({url:"/youlun/MemberFavoritesHandler.ashx?type=searchnew&productId="+n.lineId,openType:"get",type:"json",fn:function(t){return t?(t.ResultFlag===!0&&n.collectLi.addClass("collected"),void(e&&e(t.ResultFlag))):!1}}):!1}function a(){n.collectLi.hasClass("collected")?fish.ajax({url:"/youlun/MemberFavoritesHandler.ashx?type=Delete&favoriteId="+n.lineId,openType:"get",type:"json",fn:function(e){return e?void(e.ResultFlag===!0&&n.collectLi.removeClass("collected")):!1}}):fish.ajax({url:"/youlun/MemberFavoritesHandler.ashx?type=Addnew&productId="+n.lineId,openType:"get",type:"json",fn:function(e){return e?void(e.ResultFlag===!0&&n.collectLi.addClass("collected")):!1}})}fish.admin.config({Calendar:{v:"0.3",css:1,g:20140333106},mLogin:{v:"2.0",css:1,g:2012112073101}});var n={};n.memberId=fish.cookie.get("cnUser","userid")||fish.cookie.get("us","userid")||0,n.oneCal=fish.one("#oneCal"),n.lineId=fish.one("#HidLineid").val(),n.collectLi=fish.one(".trip_msg li.collect_li"),n.isSaleEnd=fish.one("#hidIsValid").val(),n.isSaleEnd&&1==parseInt(n.isSaleEnd,10)&&fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=GetCruiseDate&lineid="+n.lineId,type:"json",sync:!0,fn:function(t){if(t&&t.MouthList&&!(t.MouthList.length<=0)){var s=t.MouthList.length;e(t.MouthList[0].startdate,t.MouthList[s-1].enddate)}}}),n.selPrice=fish.one(".pri_d span strong b"),n.prPrice=fish.one(".mark_p i"),n.disC=fish.one(".pri_dis"),n.d_back=fish.one(".date_box .back_date span"),n.d_actt=fish.one(".date_box .now_date span"),n.link_order=fish.one(".ele_topDom .link_order"),n.fix_order_link=fish.one(".fix_order .fix_order_link"),n.bait_f=fish.one(".bait_infro > span"),n.bait_fi=fish.one(".bait_infro .span2"),n.tmpl='<span class="date">{dateStr}</span><a class="dayjh" href="javascript:void(0);"></a><span class="dataprice">{priceStr}</span>',n.build=function(e,t,s,i){for(var a,n,o,l=t.getTime(),r=[],c=0,h=i.length-1;h>=c;c++){a=i[c];var d=Date.parse(a.date.replace(/\-/gi,"/"));if(d>=l&&l+864e5>d){n=a;break}}if(n||(n={}),n.dateStr=s?s:t.getDate(),n.date){n.priceStr=n.price+"元";for(key in n)e.setAttribute("_"+key,n[key])}else r.push("invalid-day");o=this.tmpl.replace(/{(\w+)}/g,function(e,t){return n[t]||""}),e.innerHTML=o,fish.one(e).addClass(r.join(" "))},i(),n.collectLi.on("click",function(){n.memberId?a():fish.mLogin({unReload:!0,maskClose:!0,loginSuccess:function(){n.memberId=fish.cookie.get("cnUser","userid")||fish.cookie.get("us","userid")||0,i(function(e){1!=e&&fish.ajax({url:"/youlun/MemberFavoritesHandler.ashx?type=Addnew&productId="+n.lineId,openType:"get",type:"json",fn:function(e){return e?void(e.ResultFlag===!0&&n.collectLi.addClass("collected")):!1}})})}})})}(),function(){fish.extend({append:function(e){return this&&this.length&&e&&e.length?(this[0].appendChild(e[0]),this):this}}),fish.extend({insert:function(e){function t(e){for(var t=[],s=0;s<e.childNodes.length;s++)1==e.childNodes[s].nodeType&&t.push(e.childNodes[s]);return fish.all(t)}if(!(this&&this.length&&e&&e.length))return this;var s=fish.dom(t(fish.dom(this)));s.parentNode&&s.parentNode.insertBefore(e[0],s)}})}(),String.prototype.addParams=function(e){var t=this,s="";if("object"==typeof e)for(var i in e)e[i]&&(s+="&"+i+"="+e[i]);return s&&(t+=t.indexOf("?")>-1?s:"?"+s.substring(1,s.length)),t+""},function(){function e(){fish.all(".c_btu span")[1]&&fish.all(".c_btu span")[1].click(),fish.all(".c_btu span")[2]&&fish.all(".c_btu span")[2].click()}function t(){var e=fish.all("#storeInfo .list_store li"),t=fish.all(".adress .adress_list"),s=fish.one("#HidId").val(),i=!1;e.each(function(){var t=fish.one(this);s==t.attr("province-id")&&(e.removeClass("active"),t.addClass("active"),i=!0)}).on("click",function(){var s=fish.one(this),i=s.attr("province-id");e.removeClass("active"),s.addClass("active"),t.each(function(){var e=fish.one(this);i==e.attr("province-id")&&(t.addClass("none"),e.removeClass("none"))})}),i||e.each(function(){var s=fish.one(this);25==s.attr("province-id")&&(e.removeClass("active"),s.addClass("active")),t.each(function(){var e=fish.one(this);25==e.attr("province-id")&&(t.addClass("none"),e.removeClass("none"))})})}function s(){window.onscroll=function(){var e=document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop,t=fish.one(".intr_tit"),s=t.offset().top;e>s?(fish.one(".f_tit").css({position:"fixed",top:0,"z-index":11}),fish.one(".fix_order").removeClass("none")):(fish.one(".f_tit").css({position:""}),fish.one(".fix_order").addClass("none")),fish.one(window).scrollTop()>50?fish.one(".top_link").removeClass("none"):fish.one(".top_link").addClass("none"),F.windowHeight=window.screen.availHeight,e>=fish.one("#itinerary").offset().top+20-F.windowHeight&&F.itinerary&&(F.itinerary=!1),e>=fish.one("#visitorsCommElem").offset().top+20-F.windowHeight&&F.commonFlag&&(F.commonFlag=!1,z="/youlun/dsfgw/dsf/gw/exec?basename=FvBZ8ovxctQvyzrdTcPWJzw5xC6m5KaEJibOLXiAGdmzbMe0VqcjZ7XDwHMkJeiS&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&pageSize=5&tagId=1&dpCruiseId="+F.cruiseId+"&SortType=0",_(z)),e>=fish.one(".tra_main").offset().top+110-F.windowHeight&&F.travels&&(F.travels=!1,S()),fish.all(".detail_con").each(function(t,s){var i=fish.one(t).offset().top,a=fish.one(".intr_tit").height(),n=isNaN(parseInt(fish.all(".detail_con").getCss("margin-top")))?parseInt(fish.one(".detail_con").getCss("marginTop")):parseInt(fish.all(".detail_con").getCss("margin-top"));e>i-a-n&&(fish.all(".f_tit li").removeClass("at"),fish.one(fish.all(".f_tit li")[s]).addClass("at"))});var a=fish.one(".dayList"),n=a.offset().top,o=fish.one("#dayList").height(),l=fish.one(".dayCon").height(),r=fish.all(".dayList_nav li").length,c=parseInt(r/8,10),h=r%8,d=35*(8*(c-1)+h);fish.one(".dayList").css("height:"+l+"px;"),e>=n-60&&n+l-o-60>e?fish.one("#dayList").css({position:"fixed",top:"60px",bottom:"","z-index":10}):e>n+l-o-60?fish.one("#dayList").css({position:"absolute",top:"",bottom:0,"z-index":10}):fish.one("#dayList").css({position:"",top:0,bottom:"","z-index":10}),fish.all(".travel_day").each(function(t,s){var i=fish.one(t).offset().top;if(e>=i-60){fish.all(".dayList_nav ul li").removeClass("on"),fish.one(fish.all(".dayList_nav ul li")[s]).addClass("on");var a=35*s;0==a?(fish.one(".up").removeClass("act"),fish.one(".down").addClass("act")):a>0&&d>a?fish.all(".up,.down").addClass("act"):(a=d,fish.one(".up").addClass("act"),fish.one(".down").removeClass("act")),fish.all(".dayListArrow").hasClass("none")||fish.one(".dayList_nav ul").anim("top:-"+a+"px;",500)}}),n>e&&(fish.all(".dayList_nav ul li").removeClass("on"),fish.one(fish.all(".dayList_nav ul li")[0]).addClass("on")),i()},fish.all(".f_tit li").each(function(e,t){fish.one(e).on("click",function(){5==t&&0==fish.one(fish.all(".detail_con")[t]).offset().top&&(t=4);var e=fish.one(fish.all(".detail_con")[t]).offset().top,s=fish.one(".intr_tit").height(),i=isNaN(parseInt(fish.all(".detail_con").getCss("margin-top")))?parseInt(fish.one(".detail_con").getCss("marginTop")):parseInt(fish.all(".detail_con").getCss("margin-top"));window.scrollTo(0,e-s-i+1)})}),fish.one("#linkTravel").on("click",function(){var e=fish.one("#itinerary").offset().top,t=fish.one(".intr_tit").height(),s=isNaN(parseInt(fish.all(".detail_con").getCss("margin-top")))?parseInt(fish.one(".detail_con").getCss("marginTop")):parseInt(fish.all(".detail_con").getCss("margin-top"));window.scrollTo(0,e-t-s+1)})}function i(){var e=fish.one(window),t=fish.one(".description"),s=fish.one(".description_tab",t),a=fish.one(".f_tit");(i=function(){var i=e.scrollTop(),n=t.offset().top,o=a.height(),l=n+t.height()-s.height();i>=n-o?i>=l-o?s.css("top:"+(l-n>0?l-n:0)+"px;"):s.css("top:"+(i-n+o+10)+"px;"):s.css("top:0px;")})()}function a(){var e=!1;(fish.one("#uname").hasClass("err_input")||fish.one("#uemail").hasClass("err_input"))&&(e=!0);var t=fish.trim(fish.one("#uname").val()),s=fish.trim(fish.one("#uemail").val()),i=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;""==t&&(fish.one("#uname").addClass("err_input").html("after","<span><em></em>请输入姓名</span>"),e=!0),""==t||n(t)||(fish.one("#uname").addClass("err_input").html("after","<span><em></em>姓名格式错误</span>"),e=!0),""==s&&(fish.one("#uemail").addClass("err_input").html("after","<span><em></em>请输入Email</span>"),e=!0),""==s||i.test(s)||(fish.one("#uemail").addClass("err_input").html("after","<span><em></em>邮箱格式错误</span>"),e=!0),e?fish.one(".saveBt").addClass("busy"):fish.one(".saveBt").removeClass("busy")}function n(e){return/^[a-zA-Z\s]+$/.test(e)?!0:!!(/^[\u4e00-\u9fa5]+$/.test(e)&&e.length>1)}function o(){function e(e){fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=CruiseSpecialStatistic",openType:"post",data:stringFromJson(e),fn:function(){}})}var t=GetQueryString("Key"),s=GetQueryString("SearchCondition"),i=GetQueryString("lid"),a={PageType:"DetailPage",Userid:"undefined"==typeof getMemberId?0:getMemberId(),Url:encodeURIComponent(location.href),v:(new Date).getTime()};if(t)a.Key=F.rateOption.Key=t,s&&(a.SearchCondition=F.rateOption.SearchCondition=s),e(a),I();else{var n={};n.LineIds=fish.one("#HidLineid").val(),i&&(n.Lid=GetQueryString("lid")),fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=GenerateSpecialStatisticKey",openType:"post",data:stringFromJson(n),type:"json",fn:function(t){t&&t.length&&t[0].Key?(F.rateOption.Key=a.Key=t[0].Key,s&&(F.rateOption.SearchCondition=a.SearchCondition=s),e(a),I()):(n.LineIds&&(a.LineId=n.LineIds),n.Lid&&(a.Lid=n.Lid),e(a))},err:function(){n.LineIds&&(a.LineId=n.LineIds),n.Lid&&(a.Lid=n.Lid),e(a)}})}}function l(e,t,s){var i=fish.one(e).offset();return{top:i.top+(t?t:0),left:i.left+(s?s:0)}}function r(e,t,s){var i=l(e),a=l(t),n=fish.one(e);if(i.left+n.width()+10>s){var o=fish.one(".comm_s",n),r=fish.one(t);o.removeClass("comm_s").addClass("comm_sr"),n.css("top:"+(a.top+r.height()+8)+"px;left:"+(a.left-367+r.width())+"px;")}}function c(e,t){fish.ajax({url:e,data:"type="+t,type:"json",fn:function(e){e&&(e.ResultFlag===!0||"加入收藏夹"===e.ResultMsg?fish.one("#collectLine").attr("title","可在“我的同程”查看和取消当前收藏").addClass("iscollect").html("已收藏"):fish.one("#collectLine").attr("title","收藏该航线").removeClass("iscollect").html("收藏"))}})}function h(){var e="http://www.ly.com/AjaxHelper/TopLoginHandler.aspx?channel=YouLun&action=getTelephone",t=getRefid();fish.ajax({url:e,data:"&asyncRefid="+t,type:"jsonp",fn:function(e){var t=e.telephone;fish.all(".hot_line span,.zx_rx span").html(t)},err:function(){fish.all(".hot_line span,.zx_rx span").html("4007-740-075")}})}function d(e,t,s,i,a){function n(e){return document.getElementById(e)}function o(e,t){return e.currentStyle?e.currentStyle[t]:getComputedStyle(e,!1)[t]}function l(e,t){e.timer&&clearInterval(e.timer),e.timer=setInterval(function(){for(var s in t){var i=parseInt(o(e,s));i=i?i:0;var a=(t[s]-i)/3;a=a>0?Math.ceil(a):Math.floor(a),e.style[s]=i+a+"px",i==t[s]&&clearInterval(e.timer)}},30)}function r(){l(C,{left:-k*b}),g>3&&(T>k?l(y,{left:0}):g>k+T?l(y,{left:-(k-T)*w}):l(y,{left:-(g-x)*w}));for(var e=0;g>e;e++)v[e].className="",e==k&&(v[e].className="current")}function c(){newtime=setInterval(function(){v[k].index=k,v[k].onclick=function(){k=this.index,r()},v[k].click(),k++,k==g&&(k=0)},3e3)}function h(e){fish.one(e).on("mouseover",function(){clearInterval(newtime)}),fish.one(e).hover(function(){clearInterval(newtime)},function(){c()})}var d=n(e),f=n(t),p=n(s),u=n(i),m=d.getElementsByTagName("li"),v=f.getElementsByTagName("li"),_=m.length,g=v.length,C=d.getElementsByTagName("ul")[0],y=f.getElementsByTagName("ul")[0],b=m[0].offsetWidth,w=v[0].offsetWidth;w+=a,C.style.width=b*_+"px",y.style.width=w*g+"px";var k=0,x=4,T=Math.ceil(x/3);u.onclick=u.onclick=function(){k++,k=k==g?0:k,r()},p.onclick=p.onclick=function(){k--,k=-1==k?g-1:k,r()};for(var j=0;g>j;j++)v[j].index=j,v[j].onclick=function(){k=this.index,r()};v[0].click(),c(),h(d),h(f),h(p),h(u)}function f(){var e=fish.one(".yhsm"),t=fish.one(".note_right",e),s=fish.one(".note div",e),i=fish.one(".note_more",e);s.height()>52?i.removeClass("none"):i.addClass("none"),t.hover(function(){e.addClass("note_active")},function(){e.removeClass("note_active")})}function m(e,t,s,i,a){function n(){window.open([l,p].join(""),"mb",["toolbar=0,status=0,resizable=1,width=620,height=450,left=",(screen.width-620)/2,",top=",(screen.height-450)/2].join(""))||(u.href=[l,p].join(""))}var o=encodeURIComponent,l=e;u=t,p=["url=",o(u),"&title=",o(s),"&summary=",i,"&pic=",o(a)].join(""),/Firefox/.test(navigator.userAgent)?setTimeout(n,0):n()}function v(e,t,s){for(var i=fish.all("script"),a=0,n=i.length;n>a;a++)if(i[a].src.indexOf(e)>=0)return"function"==typeof t&&t(),i[a];var o=Math.floor(1e12*Math.random()),l=document.createElement("script");return l.type="text/javascript",l.async=!0,"function"==typeof t?l.onload=l.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(l.onload=l.onreadystatechange=null,t())}:s=t,l.src=e+(s?"?v="+o++:""),document.getElementsByTagName("script")[0].parentNode.appendChild(l),l}function _(e,t){var i,a=e.split("&"),n={pageSize:a[3].split("=")[1],dpCruiseId:a[5].split("=")[1],SortType:a[6].split("=")[1],tagId:a[4].split("=")[1]};e=a[0]+"&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&param="+JSON.stringify(n),i=e.substring(0,e.length-1),fish.all("#ctrlPager").mPage({startWithAjax:!0,callback:function(e){if(e&&e.CountInfo){var i=e.CountInfo,a=e.CommentInfos;if((!a||a.length<1)&&fish.one(".satisfaction_wrap").html().length<1)return fish.one("#visitorsCommElem").html("remove"),fish.all(".f_tit li").each(function(e){var t=fish.one(e).attr("attr-id");5==t&&fish.one(e).html("remove")}),void s();var n='<div class="rates">                                <strong>{{=it[0].Satisfaction}}%</strong><span>满意度</span>                             </div>                             <div class="rates_list">                                <div class="line_dp clearfix">                                    <span class="r_position">好评率</span>                                    <div class="rates_box r_position">                                        <span class="pray_bg"><span class="yellow_bg" style="width: {{=it[0].GoodFaction}}%;"></span></span></span>                                </div>                                <span class="r_num r_position">{{=it[0].GoodFaction}}%</span>                                </div>                                <div class="line_dp clearfix">                                    <span class="r_position">中评率</span>                                    <div class="rates_box r_position">                                        <span class="pray_bg"><span class="yellow_bg" style="width: {{=it[0].ModeFaction}}%;"></span></span>                                    </div>                                    <span class="r_num r_position">{{=it[0].ModeFaction}}%</span>                                </div>                                <div class="line_dp bad_line_dp clearfix">                                    <span class="r_position">差评率</span>                                    <div class="rates_box r_position">                                        <span class="pray_bg"><span class="yellow_bg" style="width: {{=it[0].BadFation}}%;"></span></span>                                    </div>                                    <span class="r_num r_position">{{=it[0].BadFation}}%</span>                                </div>                             </div>                            <div class="scores">                                <strong class="s_num"><span class="s_text1">{{=it[0].ServiceScore > 0 ? it[0].CompositeScore : Math.round(((it[0].DinnerScore+it[0].PlayScore+it[0].TravelScore+5)/4)*100)/100}}</span>分</strong><span class="s_text2">综合得分</span>                            </div>                            <div class="scores_litem">                                <div class="s_list4">餐饮住宿<span>{{=it[0].DinnerScore}}</span></div>                                <div class="s_list4">娱乐活动<span>{{=it[0].PlayScore}}</span></div>                                <div class="s_list4">岸上观光<span>{{=it[0].TravelScore}}</span></div>                                <div class="s_list4">同程服务<span>{{=it[0].ServiceScore <= 0 ? 5.0 : it[0].ServiceScore}}</span></div>                            </div>                            <div class="rules">                                <p>您可对已购订单立刻发表点评</p>                                <a class="dp_link" href="http://member.ly.com/orderlist.aspx">立即点评</a>                                <span class="pre_t present_tip"><span></span>点评奖金规则</span>                            </div>',o='<label for="reviewInt1" class="lab_sty"><input type="radio" id="reviewInt1" name="reviewType" checked="checked" class="reviewInput" attr-total="{{=it[0].all}}" sttr-url="/youlun/dsfgw/dsf/gw/exec?basename=FvBZ8ovxctQvyzrdTcPWJzw5xC6m5KaEJibOLXiAGdmzbMe0VqcjZ7XDwHMkJeiS&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&pageSize=5&tagId=1">所有点评({{=it[0].All}})</label>                               <label for="reviewInt2" class="lab_sty"><input type="radio" id="reviewInt2" name="reviewType" class="reviewInput" sttr-url="/youlun/dsfgw/dsf/gw/exec?basename=FvBZ8ovxctQvyzrdTcPWJzw5xC6m5KaEJibOLXiAGdmzbMe0VqcjZ7XDwHMkJeiS&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&pageSize=5&tagId=2">好评({{=it[0].Good}})</label>                               <label for="reviewInt3" class="lab_sty"><input type="radio" id="reviewInt3" name="reviewType" class="reviewInput" sttr-url="/youlun/dsfgw/dsf/gw/exec?basename=FvBZ8ovxctQvyzrdTcPWJzw5xC6m5KaEJibOLXiAGdmzbMe0VqcjZ7XDwHMkJeiS&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&pageSize=5&tagId=3">中评({{=it[0].Moderate}})</label>                               <label for="reviewInt4" class="lab_sty"><input type="radio" id="reviewInt4" name="reviewType" class="reviewInput" sttr-url="/youlun/dsfgw/dsf/gw/exec?basename=FvBZ8ovxctQvyzrdTcPWJzw5xC6m5KaEJibOLXiAGdmzbMe0VqcjZ7XDwHMkJeiS&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&pageSize=5&tagId=4">差评({{=it[0].Negative}})</label>                               <label for="reviewInt5" class="lab_sty"><input type="radio" id="reviewInt5" name="reviewType" class="reviewInput" sttr-url="/youlun/dsfgw/dsf/gw/exec?basename=FvBZ8ovxctQvyzrdTcPWJzw5xC6m5KaEJibOLXiAGdmzbMe0VqcjZ7XDwHMkJeiS&method=GetCommentList&version=Y2FiHRQP4cpDM_k0nC3icg==&pageSize=5&tagId=5">有图({{=it[0].Photo}})</label>                               <div class="review_select">                                    <span class="paixu at" attr-type="0">默认排序</span><span class="paixu" attr-type="1">最有价值 ↑</span><span class="paixu" attr-type="3">时间排序 ↑</span>                                </div>',l='{{for(var n = 0,m = it.length;n < m; n++){ }}                              <div class="review_lists clearfix">                                  {{? it[n].IsElite == "1"}}<span class="essence_reviews"></span>{{?}}                                  <div class="author">                                      {{? it[n].UserAvatar == ""}}<span class="rev_tip user_0{{=it[n].Level + 1}}"></span>{{??}}<span class="rev_tip user_0{{=it[n].Level + 1}}"></span>{{?}}                                      <p class="">{{=it[n].NickName}}</p>                                      <img src="http://js.40017.cn/cn/public/module/memberLevel/0.4/lev{{=it[n].Level + 1}}.gif" class="rev_lev">                                  </div>                                  <div class="right_main">                                    <!-- 游客点评内容  -->                                    <div class="c_details">                                        <p><span>{{=it[n].Comment}}</span><a class="checkmore" style="display: none;"><span>展开全部</span></a></p>                                    </div>                                    <!-- 图片展示 -->                                    {{? it[n].PhotoSizeList == ""}}{{??}}                                    <div class="pic_show clearfix"  attr-img="{{=it[n].PhotoSizeList}}" attr-maxImg="{{=it[n].PhotoList}}">                                        <div class="pic_box">                                            {{for(var i = 0,j = it[n].PhotoSizeList.length;i < j; i++){}}                                              <img class="pic_right" src="{{=it[n].PhotoSizeList[i]}}" alt="" imgid="{{=i}}">                                            {{?}}                                        </div>                                        <a class="pic_right" imgid="0" style="display: none">查看更多</a>                                    </div>{{?}}                                    <!-- 发表时间 -->                                    <div class="c_dates clearfix">                                        <div class="reward_type">                                            <span class="family_t">{{=it[n].WalkAimDes}}</span>                                        </div>                                        <span class="reward_time">                                            {{=it[n].CreateDateSoa}}&nbsp;                                            发表于{{? it[n].CommentSource == 2}}<i class="pc"></i>{{??}}<i class="app"></i>{{?}}                                            {{=it[n].CommentSourceDes}}                                        </span>                                    </div>                                    <!-- 同程回复 -->                                    {{? it[n].Response ==""}}                                    {{??}}                                    <div class="tc_review">                                        <p>                                   			<span>同程回复：</span>{{=it[n].Response}}                                        </p>                                    </div>                                    {{?}}                                  </div>                                {{? it[n].Response == 0}}                                <span class="reward_support none" resId="{{=it[n].ResId}}"><span><em>{{=it[n].PraiseCount}}</em>有用</span></span>                                {{??}}                                <span class="reward_support none reward_supported" resId="{{=it[n].ResId}}"><span><em>{{=it[n].PraiseCount}}</em>有用</span></span>                                {{?}}                                </div>                                {{ } }}';t&&fish.mPop.close(),fish.trim(fish.one(".satisfaction_wrap").html()).length<1&&fish.one(".satisfaction_wrap").html(fish.template(n,i)),fish.trim(fish.one(".dp_tab").html()).length<1&&fish.one(".dp_tab").html(fish.template(o,i)),a?fish.one(".dp_list").html(fish.template(l,a)):fish.one(".dp_list").html(""),fish.one("#ctrlPager").html().length>0||!a?fish.one("#ctrlPager").removeClass("none"):fish.one("#ctrlPager").addClass("none"),s(),fish.all(".reward_support").on("click",function(){var e=this,t=this.getAttribute("resId"),s=fish.cookie.get("us","userid");if(!fish.one(e).hasClass("reward_supported"))if(s){fish.one(e).addClass("reward_supported"),fish.one("em",e).html(parseInt(fish.one("em",e).html())+1),fish.ajax({url:"/youlun/CruiseTours/CruiseToursAjax.aspx?Type=GetCommentPraise",data:"praiseId="+t+"&userId="+s,type:"json",fn:function(t){var s=fish.one("#dp_tip"),i=fish.one(e).offset().left+40,a=fish.one(e).offset().top,n=30,o=400;s.css("top:"+a+"px;left:"+i+"px;display:block;opacity:0;filter:alpha(opacity=0)"),s.anim("top:"+(parseInt(a,10)-n)+"px;left:"+parseInt(i,10)+"px;opacity:1;filter:alpha(opacity=100)",o,{fn:function(){s.css("display:none;top:;left:;opacity:;filter:;")},easeing:function(){}})}})}else fish.mLogin()}),fish.all(".c_details p").each(function(e,t){var s=fish.one(e),i=s.height();if(i>72){var a=fish.one("span",s).html(),n=a.substring(0,200)+"...";s.css("height:72px;"),fish.one("span",s).html(n),fish.one(".checkmore",this).css("display:block").on("click",function(){fish.one(this).hasClass("hide")?(fish.one(this).removeClass("hide"),s.css("height:72px;"),fish.one("span",s).html(n),fish.one("span",this).html("展开全部")):(fish.one(this).addClass("hide"),s.css("height:auto;"),fish.one("span",s).html(a),fish.one("span",this).html("收起全部"))})}}),C()}},preSortTotal:function(e){return e.PageCount&&e.PageCount<=1?0:e.PageCount},ajaxObj:{type:"json",url:i+',"page":"{pagenum}"}',fn:function(e){return JSON.parse(e.result)}},skip:"true"})}function g(){var e=0,t=!0;fish.all(".review_select span").each(function(){fish.one(this).hasClass("at")&&(e=fish.one(this).attr("attr-type"))}),fish.all("#visitorsCommElem .dp_tab input").each(function(){if(fish.dom(this).checked){var s=fish.one(this).attr("sttr-url");s+="&dpCruiseId="+F.cruiseId+"&SortType="+e,fish.mPop({content:fish.one("#popOut #inline_example_load"),afterOpen:function(){_(s,t),window.scrollTo(0,fish.one(".reviews").offset().top-fish.one(".f_tit").height())}})}})}function C(){fish.all(".pic_show").each(function(e,t){var s=fish.all("img",e).length,i=fish.one(e).attr("attr-img").split(","),a=fish.one(e).attr("attr-maxImg").split(",");if(s>4){for(var n="",t=0;4>t;t++)n+="<img src='"+i[t]+"' class='pic_right' alt='' imgid='"+t+"'/>";fish.one(".pic_box",e).html(n),fish.all(".pic_right",e).css("display:block")}fish.all(".pic_right",e).on("click",function(){var e=parseInt(fish.one(this).attr("imgid"),10),t=a[e],i="<ul class='photo-list' page='1'>",n="";0==e&&(t=a[e]);for(var o=0;s>o;o++)i+='<li picunm="'+(o+1)+'"><img src="'+a[o]+'" alt=""/><i></i></li>';i+="</ul><a href='javascript:;' class='pa-l'></a><a href='javascript:;' class='pa-r'></a>",n+='<div class="big-photo">                            <img src="'+t+'">                            <span class="big-p-num">'+(e+1)+"/"+s+'</span>                         </div>                         <div class="pa-box">'+i+"</div>",fish.one(".popc-con").html(n),fish.mPop({content:fish.one("#popOut .photo-album"),afterOpen:function(){var t=Math.ceil(s/4);5>s&&fish.all(".pa-l,.pa-r").html("remove"),fish.one(".photo-list").css("width:"+184*s+"px;"),fish.one(".photo-album .popName").html(fish.one("#HidShipName").val()),fish.one(fish.all(".photo-list li")[e]).addClass("photo-at"),fish.all(".photo-list li").each(function(e,t){fish.one(e).on("mouseover",function(){y(t,s)})}),fish.one(".pa-l").on("click",function(){var e=parseInt(fish.one(".photo-list").attr("page"),10);1!=e&&(e-=1,fish.one(".photo-list").attr("page",e),fish.one(".photo-list").anim("left:"+-(736*(e-1))+"px;",100),y(4*e-4,s))}),fish.one(".pa-r").on("click",function(){var e=parseInt(fish.one(".photo-list").attr("page"),10);e!=t&&(fish.one(".photo-list").anim("left:"+-(736*e)+"px;",100),e+=1,fish.one(".photo-list").attr("page",e),y(4*e-4,s))})}})})})}function y(e,t){fish.one(".big-photo img").attr("src",fish.one(fish.all(".photo-list li img")[e]).attr("src")),fish.one(".big-p-num").html(fish.one(fish.all(".photo-list li")[e]).attr("picunm")+"/"+t),fish.all(".photo-list li").removeClass("photo-at"),fish.one(fish.all(".photo-list li")[e]).addClass("photo-at")}function b(e){var t=document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop;window.scrollTo(0,t+(e?e:1)),setTimeout(function(){var t=document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop;window.scrollTo(0,t-(e?e:1))})}function w(){var e=fish.one("#mSlider").attr("attr-url");fish.ajax({url:e,type:"json",fn:function(e){if(e){if(""==e.imgList)return;var t=e.imgList[0].imgurl,s=e.imgList[0].name,i='<img src="'+t+'" alt="'+s+'"/>';fish.one(".line_img").html(i)}}})}function k(){var e=fish.one("#HidCalendarDate").val();fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=GetFinalPrice&lineid="+B+"&saildate="+e,type:"json",fn:function(e){if(e){fish.one(".pri_d").html("<span><strong>&yen;<b>"+e.calPrice+"</b></strong>起</span>");var t=fish.one(".ylc-modal .eve_yusuan input");t&&t[0]&&parseInt(t.val(),10)<=0&&(t.val(e.calPrice),t.attr("_placeholder",e.calPrice))}}})}function x(){""!=fish.trim(fish.one(".reason").html())&&"<P><BR></P>"!=fish.trim(fish.one(".reason").html()).toUpperCase()&&"<P><BR/></P>"!=fish.trim(fish.one(".reason").html()).toUpperCase()||(fish.one("#recommend").addClass("none"),fish.one(fish.all(".f_tit li")[0]).addClass("none")),s()}function T(){var e=fish.one("#room").attr("attr-url");fish.ajax({url:e,type:"json",fn:function(e){if(e){if(""==e.RoomPicList)return;var t='<div id="r_slider" class="r_slider mSlider_con"><ul>{{for(var n = 0,m = it.length; n < m; n++){ }}<li><a href="/youlun/linebook/'+B+'.html" target="_blank"><img src="{{=it[n].ImgUrl}}"/><div class="minprice"><div><span>{{=it[n].roomname}}<em><b>&yen;</b><strong>{{=it[n].Minprice}}</strong></em><i>起</i></span></div></div></a></li>{{ } }}</ul></div><a id="room_prev" class=" btn prev" href="javascript:void(0)"></a><a id="room_next" class="btn next" href="javascript:void(0)"></a><div id="r_bottom" class="r_bottom"><ul>{{for(var n = 0,m = it.length; n < m; n++){ }}<li><img src="{{=it[n].ImgUrl}}"/><div></div><span>{{=it[n].roomname}}</span></li>{{ } }}</ul></div>',s=e.RoomPicList;
fish.one("#room").html(fish.template(t,s)),fish.all(".minprice strong").each(function(){0!=fish.one(this).html()&&void 0!=fish.one(this).html()||fish.one(this).parent(".minprice").css("display:none")}),fish.trim(fish.one(".room").html())&&d("r_slider","r_bottom","room_prev","room_next",10)}}})}function j(){var e=fish.one("#calendar_top").attr("attr-url");fish.ajax({url:e,type:"json",fn:function(e){if(e){if(""==e.MouthList)return;var t='<a class="btn prev disabled"></a><div class="calendar_top_con"><ul>{{for(var n = 0,m = it.length; n < m; n++){ }}<li s_date="{{=it[n].startdate}}" e_date="{{=it[n].enddate}}">{{=it[n].data}}</li>{{ } }}</ul></div><a class="btn next disabled"></a>',s=e.MouthList;fish.one("#calendar_top").html(fish.template(t,s)),fish.one("#calendar_top li").addClass("on");var i=fish.all("#calendar_top li").length;1==i?fish.all("#calendar_top li").css("width:100%"):2==i?fish.all("#calendar_top li").css("width:50%"):3==i?fish.all("#calendar_top li").css("width:33.33%"):(fish.one("#calendar_top ul").css("width:"+120*i+"px;"),fish.all("#calendar_top li").css("width:120px;"),fish.one("#calendar_top .next").removeClass("disabled")),make_canael(F.rateOption)}}})}function D(){function e(e){for(var t='{{?it.index > 0 && it.StayTimeDesc}}                            <div class="transfer_sit_line">                                <p><span><em class="e_l"></em>{{=it.DepartureCityName}}中转 停留{{=it.StayTimeDesc}}<em class="e_r"></em></span></p>                            </div>                        {{?}}                        <div class="air_tr_lines clearfix">                            <p class="air_p01">{{=it.AirlineName}}<br/><span class="m_l_0 sp0">{{=it.FlightNo}}</span><span class="sp0">{{=it.CraftType}}</span><span class="sp0">{{=it.ClassType}}</span></p>                            <p class="air_p02 "><span class="f_s_14">{{=it.DepartureTime.substr(0,16)}}<br/><span class="c_666">{{=it.DeparturePort}}</span></p>                            <div class="table_line"><span class="c_l"></span><span class="c_r"></span></div>                            <p class="air_p02 "><span class="f_s_14">{{=it.ArrivalTime.substr(0,16)}}<br/><span class="c_666">{{=it.ArrivalPort}}</span></p>                            <p class="air_p03"><span class="c_666">飞行时长：</span>约{{=it.DurationTimeDesc}}</p>                        </div>',s="",i="",a=0,n=e.length;n>a;a++)e[a].index=a,0==e[a].ClassType?e[a].ClassType="经济舱":1==e[a].ClassType?e[a].ClassType="公务舱":2==e[a].ClassType?e[a].ClassType="头等舱":e[a].ClassType="",s+=fish.template(t,e[a]),i+='<span class="tit_span">'+e[a].DepartureCityName+"-"+e[a].ArrivalCityName+"</span>";return'<div class="air_t_info"><h4 class="tr_l_ports">'+i+"</h4>"+s+"</div>"}var t=fish.one("#airMsg");fish.ajax({url:"/youlun/CruiseTours/CruiseToursAjax_Book.aspx?type=GetLineAirlinePrdouctInfo",data:"LineId="+fish.trim(fish.one("#HidLineid").val())+"&lineDate="+fish.trim(fish.one("#oneCal").val()),type:"json",err:function(){},fn:function(s){if(!s||s.length<=0)return void t.addClass("none");for(var i="",a="",n="",o="",l=s.length,r=0;l>r;r++){var c=s[r].CruiseFlightTicketDepartureModel,h=s[r].CruiseFlightTicketArrivalModel;i+='<li class="air_buts" _n="'+r+'">航班'+(r+1)+"</li>",n='<div class="trip_con clearfix"><span class="trip_span"><em>去程</em></span>'+e(c)+"</div>",o='<div class="trip_con clearfix"><span class="trip_span"><em>返程</em></span>'+e(h)+"</div>",lineStr='<div class="arrow_line"></div>',(!c||c.length<=0)&&(n="",lineStr=""),(!h||h.length<=0)&&(o="",lineStr=""),a+='<div class="air_msg_con none" _n="'+r+'">'+n+lineStr+o+"</div>",n=o=""}t.html('<h4 class="air_tit"><span class="sp_t"><em></em>航班信息</span>（航班仅供参考，具体航班以出团通知书为准，起飞与抵达时间以当地时间为准）</h4><ul class="air_ul_tab'+(l>=2?" ":" none ")+'">'+i+"</ul>"+a).removeClass("none"),fish.all(".airport_msg .air_buts")[0]&&fish.all(".airport_msg .air_buts")[0].click()}}),fish.all(".airport_msg").on("click",function(e){var t=fish.getTarget(e),s=fish.one(t);do if(s.hasClass("air_buts")){var i=s.parent(".airport_msg")[0],a=fish.all(".air_buts",i),n=fish.all(".air_msg_con",i),o=parseInt(fish.trim(s.attr("_n")),10);return a.removeClass("act"),s.addClass("act"),n.addClass("none"),void fish.one(n[o]).removeClass("none")}while(t=t.parentNode)});var i="/youlun/AjaxCall_Cruise.aspx?Type=TravelTripFinal&lineid="+B+"&saildate="+fish.one("#oneCal").val();fish.ajax({url:i,type:"json",fn:function(e){if(e){if(e.Date=fish.one("#HidDate").val(),!e.SummayTravel)return fish.one("#itinerary").html("remove"),fish.all(".f_tit li").each(function(e){var t=fish.one(e).attr("attr-id");1==t&&fish.one(e).html("remove")}),void s();for(var t='<h5>行程概述</h5>                                <div class="overviews">                                    <div class="routeMap"><img src="{{=it.TripImage}}" alt=""/></div>                                    {{var date = new Date(it.Date.replace(/-/gi, "/")).getTime(),addenglish = 0;}}                                    {{? it.IsInterLine == 1}}                                    {{? it.IsLongLine == 1 && it.IsSinglePicket == 1}}{{addenglish = 1;}}{{?}}                                        <div class="routeTable">                                            <dl class="head">                                                <dd class="dayth">行程</dd>                                                <dd class="throuth">国家/城市</dd>                                                <dd class="arrive">抵达<span>当地时间</span></dd>                                                <dd class="sail">启航<span>当地时间</span></dd>                                            </dl>                                            <div id="ins_container">                                                <div id="ins_shower">                                                {{for(var a = 0,b = it.SummayTravel.CalendarTravelList,c = b.length; a < c; a++){ }}                                                    <dl {{? addenglish}}class="english {{? a%2 == 1}}even{{?}}"{{??}}class="{{? a%2 == 1}}even{{?}}"{{?}}>                                                        <dd class="dayth">第{{=b[a].Date}}天<em>({{=new Date(date+a*1000*60*60*24).getMonth() + 1}}月{{=new Date(date+a*1000*60*60*24).getDate()}}日)</em></dd>                                                        <dd class="throuth">{{=b[a].CountryOrSight}}{{?addenglish}}<br/>{{=b[a].CountryEn}}{{?}}</dd>                                                        <dd class="arrive">{{=b[a].ArrTime}}&nbsp;</dd>                                                        <dd class="sail">{{=b[a].SetUpTime}}</dd>                                                    </dl>                                                {{ } }}                                                </div>                                            </div>                                            <div id="ins_scroller">                                                <div  id="ins_scroll_bar"></div>                                            </div>                                        </div>                                    {{??}}                                        <div class="routeTable">                                            <dl class="head">                                                <dd class="dayth">行程</dd>                                                <dd class="throuth">途径景点</dd>                                                <dd class="arrive">入住</dd>                                                <dd class="sail"></dd>                                            </dl>                                            <div id="ins_container">                                                <div id="ins_shower">                                                {{for(var a = 0,b = it.SummayTravel.CalendarTravelList,c = b.length; a < c; a++){ }}                                                    <dl {{? a%2 == 1}}class="even" {{??}}{{?}}>                                                        <dd class="dayth">第{{=b[a].Date}}天<em>({{=new Date(date+a*1000*60*60*24).getMonth() + 1}}月{{=new Date(date+a*1000*60*60*24).getDate()}}日)</em></dd>                                                        <dd class="throuth">{{=b[a].CountryOrSight}}</dd>                                                        <dd class="arrive">{{=b[a].TravelLive}}&nbsp;</dd>                                                        <dd class="sail"></dd>                                                    </dl>                                                {{ } }}                                                </div>                                            </div>                                            <div id="ins_scroller">                                                <div  id="ins_scroll_bar"></div>                                            </div>                                        </div>                                    {{?}}                                    <p class="routeNote"><span style="color:#ff6600;">*</span>上述抵达与启航时间均为参考信息，具体信息请以邮轮实际行程为准</p>                                </div>                                {{? it.CruiseTravelAllModel.CruiseTravelDayModList.length > 0}}                                <h5> 行程详情                                    <div class="itinerary_print">                                        <span onclick="_tcTraObj._tcTrackEvent(\'click\',\'PCtours-xlts\',\'email\');" class="email_pbt" a-url="/youlun/CruiseTours/CruiseToursAjax.aspx?Type=GetEmailRoute&amp;lineid=printid">Email行程</span>                                        <a onclick="_tcTraObj._tcTrackEvent(\'click\',\'PCtours-xlts\',\'dayin\');" _href="/youlun/tour/GetourToMember.aspx?lineid=printid" class="print_link">打印行程</a>                                    </div>                                </h5>                                <div class="routeDetail">                                    <div class="dayList">                                        <div id="dayList">                                            <div class="dayListArrow up none"></div>                                            <div class="dayList_nav">                                                <ul attr-top="0">                                                {{for(var a = 1,b = it.CruiseTravelAllModel.CruiseTravelDayModList,c = b.length; a <= c; a++){ }}                                                    <li>第{{=a}}天</li>                                                {{ } }}                                                </ul>                                            </div>                                            <div class="dayListArrow down act none"></div>                                        </div>                                    </div>                                    {{? it.IsInterLine == 1}}                                        <div class="dayCon">                                            {{for(var a = 0,b = it.CruiseTravelAllModel.CruiseTravelDayModList,c = b.length; a < c; a++){ }}                                                <div class="travel_day" id="day{{=(a + 1)}}">                                                    <span class="travel_day_logo {{? b[a].IsTravelSea == 0}}shore {{??}}{{?}}"></span>                                                    <p class="travel_day_title"><span>第{{=(a + 1)}}天</span><span>{{=b[a].LineCity}}</span>{{? b[a].ArrTime != ""}}<span>抵达时间 {{=b[a].ArrTime}}</span>{{??}}{{?}}{{? b[a].SetUpTime !=""}}<span>启航时间 {{=b[a].SetUpTime}}</span>{{??}}{{?}}</p>                                                    <div class="travel_day_con">                                                        {{? b[a].EatModel != null || b[a].TravelLive !=""}}<p class="eat">{{? b[a].EatModel != null}}{{for(var i = 0, j = b[a].EatModel.length; i < j; i++){}}<span>邮轮{{=b[a].EatModel[i].EatName}}：{{=b[a].EatModel[i].IsContain}}</span>{{}}}{{??}}{{?}}{{? b[a].TravelLive != ""}}<span class="home">入住：{{=b[a].TravelLive}}</span>{{??}}{{?}}</p>{{??}}{{?}}                                                        <div class="route">{{=b[a].Description}}</div>                                                        <div class="route_img">                                                            <div class="mSlider_con">                                                                    <ul>                                                                    {{? b[a].SightCruiseTravelScenicImg}}                                                                        {{for(var x = 0,y = b[a].SightCruiseTravelScenicImg,z = y.length; x < z; x++){ }}                                                                            <li>                                                                                <img src="{{=y[x].ImgUrl}}"/>                                                                                <div class="layer">{{=y[x].Name}}</div>                                                                            </li>                                                                        {{ } }}                                                                    {{??}}{{?}}                                                                    </ul>                                                                </div>                                                            <a class="slider_left"></a>                                                            <a class="slider_right"></a>                                                        </div>                                                    </div>                                                    {{? b[a].CruiseTravelDetailMod.length > 0}}                                                        <div class="excusion">                                                            <p class="nochange"><span>岸上观光</span>（一条线路是贯穿整个旅行的，如选择A线，则所有岸上游都是A线的行程）</p>                                                            {{for(var x = 0,y = b[a].CruiseTravelDetailMod,z = y.length; x < z; x++){}}                                                                {{var time = y[x].DetailExcursion.CLTDETravelTime,hours = parseInt(time/60,10),minus = time%60,Breakfast = y[x].DetailExcursion.CLTDEIsIncludeBreakfast,Lunch = y[x].DetailExcursion.CLTDEIsIncludeLunch,Dinner = y[x].DetailExcursion.CLTDEIsIncludeDinner,foot = "岸上餐食：";}}                                                                {{? Breakfast == 0 && Lunch == 0 && Dinner == 0}}{{foot = "";}}{{??}}{{? Breakfast == 1}}{{foot += "早餐,";}}{{??}}{{?}}{{? Lunch == 1}}{{foot += "午餐,";}}{{??}}{{?}}{{? Dinner == 1}}{{foot += "晚餐,";}}{{??}}{{?}}{{foot = foot.replace(/,$/g,"")+"包含";}}{{?}}                                                                <div class="excusion_type">                                                                    <p class="vaca"><span>{{=y[x].TypeName}}</span><span>景点：{{for(var j = 0,k = y[x].VisitNameList,l = k.length;j < l; j++){}} {{? j != l-1}}{{=k[j]}}-{{??}}{{=k[j]}}{{?}}{{}}}</span><em></em></p>                                                                    <div class="scenic none">                                                                        {{? time > 0 || foot.length > 0}}<p class="scenic_time clearfix">{{? time > 0}}<span class="time">行程总时长约：{{? hours > 0}}{{=hours}}小时{{??}}{{?}}{{? minus > 0}}{{=minus}}分钟{{??}}{{?}}{{??}}{{?}}</span><span>{{=foot}}</span></p>{{??}}{{?}}                                                                        {{for(var j = 0,k = y[x].CruiseTravelSightDetailModList,l = k.length;j < l;j++){}}                                                                            <p class="scenic_name"><span>【{{=k[j].Name}}】</span>{{=k[j].Description == null ? "" : k[j].Description}}</p>                                                                        {{}}}                                                                        <p class="scenic_weath">以上岸上观光行程安排可能因天气、路况等原因做顺序上的相应调整，请您谅解。</p>                                                                        {{? y[x].CruiseTravelScenicImg.length > 0}}                                                                            <ul>                                                                            {{for(var j = 0,k = y[x].CruiseTravelScenicImg,l = k.length;j < l; j++){}}                                                                                <li><img src="{{=k[j].ImgUrl}}"><p>{{=k[j].Name}}</p></li>                                                                            {{}}}                                                                            </ul>                                                                        {{??}}{{?}}                                                                    </div>                                                                </div>                                                            {{ } }}                                                        </div>                                                    {{??}}{{?}}                                                </div>                                            {{ } }}                                        </div>                                        {{??}}                                            <div class="dayCon">                                                {{for(var a = 0,b = it.CruiseTravelAllModel.CruiseTravelDayModList,c = b.length; a < c; a++){ }}                                                    <div class="travel_day" id="day{{=(a + 1)}}">                                                        <span class="travel_day_logo {{? b[a].IsTravelSea == 0}}shore {{??}}{{?}}"></span>                                                        <p class="travel_day_title"><span>第{{=(a + 1)}}天</span><span>{{=b[a].LineCity}}</span></p>                                                        <div class="travel_day_con">                                                            {{? b[a].EatModel != null || b[a].TravelLive !=""}}<p class="eat">{{? b[a].EatModel != null}}{{for(var i = 0, j = b[a].EatModel.length; i < j; i++){}}<span>游轮{{=b[a].EatModel[i].EatName}}：{{=b[a].EatModel[i].IsContain}}</span>{{}}}{{??}}{{?}}{{? b[a].TravelLive != ""}}<span class="home">入住：{{=b[a].TravelLive}}</span>{{??}}{{?}}</p>{{??}}{{?}}                                                            <div class="route">{{=b[a].Description}}</div>                                                            <div class="route_img">                                                                <div class="mSlider_con">                                                                    <ul>                                                                    {{? b[a].SightCruiseTravelScenicImg}}                                                                        {{for(var x = 0,y = b[a].SightCruiseTravelScenicImg,z = y.length; x < z; x++){ }}                                                                            <li>                                                                                <img src="{{=y[x].ImgUrl}}"/>                                                                                <div class="layer">{{=y[x].Name}}</div>                                                                            </li>                                                                        {{ } }}                                                                    {{??}}{{?}}                                                                    </ul>                                                                </div>                                                                <a class="slider_left"></a>                                                                <a class="slider_right"></a>                                                        </div>                                                        </div>                                                        {{? b[a].CruiseTravelDetailMod.length > 0}}                                                            <div class="excusion">                                                                <p class="nochange"><span>岸上观光</span></p>                                                                {{for(var x = 0,y = b[a].CruiseTravelDetailMod,z = y.length; x < z; x++){}}                                                                    <div class="excusion_type">                                                                        <p class="vaca"><span>当日游玩景点</span><span>{{for(var j = 0,k = y[x].VisitNameList,l = k.length;j < l; j++){}} {{? j != l-1}}{{=k[j]}}-{{??}}{{=k[j]}}{{?}}{{}}}</span><em></em></p>                                                                        <div class="scenic none">                                                                            {{for(var j = 0,k = y[x].CruiseTravelSightDetailModList,l = k.length;j < l;j++){}}                                                                                <p class="scenic_name"><span>【{{=k[j].Name}}】</span>{{=k[j].Description}}</p>                                                                            {{}}}                                                                            <p class="scenic_weath">以上岸上观光行程安排可能因天气、路况等原因做顺序上的相应调整，请您谅解。</p>                                                                            {{? y[x].CruiseTravelScenicImg.length > 0}}                                                                                <ul>                                                                                {{for(var j = 0,k = y[x].CruiseTravelScenicImg,l = k.length;j < l; j++){}}                                                                                    <li><img src="{{=k[j].ImgUrl}}"><p>{{=k[j].Name}}</p></li>                                                                                {{}}}                                                                                </ul>                                                                            {{??}}{{?}}                                                                        </div>                                                                    </div>                                                                {{ } }}                                                            </div>                                                        {{??}}{{?}}                                                    </div>                                                {{ } }}                                            </div>                                        {{?}}                                </div>                                {{??}}{{?}}',i='<div class="route_infro"><em class="t_tit">行程概要：</em>',a=e.SummayTravel.CalendarTravelList,n=0,o=a.length;o>n;n++)5>n&&(i+="<span>",i+=0==n?"":'<em class="d_i"></em>',i+="&nbsp;D"+a[n].Date+'<em class="d_city">'+a[n].CountryOrSight.replace(/飞机/g,'</em><em class="d_i"></em><em class="d_city">').replace(/动车/g,'</em><em class="d_i"></em><em class="d_city">').replace(/火车/g,'</em><em class="d_i"></em><em class="d_city">').replace(/汽车/g,'</em><em class="d_i"></em><em class="d_city">').replace(/巴士/g,'</em><em class="d_i"></em><em class="d_city">').replace(/邮轮/g,'</em><em class="d_i"></em><em class="d_city">').replace(/大巴/g,'</em><em class="d_i"></em><em class="d_city">').replace(/轮船/g,'</em><em class="d_i"></em><em class="d_city">')+"</em></span>");a.length>5&&(i+='<span class="detail_l"><em class="d_i"></em>&nbsp;D6<em>...</em><a id="linkTravel">详情</a></span></div>'),fish.all(".route_infro").html("remove"),fish.one(".trip_msg").html("after",i),fish.all(".route_infro .d_city").each(function(){var e=fish.one(this).html();e.length>5&&(e=e.substr(0,5)+"..."),fish.one(this).html(e)});var l=fish.template(t,e);l=l.replace(/printid/g,B),fish.one(".specialty").html(l),fish.one(".travel_day").css("margin-top:0"),fish.one(".dayList_nav li").addClass("on"),fish.all(".travel_day_title span,.routeTable .throuth").each(function(){var e=fish.one(this).html();e=e.replace(/飞机/g,"<em class='plane'></em>").replace(/动车/g,"<em class='train'></em>").replace(/火车/g,"<em class='train'></em>").replace(/汽车/g,"<em class='bus'></em>").replace(/巴士/g,"<em class='bus'></em>").replace(/邮轮/g,"<em class='crise'></em>").replace(/大巴/g,"<em class='bus'></em>").replace(/轮船/g,"<em class='crise'></em>"),fish.one(this).html(e)}),fish.all(".travel_day_con").each(function(){0==fish.all(".route_img li",this).length&&(fish.one(".route_img",this).html("remove"),fish.one(".route",this).css("width:100%"))}),s(),fish.all("#ins_shower dl").length>5&&(fish.mScrollpane({wheelNum:10,container:"#ins_container",shower:"#ins_shower",scroller:"#ins_scroller",scroll_bar:"#ins_scroll_bar",defaultStyle:!0}),fish.one("#ins_container").css("margin-top:33px;"));var r=fish.all(".dayList_nav li").length,c=parseInt(r/8,10),h=r%8,d=35*(8*(c-1)+h);fish.all(".dayListArrow").on("click",function(){var e=parseInt(fish.one(".dayList_nav ul").attr("attr-top"),10);fish.one(this).hasClass("act")&&(fish.all(".dayListArrow").addClass("act"),fish.one(this).hasClass("up")&&(e-=175,0>=e&&(e=0,fish.one(this).removeClass("act")),fish.one(".dayList_nav ul").attr("attr-top",e)),fish.one(this).hasClass("down")&&(e+=175,e>=d&&(e=d,fish.one(this).removeClass("act")),fish.one(".dayList_nav ul").attr("attr-top",e)),fish.one(".dayList_nav ul").anim("top:-"+e+"px;",500))}),fish.all(".dayList_nav ul li").each(function(e,t){fish.one(e).on("click",function(){var e=fish.one(this),s=35*t;0==s?fish.one(".up").removeClass("act"):s>0&&d>s?fish.all(".up,.down").addClass("act"):(s=d,fish.one(".down").removeClass("act")),fish.all(".dayListArrow").hasClass("none")||fish.one(".dayList_nav ul").anim("top:-"+s+"px;",500),fish.all(".dayList_nav ul li").removeClass("on"),e.addClass("on"),window.scrollTo(0,fish.one(fish.all(".travel_day")[t]).offset().top-fish.one(".f_tit").height())})}),fish.all(".dayList_nav li").length<=8?fish.all(".dayList_nav,.dayList ul").css("height:auto;"):fish.all(".dayListArrow").removeClass("none"),fish.all(".excusion_type").each(function(){var e=fish.one(this);fish.one("p",e).on("click",function(){if(fish.one("em",this).hasClass("show")){fish.one("em",this).removeClass("show"),fish.one(".scenic",e).addClass("none");var t=fish.one(".dayCon").height();fish.one(".dayList").css("height:"+t+"px;"),fish.one("#dayList").offset().top>fish.one(".dayList").offset().top+fish.one(".dayList").height()-fish.one("#dayList").height()&&fish.one("#dayList").css({position:"absolute",bottom:0,top:"auto"})}else fish.one("em",this).addClass("show"),fish.one(".scenic",e).removeClass("none")})}),fish.all(".route_img").each(function(){fish.all("li",this).length>1?fish.one(this).mSlider({autoScroll:!0,showNav:!1,circle:!0,arrows:!0,moveTime:5e3,prevBtn:".slider_left",nextBtn:".slider_right"}):fish.all("a",this).css("display:none;")})}}})}function I(){var e=F.rateOption,t=fish.one("#TopProductElem .link_order"),s=fish.one(".elem_intr .fix_order .fix_order_link");fish.one("#TopProductElem .link_order").length>0&&t.attr("href",t.attr("href").addParams(e)),fish.one(".elem_intr .fix_order").length>0&&s.attr("href",s.attr("href").addParams(e))}function P(){var e=fish.one("#HidLineid").val(),t=fish.one("#oneCal").val();fish.ajax({url:fish.one("#contentRoomEle").attr("attr-url"),data:"lineid="+e+"&Date="+t+"&IsSelectPromotion=1",type:"json",fn:function(e){if(e&&e.ProList&&e.ProList.length>0){var t="",s=(new Date).getTime(),i=new Date("2016/05/25").getTime(),a=new Date("2016/06/20").getTime();s>=i&&a>s&&(t='<span class="hot616"></span>'),fish.one(".pro_tit .h2_title").html("bottom",t);for(var n="<span class='other_a showsale'>立减优惠</span>",o="",l=0;l<e.ProList.length;l++)o+="<p>"+e.ProList[l]+"</p>";fish.one(".other_h").removeClass("none"),fish.one(".pr_mg .price_yh").html("bottom",n),fish.one("#cuxiao .comm_mian").html("bottom",o),fish.one("#showsale").hover()}if(e&&e.GiftList&&e.GiftList.length>0){for(var n="<span class='other_a libao'>礼包</span>",o="",l=0;l<e.GiftList.length;l++)o+="<p>"+e.GiftList[l]+"</p>";fish.one(".pr_mg .price_yh").html("bottom",n),fish.one("#libao .comm_mian").html("bottom",o),fish.one("#libao").hover()}}})}function S(){fish.ajax({url:"/youlun/CruiseShipTeam/CruiseShipTeamAjax.aspx?type=GetYouJiInfo",data:"shipName="+encodeURIComponent(fish.one("#HidShipName").val())+"&length=158",type:"json",fn:function(e){if(!(e&&e.length>0))return fish.one("#travelsCommElem").html("remove"),fish.all(".f_tit li").each(function(e){var t=fish.one(e).attr("attr-id");6==t&&fish.one(e).html("remove")}),void s();var t='{{for(var n = 0, m = it.length; n < m; n++ ){}}                                <div class="tra_list">                                    <div class="tra_list_l">                                        <img src="{{=it[n].RmAuthorHeadImg}}" alt=""/>                                        <a class="tra_mr" href="http://go.ly.com/user/{{=it[n].AesRmMemberId}}/" target="_blank">{{=it[n].RmUserName}}</a>                                        <span class="tra_num tra_mr">{{=it[n].ReviewCount}}</span>                                        <span class="tra_lnum tra_mr">{{=it[n].ReRecommendCount}}</span>                                    </div>                                    <div class="tra_list_r">                                        <a class="tra_tit" href="http://go.ly.com/youji/{{=it[n].RmId}}.html" target="_blank">{{=it[n].RmTitle}}</a>                                        <p class="tra_info"><a target="_blank" href="http://go.ly.com/youji/{{=it[n].RmId}}.html">{{=it[n].Contentxt}}<span style="color: #167cd8">详情&gt;&gt;</span></a></p>                                        {{? it[n].RmImageList.length > 0}}<ul>{{for(var i = 0, j = it[n].RmImageList.length > 5 ? 5 : it[n].RmImageList.length; i < j; i++){ }}<li><a class="tra_tit" href="http://go.ly.com/youji/{{=it[n].RmId}}.html" target="_blank"><img src="{{=it[n].RmImageList[i]}}" alt=""/></a></li>{{}}}</ul>{{??}}{{?}}                                    </div>                                </div>                                {{?n != m - 1}}                                <div class="tra_lsty"></div>                                {{?}}                                {{}}}',i=e.length,a=fish.one("#HidCompanyId").val()||"",n=fish.one("#HidCruiseId").val()||"",o="/youlun/gonglve/",l="0"==fish.trim(fish.one("#HidYouJiType").val())&&i>1?"":" none ";a&&n&&(o="/youlun/gonglve_"+a+"_"+n+"/"),fish.one(".tra_main").html(fish.template(t,e)+'<a class="more_stra '+l+'" target="_blank" href="'+o+'"></a>')},err:function(){}})}function L(){fish.one(".boat_link").on("click",function(){var e=fish.one("#HidCruiseId").val(),t=window.location.href,s="/youlun"+t.split("?")[0].split("&")[0].split("/youlun")[1];fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=CruiseShipTeamStatistic",data:"Url="+s+"&cruiseid="+e+"&pagetype=1",type:"json",fn:function(e){}})})}function O(){var e=new Date,t=new Date("2016/04/18 00:00:00"),s=new Date("2016/04/30 00:00:00");return 72517==fish.one("#HidLineid").val()&&e.getTime()>t.getTime()&&e.getTime()<s.getTime()?(fish.one("#bannerImg").html('<a href="https://www.lancai.cn/?cid=108002" target="_blank"><img src="http://img1.40017.cn/cn/y/16/p/lancai.png"></a>'),fish.one("#bannerImg").anim("height:90px",1e3),!1):void fish.ajax({url:"/youlun/CruiseTours/CruiseToursAjax.aspx",data:"Type=GetCruiseSliderPicList&num=1",type:"json",fn:function(e){return e&&e[0]&&e[0].LineUrl?(e?fish.one("#bannerImg").html('<a href="'+e[0].LineUrl+'" target="_blank"><img src="'+e[0].ImgUrl+'"></a>'):"",void fish.one("#bannerImg").anim("height:90px",1e3)):!1},err:function(){fish.one("#bannerImg").anim("height:90px",1e3)}})}function M(e){return/^1[3,4,5,7,8]\d{9}$/i.test(e)}function N(){if(R("2016/06/02 00:00:00","2016/06/20 00:00:00")){fish.one(".workendactive").removeClass("none");var e=localStorage.lastOpenTime||0;0==e||e!=fish.parseDate()?(localStorage.lastOpenTime=fish.parseDate(),
fish.one(".bonus_box").css({left:0}),fish.one(".aside_tag").css({left:"-136px;"})):(fish.one(".bonus_box").css({left:"-100%;"}),fish.one(".aside_tag").css({left:0}))}R("2016/06/02 00:00:00","2016/06/09 00:00:00")&&(fish.one(".searchSale").attr("href","http://www.ly.com/zhuanti/youlundashiji"),fish.one(".searchSale img").attr("src","http://img1.40017.cn/cn/y/16/h/3.0.3/dashijian.gif")),fish.one(".bonus_form a").on("click",function(){if(!fish.one(this).hasClass("getting")){var e=fish.trim(fish.one(".phone").val()),t=fish.trim(fish.one(".code").val());if(!M(e))return void fish.one(".bonus_tip").html("<span>亲，请输入正确手机号</span>").removeClass("none");if(""==t)return void fish.one(".bonus_tip").html("<span>亲，请输入正确验证码</span>").removeClass("none");fish.one(this).addClass("getting"),fish.ajax({url:"/youlun/CruiseRedPacket/CruiseRedPacketajax.aspx?type=GetGiftPacketByMobile&mobile="+e+"&checkCode="+t,type:"json",fn:function(e){var t="/youlun/CruiseRedPacket/CruiseRedPacketajax.aspx";return fish.one(".bonus_form img").attr("src",t+"?type=GetRedPackCheckCode&module=1&height=40&width=60&r="+Math.random()),5==e.ResultCode?(fish.one(".bonus_tip").html("<span>亲，请输入正确验证码</span>").removeClass("none"),fish.one(".code").val(""),void fish.one(".bonus_form a").removeClass("getting")):void(0==e.ResultCode?(fish.all(".bonus_bg,.bonus_box").addClass("none"),fish.all(".bonus_mask,.bonus_suc").removeClass("none"),fish.one(".bonus_form a").removeClass("getting")):3==e.ResultCode&&(fish.all(".bonus_bg,.bonus_box").addClass("none"),fish.all(".bonus_mask,.bonus_suc").removeClass("none"),fish.one(".bonus_suc img").attr("src","http://img1.40017.cn/cn/y/15/h/hb2.jpg?v=1"),fish.one(".bonus_form a").removeClass("getting")))}})}}),fish.all(".phone,.code").on("focus",function(){fish.one(".bonus_tip").addClass("none")}),fish.one(".bonus_form img").on("click",function(){fish.one(".code").val("");var e="/youlun/CruiseRedPacket/CruiseRedPacketajax.aspx";fish.one(".bonus_form img").attr("src",e+"?type=GetRedPackCheckCode&module=1&height=40&width=60&r="+Math.random())}),fish.all(".bonus_suc .close,.use").on("click",function(){fish.all(".bonus_bg,.bonus_box").anim("left:-100%",800,function(){fish.one(".aside_tag").anim("left:0px;",200)}),fish.all(".bonus_mask,.bonus_suc").addClass("none")}),fish.one(".bonus_box .close").on("click",function(){fish.all(".bonus_bg,.bonus_box").anim("left:-100%",800,function(){fish.all(".bonus_bg,.bonus_box").addClass("none"),fish.one(".aside_tag").anim("left:0px;",200)})}),fish.one(".aside_tag").on("click",function(){var e=fish.one(this).width();fish.one(".aside_tag").anim("left:-"+e+"px;",200,function(){fish.all(".bonus_bg,.bonus_box").removeClass("none").anim("left:0%",800)})}),fish.browser("ms")&&fish.all(".bonus_box input").each(function(){var e=fish.one(this).attr("placeholder");fish.one(this).val(e).css({color:"#666"}).on("focus",function(){fish.one(this).val()==e&&fish.one(this).val("")}).on("blur",function(){""==!fish.one(this).val()?fish.one(this).css({color:"#333"}):fish.one(this).val(e)})})}function R(e,t){var s=new Date,i=new Date(e),a=new Date(t),n=s.getTime(),e=i.getTime(),t=a.getTime();return n>e&&t>n}fish.admin.config({mScrollpane:{v:"0.1",css:"1",g:2122}});var F={};F.rateOption={},F.cruiseId=fish.one("#HidCruiseId").val(),F.HidTransport=encodeURIComponent(fish.one("#HidTransport").val());var B=fish.one("#HidLineid").val();fish.extend({block:function(){this.css("display:block;")},none:function(){this.css("display:none")}}),F.usi=fish.cookie.get("us","userid"),fish.on("click",function(e){var t=fish.getTarget(e);do{var s=t.className;if(s&&s.indexOf("enshrine")>-1){var i=fish.one(t);if(i.hasClass("iscollect"))return;return void(F.usi?c(i.attr("attr-url"),"Addnew"):fish.mLogin({unReload:!0,loginSuccess:function(){var e=window.location.href;window.location.href=e+"?islogin=1",c(i.attr("attr-url"),"Addnew")}}))}if(s&&s.indexOf("top_proInfo")>-1)return}while(t=t.parentNode)},"#TopProductElem"),fish.on("mouseover",function(e){var t=fish.getTarget(e);do{var s=t.className;if(s&&s.indexOf("up_price")>-1){F.showC=!0;var i=l(t,23,-8),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#upPriceInfo").css("top:"+i.top+"px;left:"+i.left+"px;display:block;"),void r("#upPriceInfo",t,a)}if(s&&s.indexOf("up_baiti")>-1){F.showC=!0;var i=l(t,30,-227),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#upBitiaoInfo").css("top:"+i.top+"px;left:"+i.left+"px;display:block;"),void r("#upBitiaoInfo",t,a)}if(s&&s.indexOf("tip_top")>-1){F.showC=!0;var i=l(t,23,-8),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#prizeRules").css("top:"+i.top+"px;left:"+i.left+"px;display:block;"),void r("#prizeRules",t,a)}if(s&&s.indexOf("pre_t")>-1){F.showC=!0;var i=l(t,33,-8),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#prizeRules").css("top:"+i.top+"px;left:"+i.left+"px;display:block;"),void r("#prizeRules",t,a)}if(s&&s.indexOf("usered")>-1){F.showC=!0;var i=l(t,33,-58),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#redpacket").css("top:"+i.top+"px;left:"+i.left+"px;display:block;"),void r("#redpacket",t,a)}if(s&&s.indexOf("banked")>-1){F.showC=!0;var i=l(t,33,-88),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#bankpacket").css("top:"+i.top+"px;left:"+i.left+"px;display:block;"),void r("#bankpacket",t,a)}if(s&&s.indexOf("hot_train")>-1){F.showC=!0;var i=l(t,33,0),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#trainpacket").css("top:"+i.top+"px;left:"+i.left+"px;display:block;"),void r("#trainpacket",t,a)}if(s&&s.indexOf("showsale")>-1){F.showC=!0;var i=l(t,33,0),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#cuxiao").css("top:"+i.top+"px;left:"+i.left+"px;display:block;"),void r("#cuxiao",t,a)}if(s&&s.indexOf("libao")>-1){F.showC=!0;var i=l(t,33,-58),a=fish.one(window).width();return fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules,#redpacket,#cuxiao,#libao,#write").none(),fish.one("#libao").css("top:"+i.top+"px;left:"+i.left+"px;display:block;"),void r("#libao",t,a)}if(s&&s.indexOf("sale_active")>-1)return F.showC=!0,fish.all("#trainpacket,#bankpacket,#upBitiaoInfo,#upPriceInfo,#prizeRules").none(),fish.all("#active span").css("font-size:12px;"),void fish.one("#active").css("top:"+(fish.one(".sale_active").offset().top-fish.one(".ul_list").offset().top+fish.one(".sale_active").height())+"px;display:block;");if(s&&s.indexOf("top_proInfo")>-1)return}while(t=t.parentNode)},".content"),fish.on("mouseout",function(e){var t=fish.getTarget(e);do{var s=t.className;if(s&&s.indexOf("up_price")>-1)return F.showC=!1,void setTimeout(function(){F.showC||fish.one("#upPriceInfo").none()},100);if(s&&s.indexOf("up_baiti")>-1)return F.showC=!1,void setTimeout(function(){F.showC||fish.one("#upBitiaoInfo").none()},100);if(s&&s.indexOf("tip_top")>-1)return F.showC=!1,void setTimeout(function(){F.showC||fish.one("#prizeRules").none()},100);if(s&&s.indexOf("pre_t")>-1)return F.showC=!1,void setTimeout(function(){F.showC||fish.one("#prizeRules").none()},100);if(s&&s.indexOf("usered")>-1)return F.showC=!1,void setTimeout(function(){F.showC||fish.one("#redpacket").none()},100);if(s&&s.indexOf("banked")>-1)return F.showC=!1,void setTimeout(function(){F.showC||fish.one("#bankpacket").none()},100);if(s&&s.indexOf("hot_train")>-1)return F.showC=!1,void setTimeout(function(){F.showC||fish.one("#trainpacket").none()},100);if(s&&s.indexOf("showsale")>-1)return F.showC=!1,void setTimeout(function(){F.showC||fish.one("#cuxiao").none()},100);if(s&&s.indexOf("libao")>-1)return F.showC=!1,void setTimeout(function(){F.showC||fish.one("#libao").none()},100);if(s&&s.indexOf("writeYouji")>-1)return F.showC=!1,void setTimeout(function(){F.showC||fish.one("#write").none()},100);if(s&&s.indexOf("sale_active")>-1)return F.showC=!1,void setTimeout(function(){F.showC||fish.one("#active").none()},100);if(s&&s.indexOf("top_proInfo")>-1)return}while(t=t.parentNode)},".content"),fish.on("mouseover",function(){F.showC=!0},"#upPriceInfo"),fish.on("mouseout",function(){F.showC=!1,setTimeout(function(){F.showC||fish.one("#upPriceInfo").none()},100)},"#upPriceInfo"),fish.on("mouseover",function(){F.showC=!0},"#upBitiaoInfo"),fish.on("mouseout",function(){F.showC=!1,setTimeout(function(){F.showC||fish.one("#upBitiaoInfo").none()},100)},"#upBitiaoInfo"),fish.on("mouseover",function(){F.showC=!0},"#prizeRules"),fish.on("mouseout",function(){F.showC=!1,setTimeout(function(){F.showC||fish.one("#prizeRules").none()},100)},"#prizeRules"),fish.on("mouseover",function(){F.showC=!0},"#redpacket"),fish.on("mouseout",function(){F.showC=!1,setTimeout(function(){F.showC||fish.one("#redpacket").none()},100)},"#redpacket"),fish.on("mouseover",function(){F.showC=!0},"#bankpacket"),fish.on("mouseout",function(){F.showC=!1,setTimeout(function(){F.showC||fish.one("#bankpacket").none()},100)},"#bankpacket"),fish.on("mouseover",function(){F.showC=!0},"#trainpacket"),fish.on("mouseout",function(){F.showC=!1,setTimeout(function(){F.showC||fish.one("#trainpacket").none()},100)},"#trainpacket"),fish.on("mouseover",function(){F.showC=!0},"#cuxiao"),fish.on("mouseout",function(){F.showC=!1,setTimeout(function(){F.showC||fish.one("#cuxiao").none()},100)},"#cuxiao"),fish.on("mouseover",function(){F.showC=!0},"#libao"),fish.on("mouseout",function(){F.showC=!1,setTimeout(function(){F.showC||fish.one("#libao").none()},100)},"#libao"),fish.on("mouseover",function(){F.showC=!0},"#write"),fish.on("mouseout",function(){F.showC=!1,setTimeout(function(){F.showC||fish.one("#write").none()},100)},"#write"),fish.on("mouseover",function(e){var t=fish.getTarget(e),s=l(t,80,-5),i=fish.one(t).attr("src");fish.all(".reviews_main li").removeClass("on"),fish.one(this).parent().addClass("on"),fish.one(".reviews_img").css("top:"+s.top+"px;left:"+s.left+"px;display:block;").html("<img src='"+i+"'/>")},".reviews_main .rev_img li img"),fish.on("mouseout",function(){fish.all(".reviews_main li").removeClass("on"),fish.one(".reviews_img").css("display:none;")},".reviews_main .rev_img li img"),fish.all(".reviews_main dl ul").on("mouseover",function(){var e=fish.all("li.good",this).length,t=fish.one(this);fish.one(".star_con").html(e+"分,很满意</div>"),fish.one(".star").css("top:"+(t.offset().top+t.height())+"px;left:"+t.offset().left+"px;display:block;")}).on("mouseout",function(){fish.one(".star").css("display:none;")}),fish.on("click",function(e){var t=fish.getTarget(e);do{var s=t.className;if(s&&s.indexOf("reviewInput")>-1)return setTimeout(function(){g()},10),void b(10);if(s&&s.indexOf("paixu")>-1)return fish.all(".review_select span").removeClass("at"),fish.one(t).addClass("at"),setTimeout(function(){g()},10),void b(10);if(s&&s.indexOf("link_quick")>-1)return fish.one(".linkName").val("请问如何称呼您").css("color:#999"),fish.one(".linkPhone").val("请问如何联系您").css("color:#999"),fish.all("#needElem .place_l").removeClass("place_at"),void fish.mPop({content:fish.dom("#needElem"),width:636});if(s&&s.indexOf("look")>-1)window.scrollTo(0,fish.one(".calbox").offset().top-fish.one(".intr_tit").height());else if(s&&s.indexOf("top_proInfo")>-1)return}while(t=t.parentNode)},"body"),fish.all(".description_con p").css("font-family:'microsoft yahei';background:none;"),fish.all(".con_height").each(function(){var e=fish.one(this);if(e.height()>104){var t=e.parent(".description"),s=fish.one(".c_btu",t);s.removeClass("none"),e.css("height:100px; overflow:hidden")}}),fish.all(".c_btu span").on("click",function(){var e=fish.one(this),t=e.parent(".description"),s=fish.one(".con_height",t);s.css("height:auto;");var i=s.height();if(s.css("height:104px;"),e.hasClass("ctrl_open"))e.removeClass("ctrl_open").html("收起"),s.anim("height:"+i+"px;",500);else{e.addClass("ctrl_open").html("展开"),s.anim("height: 104px;",2e3);var a=s.height();window.scrollTo(0,s.offset().top-a)}}),e(),fish.all(".visa li").each(function(e,t){var s=fish.one(this);s.on("click",function(){fish.all(".visa li").removeClass("on"),s.addClass("on"),fish.all(".visa_area").addClass("none"),fish.one(fish.all(".visa_area")[t]).removeClass("none")})}),fish.all(".visa_con_tab").each(function(){var e=fish.one(this),t=e.parent(".visa_area");fish.all("a",e).each(function(s,i){fish.one(s).on("click",function(){fish.all("a",e).removeClass("on"),fish.one(s).addClass("on"),fish.all(".tab_table",t).addClass("none"),fish.one(fish.all(".tab_table",t)[i]).removeClass("none")})})}),fish.all(".description_tab li").each(function(e,t){var s=fish.one(this);s.on("click",function(){fish.all(".description_tab li").removeClass("at"),s.addClass("at"),fish.all(".description_con").addClass("none"),fish.one(fish.all(".description_con")[t]).removeClass("none"),window.scrollTo(0,fish.one(fish.dom(".description_con").parentNode.parentNode).offset().top-36)})}),t(),fish.one(".weix_share").on("mouseover",function(){fish.one(".weix_share .wx_tip").removeClass("none")}).on("mouseout",function(){fish.one(".weix_share .wx_tip").addClass("none")}),F.itinerary=!0,F.commonFlag=!0,F.travels=!0,fish.one("#Transport").on("click",function(){var e=fish.one(fish.all(".detail_con")[parseInt(fish.one(this).attr("_num"),10)]).offset().top,t=fish.one(".intr_tit").height(),s=isNaN(parseInt(fish.all(".detail_con").getCss("margin-top")))?parseInt(fish.one(".detail_con").getCss("marginTop")):parseInt(fish.all(".detail_con").getCss("margin-top"));window.scrollTo(0,e-t-s+1)}),fish.all(".cancelBt,.againBt").on("click",function(){fish.mPop.close(),fish.one(".fail_tips").addClass("none"),fish.one(".email_form").removeClass("none")}),fish.one(".saveBt").on("click",function(){if(a(),!fish.one(this).hasClass("busy")&&!fish.one("#uname").hasClass("err_input")&&!fish.one("#uemail").hasClass("err_input")){var e=fish.one(".email_pbt").attr("a-url")+"&email="+fish.one("#uemail").val()+"&startTime="+fish.one("#oneCal").val()+"&addDays="+fish.one("#hidDays").val();fish.ajax({url:e,openType:"post",type:"string",fn:function(e){fish.one(".saveBt").removeClass("busy"),e?fish.mPop.close():(fish.one(".fail_tips").removeClass("none"),fish.one(".email_form").addClass("none"))}})}}),fish.one(".content").delegate(".print_link","click",function(e){var t=fish.getTarget(e),s=fish.one(t).attr("_href")+"&startTime="+fish.one("#oneCal").val()+"&addDays="+fish.one("#hidDays").val();window.open(s)}),fish.all("#uname,#uemail").on("focus",function(){fish.one(this).removeClass("err_input").next().html("remove")}),fish.one(".content").delegate(".email_pbt","click",function(){fish.all("#uname,#uemail").val("").removeClass("err_input").next().html("remove"),fish.one(".email_form").removeClass("none"),fish.one(".fail_tips").addClass("none"),fish.mPop({title:"&nbsp;",content:fish.one(".email_pop"),dragable:!1,width:405})}),fish.one(".top_link").on("click",function(){window.scrollTo(0,0)}),h();var A=function(e){var t,s,i,a,n,o=fish.all(e.elem);s=e.title?e.title:document.title+"@同程旅游",t=e.url?e.url:document.location.href,i=e.summary?e.summary:"",a=e.wxurl?e.wxurl:document.location.href,n=e.pic?e.pic:"",fish.all("a",o).on("click",function(){var e=this.getAttribute("share-data");E[e](t,s,i,n,a)})},E={sina:function(e,t,s,i,a){m("http://v.t.sina.com.cn/share/share.php?",e,t,s,i,a)},weixin:function(e,t,s,i,a){v("http://js.40017.cn/cn/min/??/cn/c/c/qrcode.js",function(){if(fish.dom(".tc_show_wx_w2m"))fish.mPop({content:fish.one(".tc_show_wx_w2m"),width:274,height:320});else{var e=document.createElement("div");e.className="tc_show_wx_w2m",e.innerHTML='<p class="tc_weixin_pop_head"><span>分享到微信朋友圈</span><a class="tc_weixin_pop_close">×</a></p><div class="qr_con"></div><div class="tc_weixin_pop_foot">打开微信，点击“发现”，<br>使用“扫一扫”即可将网页分享至朋友圈。</div>',document.body.appendChild(e),fish.one(".tc_show_wx_w2m .tc_weixin_pop_close").on("click",function(){fish.mPop.close()}),fish.mPop({content:fish.one(".tc_show_wx_w2m"),width:274,height:320,afterOpen:function(){var e=new QRCode(fish.dom(".tc_show_wx_w2m .qr_con"),{width:200,height:200});e.makeCode(a)}})}},!0)},qzone:function(e,t,s,i){m("http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?",e,t,s,i)}};fish.admin.config({mPage:{v:"0.5.6",g:2016022501,css:1}}),fish.admin.config({mLogin:{v:"2.0",css:1,g:2012112073101}});var H=fish.one("#visitorsCommElem"),z=H.attr("attr-url");fish.one("#ctrlPager").delegate("a","click",function(e){var t=fish.getTarget(e);fish.one(t).hasClass("currentpage")||fish.one(t).hasClass("prevGrey")||fish.one(t).hasClass("nextGrey")||window.scrollTo(0,fish.one(".reviews").offset().top-fish.one(".f_tit").height())}).delegate(".page_btn","click",function(){window.scrollTo(0,fish.one(".reviews").offset().top-fish.one(".f_tit").height())}),window.getPrice=k,window.itinerary=D,fish.ready(function(){O(),k(),fish.all(".description span").css("font-family:'microsoft yahei'"),fish.all(".mSlider_con ul li img").lazyLoad({attr:"data-img-src",preSpace:50}),fish.one("#visaCommElem").length<=0&&fish.all(".f_tit li").each(function(e){var t=fish.one(e).attr("attr-id");3==t&&fish.one(e).html("remove")}),w(),f(),x(),D(),P(),T(),j(),b(),o(),L(),N(),F.usi?c(fish.one("#collectLine").attr("attr-url"),"searchnew"):"";var e=fish.one("#ip").attr("val"),t=fish.cookie.get("us","userid"),s=fish.one("#CurrentUrl").attr("val"),i=fish.one("#shareText").attr("val"),a=fish.one("#sharesummary").attr("val"),n="";n=t?s+"?refid="+t+"&Ip="+e:s,A({elem:fish.one("#shareContent .share_d"),url:n,title:i,summary:a,wxurl:n})}),fish.loaded(function(){b()})}(),fish.admin.config({Calendar:{v:"0.3",css:"0.3",g:2015032101}}),!function(e,t,s){var i=i||{};e.lang.extend(i,{init:function(){this.bindEvent()},bindEvent:function(){function t(t){var s=e.one(this),i=s.val();s&&s[0]&&i.length&&s.removeClass("placeholder")}function s(t){var s=e.one(this),i=s.val();s&&s[0]&&!i.length&&s.addClass("placeholder")}e.all("#TopProductElem .prn-btn").once("jjtxObj",function(){e.one(this).on("click",function(){var t=e.one(this).parent(".p_infro");t=e.one(".pri_d b",t[0]).html(),t=parseInt(t,10),t=isNaN(t)?1:1>t?1:t>999999?999999:t,e.one(".ylc-modal-priceremind #iptPrnPrice").val(t),e.mPop({content:e.one(".pri-rem-notice"),beforeClose:function(){i.$cal.hide()}}),e.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=CruiseHomePageWindowStatistic&value=CutPriceNotifyClick"})})}),e.all(".ylc-modal-priceremind .ylc-m-close").once("jjtxObj",function(){e.one(this).on("click",function(){e.mPop.close()})}),e.all(".ylc-modal-priceremind #iptPrnPrice").once("jjtxObj",function(){function t(t){var s,i=e.one(this);s=parseInt(e.trim(i.val()),10),s=isNaN(s)?1:1>s?1:s>999999?999999:s,i.val(s)}e.one(this).on("change",t).on("blur",t),t.call(this,e.getEvent())}),e.all(".ylc-modal-priceremind #iptPrnStartTime").once("jjtxObj",function(){var t=new Date,s=new Date;s=new Date(s.setFullYear(s.getFullYear()+5)),e.require("Calendar",function(){var a=new e.Calendar({skin:"white",startDate:e.parseTime(t),endDate:e.parseTime(s)});i.$cal=a,e.one(".ylc-modal-priceremind #iptPrnStartTime").on("click",function(){e.one(this).addClass("ylc-calendar-target");var i=e.trim(e.one(".ylc-modal-priceremind #iptPrnEndTime").val());i.length&&(s=e.parseDate(i,{days:-1})),a.pick({elem:this,currentDate:t,startDate:new Date,endDate:s,fn:function(t,i,n,o,l){e.one(this.elem).removeClass("placeholder"),e.one(".ylc-modal-priceremind #iptPrnEndTime").removeClass("placeholder");var r=e.parseTime(e.one(l).val(),{days:1}),c=new Date;s=new Date(c.setFullYear(c.getFullYear()+5)),a.pick({elem:e.dom(".ylc-modal-priceremind #iptPrnEndTime"),startDate:r,currentDate:[r],endDate:s})}})}),e.one(".ylc-modal-priceremind #iptPrnEndTime").on("click",function(){e.one(this).addClass("ylc-calendar-target");var i=e.trim(e.one(".ylc-modal-priceremind #iptPrnStartTime").val());i.length&&(t=e.parseDate(i,{days:1}));var n=new Date;s=new Date(n.setFullYear(n.getFullYear()+5)),a.pick({elem:this,startDate:t,endDate:s,fn:function(t,s,i,a,n){e.one(this.elem).removeClass("placeholder")}})})})}),e.all(".ylc-modal-priceremind #iptPrnName").once("jjtxObj",function(){function i(){var e=/^[^@\/\'\\\"#$%&\^\*\(!\^\*\;\:\>\<\-\|]+$/;return e.test(arguments[0])}e.one(this).on("focus",t).on("input",t).on("keydown",t).on("keyup",t).on("blur",s).on("change",s).on("change",function(){var t=e.trim(e.one(this).val()||"");e.one(this).removeClass("error"),t.length&&(t.length>30||!i(t))&&e.one(this).addClass("error")})}),e.all(".ylc-modal-priceremind #iptPrnPhone").once("jjtxObj",function(){function i(){var e=/^1[34578][0-9]\d{8,8}$/;return e.test(arguments[0])}e.one(this).on("focus",t).on("input",t).on("keydown",t).on("keyup",t).on("blur",s).on("change",s).on("change",function(){var t=e.trim(e.one(this).val()||"");e.one(this).removeClass("error"),e.one(".prn-err",this.parentNode).css("display:none;"),t.length&&t.length<31&&i(t)||(e.one(this).addClass("error"),e.one(".prn-err",this.parentNode).css("display:block;"))})}),e.one(".pri-rem-notice .ylc-m-ok").once("jjtxObj",function(){e.one(this).on("click",function(){i.submitFn.call(i)})}),e.one(".pri-rem-ok .ylc-m-ok").once("jjtxObj",function(){e.one(this).on("click",function(){e.mPop.close()})}),e.one(".pri-rem-fail .ylc-m-ok").once("jjtxObj",function(){e.one(this).on("click",function(){e.mPop.close(),e.mPop({content:e.one(".pri-rem-notice"),beforeClose:function(){i.$cal.hide()}})})}),e.one(".pri-rem-notice").once("jjtxObj",function(){e.one(this).on("click",function(t){var s=e.one(e.getTarget(t)),a=!1,n=i.$cal;a=a||s.hasClass("ylc-calendar-target"),a=a||s.hasClass("calendar-panel"),a=a||s.parent(".calendar-panel").length>0,a=a&&s.parent(".ylc-modal-priceremind").length>0,!a&&n&&n.hide&&n.hide()})})},submitFn:function(){function t(){var e=/^[^@\/\'\\\"#$%&\^\*\(!\^\*\;\:\>\<\-\|]+$/;return e.test(arguments[0])}function s(){var e=/^1[34578][0-9]\d{8,8}$/;return e.test(arguments[0])}var i="expectedPrice={0}&startDate={1}&endDate={2}&customerName={3}&customerMobile={4}",a=[],n=!0,o=e.one(".ylc-modal-priceremind #iptPrnPrice").val();return o=isNaN(o)?1:1>o?1:o>999999?999999:o,a.push(o),o=e.trim(e.one(".ylc-modal-priceremind #iptPrnStartTime").val()),a.push(o),o=e.trim(e.one(".ylc-modal-priceremind #iptPrnEndTime").val()),a.push(o),o=e.trim(e.one(".ylc-modal-priceremind #iptPrnName").val()),e.one(".ylc-modal-priceremind #iptPrnName").removeClass("error"),o.length?o.length>30||!t(o)?(n=!1,e.one(".ylc-modal-priceremind #iptPrnName").addClass("error"),a.push("-")):a.push(o):a.push("-"),o=e.trim(e.one(".ylc-modal-priceremind #iptPrnPhone").val()),e.one(".ylc-modal-priceremind #iptPrnPhone").removeClass("error"),e.one(".prn-err",e.dom(".ylc-modal-priceremind #iptPrnPhone").parentNode).css("display:none;"),o.length&&o.length<31&&s(o)?a.push(o):(n=!1,e.one(".ylc-modal-priceremind #iptPrnPhone").addClass("error"),e.one(".prn-err",e.dom(".ylc-modal-priceremind #iptPrnPhone").parentNode).css("display:block;"),a.push("-")),n?(this.submitFn.ajaxObj&&this.submitFn.ajaxObj.abort(),void(this.submitFn.ajaxObj=e.ajax({url:"/youlun/CruiseRequireOrder/FinalPageRequireOrder.ashx",openType:"post",data:i.format.apply(i,a),fn:function(t){e.mPop.close(),"suc"==t&&e.mPop({content:e.one(".pri-rem-ok")}),t.indexOf("fail")>=0&&e.mPop({content:e.one(".pri-rem-fail")})},err:function(){e.mPop.close(),e.mPop({content:e.one(".pri-rem-fail")})}}))):!1}}),e.ready(function(){i.init()})}(fish,window,document),function(e){function t(e){var t={showCon:fish.one(""),shadowBg:fish.one(""),clickBgClose:!0,closeBut:fish.one(""),closeAfterFn:function(e,t){},showBeforeFn:function(e,t){}};fish.lang.extend(t,e);var s=t,i={show:function(){s.showBeforeFn(s.showCon,s.shadowBg),s.shadowBg.removeClass("none"),s.showCon.removeClass("none")},close:function(){s.shadowBg.addClass("none"),s.showCon.addClass("none"),s.closeAfterFn(s.showCon,s.shadowBg)}};return s.closeBut.on("click",function(){i.close()}),s.clickBgClose===!0&&s.shadowBg.on("click",function(){i.close()}),i}function s(e){if(!e||!e[0])return!1;var t=e.width(),s=e.height();e.css("position:fixed;left:50%;top:50%;marginLeft:"+-t/2+"px;marginTop:"+-s/2+"px;")}fish.admin.config({Calendar:{v:"0.3",css:"0.3",g:2015032101}});var i={init:function(){this.formConBox=t({showCon:fish.one(".tj_con_box"),shadowBg:fish.one(".tj_shadow"),closeBut:fish.one(".tj_con_box .s_close"),showBeforeFn:function(e,t){s(e)}}),this.msgForm=t({showCon:fish.one(".tj_alert_box"),shadowBg:fish.one(".tj_shadow"),closeBut:fish.one(".tj_alert_box .alert_close"),showBeforeFn:function(e,t){s(e)}}),this.codeObj.init(),this.bindEvent()},restAllInput:function(){for(var e=fish.all(".dl_tj_cos dl dd input"),t=0,s=e.length;s>t;t++){var i=fish.one(e[t]);i.attr("_placeholder")?i.addClass("place_holder").val(i.attr("_placeholder")):i.val("")}fish.one(".dl_tj_cos dl.is_adjust dd span.is_check_adjust").removeClass("is_checked"),fish.one(".dl_tj_cos dl dd input.input_is_adjust").val(0),fish.all(".dl_tj_cos dl dd").removeClass("has_error"),this.codeObj.resetCode()},bindEvent:function(){var e=this,t=fish.one(".dl_tj_cos a.sub_data"),s=fish.all(".dl_tj_cos dl.eve_yusuan dd input,.dl_tj_cos dl.cust_name dd input,.dl_tj_cos dl.cust_mobile dd input,.dl_tj_cos dl.code dd input"),a=fish.one(".dl_tj_cos dl.is_adjust dd span.is_check_adjust"),n=fish.one(".dl_tj_cos dl dd input.input_is_adjust");this.inputObj.bindPlaceHolder(s),this.inputObj.filterKeyUp(fish.one(".dl_tj_cos dl.travel_num dd input"),"[^\\d]",3),this.inputObj.filterKeyUp(fish.one(".dl_tj_cos dl.eve_yusuan dd input"),"[^\\d]",13),t.on("click",function(){return t.hasClass("sub_no_act")?!1:void(e.subCheck()&&(fish.one("#hidFinalLineId").val(fish.one("#HidLineid").val()),t.addClass("sub_no_act").html("提交中..."),fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx",data:"action=SpecialReserOrder&"+e.getInputDataToStr(),openType:"post",type:"json",fn:function(s){if(t.removeClass("sub_no_act").html("提交"),!s)return e.alertMsgFn(0),!1;switch(s.ResultCode){case-100:i.msgCtrl.show(fish.dom(".dl_tj_cos dl.code dd input"),"验证码输入错误！");break;case 1:e.alertMsgFn(1),e.restAllInput();break;case 8:e.alertMsgFn(2),e.restAllInput();break;default:e.alertMsgFn(0)}}})))}),fish.one(".tj_alert_box .s_con").delegate(".close_but","click",function(){e.msgForm.close()}),fish.one(".price_btn .but_tjyy").on("click",function(){var t=fish.dom(".ylc-nav .ylc-special-price");if(t)return t.click(),e.statcClick(),!1;var s=fish.one(".dl_tj_cos dl.eve_yusuan dd input"),i=fish.one("#hidRate").val();s.hasClass("place_holder")&&s.val()==s.attr("_placeholder")&&s.val(i),s.attr("_placeholder",i),e.formConBox.show(),e.statcClick()}),a.on("click",function(){a.hasClass("is_checked")?(a.removeClass("is_checked"),n.val(0)):(a.addClass("is_checked"),n.val(1))}),fish.all(".dl_tj_cos dl.cust_name dd input,.dl_tj_cos dl.cust_mobile dd input,.dl_tj_cos dl.code dd input").on("focus",function(){e.msgCtrl.close(this)})},inputObj:{bindPlaceHolder:function(e){return e&&e[0]?void e.on("focus",function(){var e=fish.one(this);thisVal=e.val(),thisPlaceHolder=e.attr("_placeholder"),thisVal==thisPlaceHolder&&e.hasClass("place_holder")&&e.val("").removeClass("place_holder")}).on("blur",function(){var e=fish.one(this);thisVal=e.val(),thisPlaceHolder=e.attr("_placeholder"),thisVal.length<=0&&e.val(thisPlaceHolder).addClass("place_holder")}):!1},filterKeyUp:function(e,t,s){if(!(e&&e[0]&&t&&s))return!1;var i=new RegExp(t,"g");e.on("keyup",function(){var e=fish.one(this),t=e.val().substr(0,s).replace(i,"");e.val(t)})}},msgCtrl:{show:function(e,t){return!e||!t||t.length<=0?!1:($parent=fish.one(e).parent("dd"),$parent.addClass("has_error"),void fish.one(".err_msg",$parent[0]).html("<i></i>"+t))},close:function(e){return e?($parent=fish.one(e).parent("dd"),$parent.removeClass("has_error"),void fish.one(".err_msg",$parent[0]).html("<i></i>")):!1}},codeObj:{init:function(){this.getCodeFlag=!0,this.bindEvent()},bindEvent:function(){var e=this;fish.one(".dl_tj_cos dl.code dd span.get_code").on("click",function(){i.checkObj.checkPhone()&&e.getCodeFlag===!0&&(e.getCode(),e.timerCode(6e4))})},getCode:function(){fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx",data:"action=GetSmsAuthCode&custMobile="+fish.one(".dl_tj_cos dl.cust_mobile dd input").val(),fn:function(){}})},timerCode:function(e){var t=this,s=fish.one(".dl_tj_cos dl.code dd span.get_code"),i=fish.one("span i",s[0]),a=e||3e4,n=500;this.timerD=setInterval(function(){0>=a&&(t.getCodeFlag=!0,s.removeClass("no_active"),clearInterval(t.timerD)),i.html(Math.round(a/1e3)),a-=n},n),i.html(Math.round(a/1e3)),this.getCodeFlag=!1,s.addClass("no_active")},resetCode:function(){var e=fish.one(".dl_tj_cos dl.code dd span.get_code"),t=fish.one("span i",e[0]);this.getCodeFlag=!0,e.removeClass("no_active"),t.html("0"),this.timerD&&clearInterval(this.timerD)}},subCheck:function(){return this.checkObj.checkName()&this.checkObj.checkPhone()&this.checkObj.checkCode()},checkObj:{checkName:function(){var e=fish.one(".dl_tj_cos dl.cust_name dd input"),t=/^[^@\/\'\\\"#$%&\^\*\(!\^\*\;\:\>\<\-\|]+$/,s=fish.trim(e.val()),a=fish.trim(e.attr("_placeholder"));return s=e.hasClass("place_holder")&&s==a?"":s,s.length<=0?(i.msgCtrl.show(e[0],"请填写联系人姓名！"),!1):t.test(s)?(i.msgCtrl.close(e[0]),!0):(i.msgCtrl.show(e[0],"姓名中包含非法字符！"),!1)},checkPhone:function(){var e=fish.one(".dl_tj_cos dl.cust_mobile dd input"),t=/^(13[0-9]|15[0-9]|17[0-9]|18[0-9]|147)\d{8}$/,s=fish.trim(e.val()),a=fish.trim(e.attr("_placeholder"));return s=e.hasClass("place_holder")&&s==a?"":s,s.length<=0?(i.msgCtrl.show(e[0],"请输入手机号！"),!1):t.test(s)?(i.msgCtrl.close(e[0]),!0):(i.msgCtrl.show(e[0],"请输入正确的手机号！"),!1)},checkCode:function(){var e=fish.one(".dl_tj_cos dl.code dd input"),t=fish.trim(e.val()),s=fish.trim(e.attr("_placeholder"));return t=e.hasClass("place_holder")&&t==s?"":t,t.length<=0?(i.msgCtrl.show(e[0],"请输入验证码！"),!1):(i.msgCtrl.close(e[0]),!0)}},getInputDataToStr:function(){for(var e=fish.all(".dl_tj_cos input"),t="",s=0,i=e.length;i>s;s++){var a=fish.one(e[s]),n=a.attr("_placeholder"),o=a.hasClass("place_holder")&&a.val()==n?"":a.val(),l=a.attr("name");t+="&"+l+"="+encodeURIComponent(fish.trim(o))}return t.substr(1)},alertMsgFn:function(e){var t="";switch(e){case 2:t='<h4 class="h4_txt">亲~您已经提交过哦</h4>					        <p class="ps">客服将尽快联系您<br/>请不要拒接0512开头的电话</p>					        <span class="msg_dbg success_sbg"></span>					        <span class="close_but">关闭</span>';break;case 0:t='<h4 class="h4_txt">提交失败！</h4>					        <span class="msg_dbg fail_sbg"></span>					        <span class="close_but">关闭</span>';break;case 1:t='<h4 class="h4_txt">通知预约成功！</h4>					        <p class="ps">客服将尽快联系您<br/>请不要拒接0512开头的电话</p>					        <span class="msg_dbg success_sbg"></span>					        <span class="close_but">关闭</span>'}t.length>=0&&(fish.one(".tj_alert_box .s_con").html(t),this.formConBox.close(),this.msgForm.show())},statcClick:function(){var e=fish.one("#hidIsFinalPage").val();fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx?action=SpecialReserClick&isFinal="+e,fn:function(){}})}};fish.one(document).ready(function(){i.init()})}(window),function(e){function t(e,t){if(t.k&&(t.k=decodeURIComponent(t.k)),t.ct&&(t.ct=decodeURIComponent(t.ct)),!e||!e.trim())return!1;var s="";for(key in t)null!==t[key]&&void 0!==t[key]&&""!==t[key]&&(s+="|*|"+key+":"+t[key]);try{s.length>0&&(s+="|*|"),_tcTraObj._tcTrackEvent("search","/cruises/detail",e,s);
}catch(i){}}function s(e){var s={type:1,lable:"",value:{}};fish.lang.extend(s,e);var i=s.lable.replace(/\//g,"_");1==s.type?fish.cookie.set(i,1):2==s.type&&1==fish.cookie.get(i)&&(fish.cookie.remove(i),t(s.lable,s.value))}String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var i=fish.one("#HidLineid").val();s({lable:"/show",type:2,value:{resId:i}}),fish.all(".ele_topDom .link_order,.fix_order .fix_order_link").each(function(e,s){e.index=s,fish.one(e).on("click",function(e){t("/book",{pos:this.index-0+1,pjId:"2007",resId:i})})}),e.searchTrackEvent=t,e.trackEventUseCookie=s}(window),function(){function e(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),s=window.location.search.substr(1).match(t);return null!=s?unescape(s[2]):null}function t(e){var t="";for(var s in e)t+=s+"="+e[s]+"&";return t.substring(0,t.length-1)}function s(e,t){if("object"==typeof e&&"object"==typeof t)for(var s in t)e[s]=t[s];return e}function i(){_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.encode=function(e){var t,s,i,a,n,o,l,r="",c=0;for(e=_utf8_encode(e);c<e.length;)t=e.charCodeAt(c++),s=e.charCodeAt(c++),i=e.charCodeAt(c++),a=t>>2,n=(3&t)<<4|s>>4,o=(15&s)<<2|i>>6,l=63&i,isNaN(s)?o=l=64:isNaN(i)&&(l=64),r=r+_keyStr.charAt(a)+_keyStr.charAt(n)+_keyStr.charAt(o)+_keyStr.charAt(l);return r},this.decode=function(e){var t,s,i,a,n,o,l,r="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)a=_keyStr.indexOf(e.charAt(c++)),n=_keyStr.indexOf(e.charAt(c++)),o=_keyStr.indexOf(e.charAt(c++)),l=_keyStr.indexOf(e.charAt(c++)),t=a<<2|n>>4,s=(15&n)<<4|o>>2,i=(3&o)<<6|l,r+=String.fromCharCode(t),64!=o&&(r+=String.fromCharCode(s)),64!=l&&(r+=String.fromCharCode(i));return r=_utf8_decode(r)},_utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",s=0;s<e.length;s++){var i=e.charCodeAt(s);128>i?t+=String.fromCharCode(i):i>127&&2048>i?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t},_utf8_decode=function(e){for(var t="",s=0,i=c1=c2=0;s<e.length;)i=e.charCodeAt(s),128>i?(t+=String.fromCharCode(i),s++):i>191&&224>i?(c2=e.charCodeAt(s+1),t+=String.fromCharCode((31&i)<<6|63&c2),s+=2):(c2=e.charCodeAt(s+1),c3=e.charCodeAt(s+2),t+=String.fromCharCode((15&i)<<12|(63&c2)<<6|63&c3),s+=3);return t}}function a(){var t="";return e("lid")?(t=e("lid"),fish.cookie.set({name:"cruiseSearchLid",value:t}),t):t=fish.cookie.get("cruiseSearchLid")?fish.cookie.get("cruiseSearchLid"):"75"}function n(){var e=fish.one(".hotSearch").width(),t=675-e-82-25;fish.one(".searchinput").css({width:t+"px;"})}function o(){var e=fish.trim(fish.one("#search").val()),t=fish.one("#search").attr("attr-value"),s=fish.one(".searchConditonLab").attr("data-lccity");if(lcCityIdStr=s?"&lc="+s:"",e==t||""==e)return location.href="/youlun/cruise-line-0-0-0-0-0-0-0-0-0-0.html"+lcCityIdStr,!1;var i=(new Date).getTime(),a=new Date("2016/05/21").getTime();return a>i&&"%E6%9C%89%E7%88%B1%E2%9D%A4%E5%87%BA%E5%8F%91"==encodeURIComponent(e)?(fish.one(".tehui i").removeClass("none"),fish.one(".tehui").attr("attr-chiose",1),void f()):1==fish.all(".autoComplete a.a_links").length?void(location.href=fish.one(".autoComplete a").attr("href")):void(location.href="/youlun/cruise-line-0-0-0-0-0-0-0-0-0-0.html&dest="+e+lcCityIdStr)}function l(e){this.ajaxObj&&this.ajaxObj.abort(),this.ajaxObj=fish.ajax({url:"/youlun/AjaxcallTravel.aspx?type=GetFuzzySearch&lid="+w+"&dest="+e+"&cityId="+fish.one(".searchConditonLab").attr("data-lccity"),type:"json",fn:function(t){var s="",i="",a="",n="",o="";if(t)if(0==t.FuzzySearchInfos.length)fish.one(".autoComplete").html("").addClass("none"),searchTrackEvent("/sbox/ac",{k:encodeURIComponent(fish.one("#search").val()),rc:0});else{for(var l=t.FuzzySearchInfos,c=0,h=l.length;h>c;c++){var d=new RegExp(decodeURIComponent(e),"g"),f=l[c].Name.replace(d,'<span class="c_fa7d29">$&</span>');switch(l[c].GroupType){case 0:i+='<a class="a_links" _showName="'+l[c].Name+'" href="'+l[c].Url+'">'+f+"</a>";break;case 1:a+='<a class="a_links" _showName="'+l[c].Name+'" href="'+l[c].Url+'">'+f+"</a>";break;case 2:n+='<a class="a_links" _showName="'+l[c].Name+'" href="'+l[c].Url+'">'+f+"</a>";break;default:o+='<a class="a_links" _showName="'+l[c].Name+'" href="'+l[c].Url+'">'+f+"</a>"}}i&&i.length>0&&(s+=' <div class="show_cons"><span class="tip_span">航线</span>'+i+"</div>"),a&&a.length>0&&(s+=' <div class="show_cons"><span class="tip_span">国家/城市</span>'+a+"</div>"),n&&n.length>0&&(s+=' <div class="show_cons"><span class="tip_span">邮轮公司/船队</span>'+n+"</div>"),o&&o.length>0&&(s+=' <div class="show_cons"><span class="tip_span">其他</span>'+o+"</div>"),fish.one(".autoComplete").html("").html(s),fish.all(".autoComplete a").on("click",function(){var e=fish.one(this).attr("href"),t=encodeURIComponent(fish.one(this).attr("_showName"));r(e,t)}),fish.all(".autoComplete a").each(function(e,t){this.index=t,fish.one(this).on("click",function(e){var t=this;fish.one(this);searchTrackEvent("/sbox/ac/click",{k:encodeURIComponent(fish.one("#search").val()),ct:encodeURIComponent(fish.one(this).attr("_showName")),pos:t.index+1,pjId:"2007",jpTp:1})})})}},err:function(){}})}function r(e,t){fish.ajax({url:"/youlun/AjaxcallTravel.aspx?type=SaveFuzzyClick&lid="+w+"&pageUrl="+e+"&staType=5&pageDis=1&remark="+t,type:"json",fn:function(){}})}function c(e){fish.all(".search_value").each(function(){fish.one(this).attr("typeid")==e&&fish.one(this).html("remove")})}function h(){fish.mPop({content:fish.one("#inline_example_load"),top:200})}function d(){var e=fish.one("#mobile").val()||"",t=fish.one("#criteoId1").val()||"",s=fish.one("#criteoId2").val()||"",i=fish.one("#criteoId3").val()||"";window.criteo_q=window.criteo_q||[],window.criteo_q.push({event:"setAccount",account:21750}),""!=e&&window.criteo_q.push({event:"setHashedEmail",email:e}),window.criteo_q.push({event:"setSiteType",type:"d"},{event:"viewList",item:[t,s,i]})}function f(){var e=fish.one(".searchConditonLab"),t=e.attr("data-producttypeid"),s=e.attr("data-hxid"),i=e.attr("data-hxcname"),a=e.attr("data-companyid"),n=e.attr("data-cruiseid"),o=e.attr("data-harbourid"),l=e.attr("data-dateid"),r=e.attr("data-daynumid"),c=e.attr("data-themeid"),f=e.attr("data-pctabid"),v=e.attr("data-holidayid"),_="0",g="0",C="0",y="0",b="0",w=fish.one("#baochuan").attr("attr-chiose"),x="0",T=fish.one(".tehui").attr("attr-chiose"),j="0",I="0",P="0",L="0",O="0",M="0",N="",R=fish.one(".pre_tc").attr("attr-chiose");lccityid=e.attr("data-lccity"),destWord=e.attr("data-dest")?"&dest="+encodeURIComponent(e.attr("data-dest")):"",lcCityIdStr=lccityid?"&lc="+lccityid:"";var F={};F.HxId=s,F.HxCid=i,F.CompanyId=a,F.CruiseId=n,F.HarbourId=o,F.DateId=l,F.DayNum=r,F={SearchCondition:encodeURIComponent(JSON.stringify(F))};var B=fish.one("#bqContent").attr("attr-url");fish.all(".cond_tab_filterbox a").each(function(){if(fish.one(this).hasClass("active")){var e=fish.one(this).html();e.indexOf("综合排序")>=0?_="1":e.indexOf("满意度")>=0?g="2":e.indexOf("价格")>=0?C=0==fish.one(this).attr("price_info")?"2":"1":e.indexOf("航期")>=0&&(b=0==fish.one(this).attr("date_info")?"2":"1")}}),N=w+x+T+j+I+P+L+O+M,N=parseInt(N,2),B+="&producttypeid="+t+"&hxid="+s+"&hxcid="+i+"&companyid="+a+"&cruiseid="+n+"&harbourid="+o+"&dateid="+l+"&sortManyiType="+g+"&sortPriceType="+C+"&sortCmCountType="+y+"&sortSailDateType="+b+"&dayNum="+r+"&themeId="+c+"&pctabid="+f+"&tagNum="+N+"&isTCSpecialLine="+R+"&holidayId="+v+"&dest="+encodeURIComponent(k)+"&lccityid="+lccityid,fish.all("#pageCountent").mPage({startWithAjax:!0,pageNO:"pageNum",beforeAjaxFn:function(){""!=fish.trim(fish.one("#bqContent").html())&&h()},callback:function(e,h){function f(){for(var e=S.year,l=S.holidayObj,h="<div class='rqsliderCon'><span class='sliderBtn prevBtn prevBtnN none'></span><span class='sliderBtn nextBtn none'></span><div class='rqslider' attr-left='0'>",d=["1月|01","2月|02","3月|03","4月|04","5月|05","6月|06","7月|07","8月|08","9月|09","10月|10","11月|11","12月|12"],f=0,p=e.length;p>f;f++){for(var u='<div class="year_sty"><h4 class="year_tit">'+e[f]+"年</h4>{{month}}</div>",m="",v=0,_=d.length;_>v;v++){var g=d[v].split("|");m+='<a class="link_sty linksty link_none" href="/youlun/cruise-line-'+s+"-"+a+"-0-"+e[f]+g[1]+"-"+o+"-"+i+"-"+c+"-"+r+"-"+n+"-"+t+"-0.html"+destWord+lcCityIdStr+'" _dValue="'+e[f]+g[1]+'" inputValue="'+e[f]+"年"+g[1]+'月">'+g[0]+"</a>"}if(l[e[f]])for(var C=0,y=l[e[f]].length;y>C;C++){var b=l[e[f]][C];m+="<a class='link_sty linksty"+(parseInt(b.Id)>0?" ":" link_none")+"' href='/youlun/cruise-line-"+s+"-"+a+"-0-0-"+o+"-"+i+"-"+c+"-"+r+"-"+n+"-"+t+"-"+b.Id+".html"+destWord+lcCityIdStr+"'>"+b.Name+"</a>"}u=u.replace("{{month}}",m),h+=u}return h+="</div></div>"}if(e){if(e.LineMessageMod){for(var v=0,_=0,g=[],C=0,y=e.LineMessageMod.length;y>C;C++)e.LineMessageMod[C].IsTCRecommend&&1==e.LineMessageMod[C].IsTCRecommend&&(v++,g.push(e.LineMessageMod[C].LineId));window.isRunDSP||(window.isRunDSP=!0,dsp&&dsp(g.join(","))),g=[],_=e.TotalLineCount-v,_=_&&_>0?_:0,window.showTrackEvent?h>1&&searchTrackEvent("/page",{k:encodeURIComponent(fish.one(".searchConditonLab").attr("data-dest")),page:h}):(window.showTrackEvent=!0,searchTrackEvent("/show",{k:encodeURIComponent(k),rc:_})),trackEventUseCookie({lable:"/sbox/k",type:2,value:{k:encodeURIComponent(fish.one(".searchConditonLab").attr("data-dest")),rc:_}}),trackEventUseCookie({type:2,lable:"/filter",value:{k:encodeURIComponent(fish.one(".searchConditonLab").attr("data-dest")),rc:fish.one(".cond_tab_filterbox .tehui").attr("attr-chiose")-0==1?e.YouhuiCount:_}})}fish.one("#bqContent").css("margin:0;width:auto;height:auto;background:none;");var b="",w=e.CruiseSearchStartCityContinent,x=e.SailDateByYearMod,T=e.TotalPageNum,j=[];""==fish.one("#stateName").html()&&(b='{{for(var i = 0,j = it.length;i < j; i++){ }}                                        <a class="stateName{{? i == 0}} stateNameAt{{?}}">{{=it[i].ContinentName}}</a>                                    {{}}}                                    <div class="data_pop" id="cityType">                                        {{for(var i = 0,j = it.length;i < j; i++){ }}                                            <div class="data_main {{? i != 0}}none{{?}}">                                                {{for(var n = 0,m = it[i].StartCities.length;n < m; n++){ }}                                                    <a title="{{=it[i].StartCities[n].CityName}}" href="/youlun/cruise-line-'+s+"-"+a+"-0-"+l+"-{{=it[i].StartCities[n].CityId}}-"+i+"-"+c+"-"+r+"-"+n+"-"+t+".html"+destWord+lcCityIdStr+'">{{=it[i].StartCities[n].CityName}}</a>                                                {{}}}                                            </div>                                        {{}}}                                    </div>                                    ',fish.one("#stateName").html(fish.template(b,w))),S.year=[],S.holidayObj=[];for(var C=0,I=x.length;I>C;C++){var P={};S.year.push(x[C].Year);for(var L=0,O=x[C].Pm.length;O>L;L++)j.push(x[C].Pm[L].Value);x[C]&&x[C].HolidayList&&x[C].HolidayList[0]&&(P[x[C].Year]=x[C].HolidayList,fish.lang.extend(S.holidayObj,P))}if(""==fish.one(".scut_sty_main").html()&&(fish.one(".scut_sty_main").html(f()),1==fish.all(".year_sty").length?fish.one(".calendar_box .scut_sty .scut_sty_main").css("width:195px;"):fish.one(".calendar_box .scut_sty .scut_sty_main").css("width:391px;"),m(),fish.all(".calendar_box .scut_sty a").each(function(e,t){for(var s=fish.all(".calendar_box .scut_sty a"),i=fish.one(s[t]).attr("_dvalue"),a=0,n=j.length;n>a;a++)i==j[a]&&fish.one(s[t]).removeClass("link_none")}),fish.all(".link_none").attr("href","javascript:void(0);")),fish.dom("body").onclick=function(e){var t=fish.getTarget(e),s=t.className,i=t.parentNode,a=fish.one(t).getParent(".hotCity"),n=fish.one(t).getParent(".history"),o=fish.one(t).getParent(".autoComplete");if(s.indexOf("pack_hx")>-1||s.indexOf("pack_cd")>-1||s.indexOf("pack_ej")>-1||s.indexOf("pack_hs")>-1?(fish.one(t).hasClass("pack_down")?(fish.one(t).removeClass("pack_down").html("收起<em></em>"),fish.one("dd",i).removeClass("hidden_dd")):(fish.one(t).addClass("pack_down").html("更多<em></em>"),fish.one("dd",i).addClass("hidden_dd")),fish.one(".calendar_box .scut_sty").addClass("none"),fish.one(".moremonth").removeClass("more")):s.indexOf("pack_cs")>-1?(fish.one(t).hasClass("pack_down")?(fish.one(t).removeClass("pack_down").html("收起<em></em>"),fish.one("dd",i).removeClass("hidden_dd"),fish.all(".stateName").length>1&&(fish.one("#cityName").addClass("none"),fish.one("#stateName").removeClass("none"))):(fish.one(t).addClass("pack_down").html("更多<em></em>"),fish.one("dd",i).addClass("hidden_dd"),fish.one("#cityName").removeClass("none"),fish.one("#stateName").addClass("none")),fish.one(".calendar_box .scut_sty").addClass("none"),fish.one(".moremonth").removeClass("more")):s.indexOf("calendar_box")>-1||s.indexOf("moremonth")>-1||s.indexOf("year_tit")>-1||s.indexOf("year_sty")>-1||s.indexOf("sliderBtn")>-1||s.indexOf("link_none")>-1?(fish.one(".calendar_box .scut_sty").removeClass("none"),fish.one(".moremonth").addClass("more")):(fish.one(".calendar_box .scut_sty").addClass("none"),fish.one(".moremonth").removeClass("more")),s.indexOf("autoComplete")>-1||o.length>0?fish.one(".autoComplete").removeClass("none"):fish.one(".autoComplete").addClass("none"),s.indexOf("hotCity")>-1||a.length>0?(fish.one(".hotCity ").removeClass("none"),n.length>0&&"A"==t.tagName.toUpperCase()&&(fish.one(".hotCity ").addClass("none"),fish.one(".autoComplete").removeClass("none"))):fish.one(".hotCity ").addClass("none"),s.indexOf("searchinput")>-1){var l=fish.trim(fish.one("#search").val()),r=fish.one("#search").attr("attr-value");l==r||""==l?(fish.one("#search").val(""),fish.one(".hotCity").removeClass("none"),fish.one(".autoComplete").addClass("none")):(fish.one(".hotCity").addClass("none"),fish.one(".autoComplete").removeClass("none"))}},fish.one("body").on("mouseover",function(e){var t=fish.getTarget(e),s=t.className,i=t.parentNode;s.indexOf("ts_x")>-1?(fish.one(t).removeClass("pack_down"),fish.one("#dayType").removeClass("none"),fish.one(".pack_lx").addClass("pack_down"),fish.one("#productType").addClass("none")):s.indexOf("lx_x")>-1?(fish.one(t).removeClass("pack_down"),fish.one("#productType").removeClass("none"),fish.all("#productType a").length<2,fish.one(".pack_ts").addClass("pack_down"),fish.one("#dayType").addClass("none")):s.indexOf("data_pop")>-1||s.indexOf("data_top")>-1||s.indexOf("data_main")>-1||i.className.indexOf("data_main")>-1?"dayType"==t.id?(fish.one(t).removeClass("pack_down"),fish.one("#dayType").removeClass("none")):"productType"==t.id&&(fish.one(t).removeClass("pack_down"),fish.one("#productType").removeClass("none")):(fish.all(".pack_ts,.pack_lx").addClass("pack_down"),fish.all("#dayType,#productType").addClass("none"))}),fish.all(".stateName").each(function(e,t){fish.one(this).on("click",function(){var e=fish.all(".stateName"),s=fish.all("#stateName .data_main");e.removeClass("stateNameAt"),s.addClass("none"),fish.one(e[t]).addClass("stateNameAt"),fish.one(s[t]).removeClass("none")})}),""!=fish.trim(fish.one("#bqContent").html())){var M=fish.one(".mainLeft").offset().top;window.scrollTo(0,M),fish.require("mPop",function(){fish.mPop.close()})}if(e&&e.LineMessageMod&&e.LineMessageMod.length>0){var N=p(e);fish.one("#bqContent").html(N),fish.all(".line_info .icon_bc").hover(function(){fish.one(".bc_tcW",fish.one(this)).removeClass("none")},function(){fish.one(".bc_tcW",fish.one(this)).addClass("none")}),D(fish.all("#bqContent .line_info .tit a"),P),D(fish.all("#bqContent .line_info .yhmore"),P),D(fish.all("#bqContent .line_info .linebtn"),P),fish.all(".map img").on("mouseover",function(){var e=fish.one(this).offset(),t=e.top,s=e.left,i=fish.one(this).width(),a=fish.one(this).attr("src");a.indexOf("gif")<0&&(fish.one("#Popview1").removeClass("none").css("top:"+t+"px;left:"+(i+s+10)+"px;"),fish.one("#Popview1 img").attr("src",a))}).on("mouseout",function(){fish.one("#Popview1").addClass("none")}),fish.one(".myline em").html(e.TotalLineCount+"条"),fish.one(".tehui").removeClass("none"),0==e.YouhuiCount?fish.one(".tehui").addClass("none"):fish.one(".tehui .txt").html(e.YouhuiCount+"条"),d(),fish.all(".rsConList .map img").lazyLoad({attr:"data-nsrc",preSpace:100});var R=fish.cookie.get("searchHistory"),F="";if(k){if(R)if(R.indexOf("||")>-1){var j=R.split("||"),B=j.length;B>=10&&(B=9),F+=k;for(var C=0;B>C;C++)if(F+="||"+j[C],j[C]==k)return}else R!=k&&(F+=k+"||"+R);else F=k;F&&(fish.cookie.set({name:"searchHistory",value:F,path:"/youlun"}),u())}}else if(e.LineMessageMod&&0==e.LineMessageMod.length){fish.one(".myline em").html("0条");var A='<div class="norsBox">											<div class="norsShow"><span class="norsTit">很抱歉，没有找到“'+k+'”相关的航线，您可以尝试其他关键词进行搜索或者<br/>您也可以<a class="ylc-custom" title="" href="http://livechat.ly.com/out/guest?p=6&amp;c=0&amp;pageId=6001&amp;lineId=0&amp;robsid=13162532" target="_blank">联系我们的客服</a>，帮您挑选和预订产品</span></div>											<div class="love"><p>您可能感兴趣的航线</p></div>';fish.ajax({url:"/youlun/AjaxcallTravel.aspx?Type=GetSearchRecLine&hxid="+s+"&pageNum=1",type:"json",fn:function(e){A+=p(e)+"</div>",fish.one("#bqContent").html(A),D(fish.all("#bqContent .line_info .tit a"),P),D(fish.all("#bqContent .line_info .yhmore"),P),D(fish.all("#bqContent .line_info .linebtn"),P)}})}0==T?fish.one("#pageCountent").addClass("none"):fish.one("#pageCountent").removeClass("none")}},preSortTotal:function(e){return e.TotalPageNum},ajaxObj:{type:"json",url:B,fn:function(e){return e}},skip:"true"})}function p(e){function t(e){var t=r[e];return t?'<span class="label_d"><span class="layer"></span><span class="p_text"><em>'+t+"</em></span></span>":""}function s(e){return'<span class="label_d"><span class="layer"></span><span class="p_text"><em>'+e+"</em></span></span>"}for(var i="",a="",n="",o=fish.all("#bqContent .line_info").length,l=fish.trim(fish.one(".searchbox .curr").html()),r=e.TagDesc,c=0,h=e.LineMessageMod.length;h>c;c++){var d=e.LineMessageMod[c],f=d.LineId,p=d.IshasRefid,u=d.MainTitle,m=d.SubTitle,v=d.IsTicket,_=d.IsGuoJi,g=d.IsTCRecommend,C=d.IsTCSpecialLine,y=d.IsBaoChuan,b=d.IntroImagePro,w=d.TagListModel.TagList,k=d.SailDateListModel.SailDateList,x=d.GoodSatisfacstr,T=d.Satisfacstr,j=d.TravelSimpIntro,D=d.CruiseName,I=(d.IsUseRed,d.Prize),P=d.IsPromtion,S=d.PromotionTitle,L=d.PackageCount,O=d.OnPtName,M=d.DownPtName,N=d.DepartureCity,R="/youlun/tours-"+f+".html",F="",B="",A="",E="",H="",z="",U="",q="",G="",Y=d.IsBlankNote,$=d.BlankNote,J=d.BlankNoteFree;0==p?R:R+="#refid="+p;var K=(new Date).getTime(),W=new Date("2016/05/21").getTime(),V=new Date("2016/05/25").getTime(),Q=new Date("2016/06/20").getTime(),Z="";1==P&&K>=V&&Q>K&&(F+='<span class="hot616"></span>');var X="同程旅游联合境内外优质供应商为用户甄选提供更专业更高品质的产品。";1==C?F+='<span class="tczx">同程专线'+s(X)+"</span>":F;var ee='<span class="bc_tcW none"><span class="arr_top"></span><span class="bc_tcM"><em class="p_text">码头接送，方便贴心<br/>专属客服，热情专业<br/>主题活动，独家特色<br/>精选领队，服务周到</em></span></span>',te=1==y?'<span class="icon_bc">'+ee+"</span>":"";if(w&&w.length>0)for(var se=0;se<w.length;se++)F+="<span>"+w[se]+t(w[se])+"</span>";if(1==Y){var ie=J>0?"，免息"+J+"期":"",ae="可分"+$+"期支付"+ie+"，出游更超值！";F+="<span>分期付款"+s(ae)+"</span>"}var ne="“定格幸福，有爱就购了” 5月20日当天，在同程全平台，下单并当天支付的用户享受双人房型立返￥200/人";if(W>K&&(F+='<span class="th520">520特惠'+s(ne)+"</span>"),q="_tcTraObj._tcTrackEvent('zxyl_2','pc邮轮列表', 'pc邮轮列表页点击线路', '^listview^"+l+"^"+(o+c+1)+"^"+D+"^"+f+"^"+C+"^');",k&&k.length>0){var oe=k.length;if(oe>3){for(var le=0;3>le;le++)B+="<em>"+k[le]+"</em>";B+='<span class="more up" _attr-id="'+f+'">更多<i></i></span>'}else for(var le=0;oe>le;le++)B+="<em>"+k[le]+"</em>"}T&&T>0&&(z='<span class="dp_count"><em>'+T+"条</em>点评</span>"),x&&x>0&&(U='<span class="good"><em>'+x+"%</em>满意</span>"),L>0?H='<em class="lb">礼包</em>':H,H+=1==P&&S?'<span><em class="yh">优惠</em>'+S+'</span><a class="yhmore" href="'+R+'" onclick="'+q+'" target="_blank">更多优惠>></a>':'<em class="tese">特色</em>'+m,1==v&&2==_?(H="",E+='<p class="date">上船港口：<em class="dowm">'+O+"</em>下船港口：<em>"+M+"</em></p>"):H='<p class="tip">'+H+"</p>",F.length&&(F="<p class='label'> "+F+"</p>"),j&&(A='<p class="plans">行程概况：<em title="'+j+'">'+j+"</em></p>"),G='<div class="line_info" _asIndex="'+(o+c+1)+'" _lineId="'+f+'">                                        <div class="info_l">                                            <div class="map">                                                '+Z+'<img src="'+b+'" alt="'+u+'">                                                <p>'+D+'</p>                                            </div>                                        </div>                                        <div class="info_r">                                            <div class="info_cont">                                                <div class="tit">                                                    <a href="'+R+'" onclick="'+q+'" title="'+u+'" target="_blank">'+u+"</a> "+te+"                                                </div>                                                "+F+"                                                "+A+"                                                "+H+"                                                "+E+'                                                <p class="date"><span class="locationcity">'+N+"出发</span>出发日期：                                                    "+B+'                                                </p>                                                <div class="info_right">                                                    <span class="lineprice"><strong>&yen;<em>'+I+'</em></strong>起</span>                                                    <a class="linebtn" href="'+R+'" onclick="'+q+'" target="_blank">查看详情</a>                                                    <p class="review">                                                        '+z+"                                                        "+U+'                                                    </p>                                                </div>                                            </div>                                        </div>                                    <div class="calendar none"></div>                                <div class="clearfix"></div></div>',1==g?n+=G:a+=G}return i='<div class="rsConList recommed">'+n+'</div>                   <div class="rsConList">'+a+"</div>"}function u(){var e=fish.cookie.get("searchHistory"),t="";if(e){if(e.indexOf("||")>-1)for(var s=e.split("||"),i=0;i<s.length;i++)t+="<a>"+s[i]+"</a>";else t+="<a>"+e+"</a>";fish.all(".history a").html("remove"),fish.one(".history").removeClass("none").html("bottom",t)}else fish.one(".history").addClass("none");fish.one(".clearHistory").on("click",function(){fish.cookie.set({name:"searchHistory",value:"",path:"/youlun"}),fish.one(".history").addClass("none")}),fish.all(".history a").on("click",function(){var e=fish.one(this).html();fish.one(".searchinput").val(e).css("color:#333;"),fish.one(".autoComplete").removeClass("none"),l(encodeURIComponent(e))}),fish.all(".history a").each(function(e,t){this.index=t,fish.one(e).on("click",function(e){var t=fish.one(this);searchTrackEvent("/sbox/k/history",{k:encodeURIComponent(t.html()),pos:this.index+1,jpTp:1})})})}function m(){var e=fish.all(".calendar_box .scut_sty .year_sty").length,t=196*e,s=t-392;fish.one(".rqslider").css("width:"+t+"px;"),e>2&&fish.all(".sliderBtn").removeClass("none"),fish.all(".sliderBtn").on("click",function(){var e=fish.one(this),t=parseInt(fish.one(".rqslider").attr("attr-left"),10);fish.all(".sliderBtn").removeClass("prevBtnN").removeClass("nextBtnN"),e.hasClass("prevBtnN")||e.hasClass("nextBtnN")||(e.hasClass("prevBtn")?(t=0>=t-196?0:t-196,fish.one(".rqslider").attr("attr-left",t).anim("left:"+-t+"px;",500),0==t?fish.one(".prevBtn").addClass("prevBtnN"):fish.one(".prevBtn").removeClass("prevBtnN")):e.hasClass("nextBtn")&&(t=t+196>=s?s:t+196,fish.one(".rqslider").attr("attr-left",t).anim("left:"+-t+"px;",500),t==s?fish.one(".nextBtn").addClass("nextBtnN"):fish.one(".nextBtn").removeClass("nextBtnN")))})}function v(e,t){fish.ajax({url:"/youlun/CruiseTours/CruiseToursAjax_book.aspx?Type=GetToursDataList&lineid="+t,data:"IsSearchPromotion=1",type:"json",sync:!0,fn:function(t){_(e,t)}})}function _(e,t){var s=fish.one(".calendar",e.parent(".line_info")),i=fish.one("a",e.parent(".line_info")).attr("href");fish.require("Calendar",function(){var e=fish.parseDate(t[0].LineDate),a=fish.parseDate(t[t.length-1].LineDate),n=e.getFullYear(),o=e.getMonth()+1,l=e.getDate(),r=a.getFullYear(),c=a.getMonth()+1,h=a.getDate(),d=n+"-"+o+"-"+l,f=r+"-"+c+"-"+h,p=new fish.Calendar({monthNum:2,wrapper:s,style:"show",startDate:d,endDate:f,mode:"rangeFrom",currentDate:[d,f],buildContent:function(e,s,a){S.build(e,s,a,t,i)}});p.pick({startDate:d,endDate:f,mode:"rangeFrom",currentDate:[d,f],buildContent:function(e,s,a){S.build(e,s,a,t,i)}})})}function g(){var e=fish.one("#cruiseid").val(),t=window.location.href,s="/youlun"+t.split("/youlun")[1];fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=CruiseStrategyStatistic&Url="+s+"&pagetype=AdvancedSearchPage&cruiseid="+e,type:"json",fn:function(e){}})}function C(e){return/^1[3,4,5,7,8]\d{9}$/i.test(e)}function y(){if(b("2016/06/02 00:00:00","2016/06/20 00:00:00")){fish.one(".workendactive").removeClass("none");var e=localStorage.lastOpenTime||0;0==e||e!=fish.parseDate()?(localStorage.lastOpenTime=fish.parseDate(),fish.one(".bonus_box").css({left:0}),fish.one(".aside_tag").css({left:"-136px;"})):(fish.one(".bonus_box").css({left:"-100%;"}),fish.one(".aside_tag").css({left:0}))}b("2016/06/02 00:00:00","2016/06/09 00:00:00")&&(fish.one(".searchSale").attr("href","http://www.ly.com/zhuanti/youlundashiji"),fish.one(".searchSale img").attr("src","http://img1.40017.cn/cn/y/16/h/3.0.3/dashijian.gif")),fish.one(".bonus_form a").on("click",function(){if(!fish.one(this).hasClass("getting")){var e=fish.trim(fish.one(".phone").val()),t=fish.trim(fish.one(".code").val());if(!C(e))return void fish.one(".bonus_tip").html("<span>亲，请输入正确手机号</span>").removeClass("none");if(""==t)return void fish.one(".bonus_tip").html("<span>亲，请输入正确验证码</span>").removeClass("none");fish.one(this).addClass("getting"),fish.ajax({url:"/youlun/CruiseRedPacket/CruiseRedPacketajax.aspx?type=GetGiftPacketByMobile&mobile="+e+"&checkCode="+t,type:"json",fn:function(e){var t="/youlun/CruiseRedPacket/CruiseRedPacketajax.aspx";return fish.one(".bonus_form img").attr("src",t+"?type=GetRedPackCheckCode&module=1&height=40&width=60&r="+Math.random()),5==e.ResultCode?(fish.one(".bonus_tip").html("<span>亲，请输入正确验证码</span>").removeClass("none"),fish.one(".code").val(""),void fish.one(".bonus_form a").removeClass("getting")):void(0==e.ResultCode?(fish.all(".bonus_bg,.bonus_box").addClass("none"),fish.all(".bonus_mask,.bonus_suc").removeClass("none"),fish.one(".bonus_form a").removeClass("getting")):3==e.ResultCode&&(fish.all(".bonus_bg,.bonus_box").addClass("none"),fish.all(".bonus_mask,.bonus_suc").removeClass("none"),fish.one(".bonus_suc img").attr("src","http://img1.40017.cn/cn/y/15/h/hb2.jpg?v=1"),fish.one(".bonus_form a").removeClass("getting")))}})}}),fish.all(".phone,.code").on("focus",function(){fish.one(".bonus_tip").addClass("none")}),fish.one(".bonus_form img").on("click",function(){fish.one(".code").val("");var e="/youlun/CruiseRedPacket/CruiseRedPacketajax.aspx";fish.one(".bonus_form img").attr("src",e+"?type=GetRedPackCheckCode&module=1&height=40&width=60&r="+Math.random())}),fish.all(".bonus_suc .close,.use").on("click",function(){fish.all(".bonus_bg,.bonus_box").anim("left:-100%",800,function(){fish.one(".aside_tag").anim("left:0px;",200)}),fish.all(".bonus_mask,.bonus_suc").addClass("none")}),fish.one(".bonus_box .close").on("click",function(){fish.all(".bonus_bg,.bonus_box").anim("left:-100%",800,function(){fish.all(".bonus_bg,.bonus_box").addClass("none"),fish.one(".aside_tag").anim("left:0px;",200)})}),fish.one(".aside_tag").on("click",function(){var e=fish.one(this).width();fish.one(".aside_tag").anim("left:-"+e+"px;",200,function(){fish.all(".bonus_bg,.bonus_box").removeClass("none").anim("left:0%",800)})}),fish.browser("ms")&&fish.all(".bonus_box input").each(function(){var e=fish.one(this).attr("placeholder");fish.one(this).val(e).css({color:"#666"}).on("focus",function(){fish.one(this).val()==e&&fish.one(this).val("")}).on("blur",function(){""==!fish.one(this).val()?fish.one(this).css({color:"#333"}):fish.one(this).val(e)})})}function b(e,t){var s=new Date,i=new Date(e),a=new Date(t),n=s.getTime(),e=i.getTime(),t=a.getTime();return n>e&&t>n}fish.admin.config({Calendar:{v:"0.3",css:1,g:20140333106},mPage:{v:"0.5.4",g:20130111,css:1}});var w=a(),k=fish.one(".searchConditonLab").attr("data-dest"),x={},T=0;String.prototype.getLineId=function(){return this.split("-")[1].split(".")[0]},String.prototype.addParams=function(e){var t=this,s="";if("object"==typeof e)for(var i in e)e[i]&&(s+="&"+i+"="+e[i]);return s&&(t+=t.indexOf("?")>-1?s:"?"+s.substring(1,s.length)),t};var j=function(){if(!(T>0)){var e=fish.one(".searchConditonLab"),a={},n=new i;a.HxId=e.attr("data-hxid"),a.HxCid=e.attr("data-hxcname"),a.CompanyId=e.attr("data-companyid"),a.CruiseId=e.attr("data-cruiseid"),a.HarbourId=e.attr("data-harbourid"),a.DateId=e.attr("data-dateid"),a.DayNum=e.attr("data-daynumid"),x=a={SearchCondition:n.encode(encodeURIComponent(JSON.stringify(a)))};var o={PageType:"AdvancedSearchPage",Userid:"undefined"==typeof getMemberId?0:getMemberId(),Lid:w,Url:encodeURIComponent(location.href),v:(new Date).getTime()};o=s(o,a),fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=CruiseSpecialStatistic",data:t(o),openType:"post",fn:function(){T++}})}},D=function(e){var t=e,s=t.length;if(!(1>s)){for(var i=[],a=[],n="",o=0;s>o;o++){var l=t[o].getAttribute("href")?t[o].getAttribute("href").getLineId():"";i.push(l),a.push({ind:o,lid:l})}n=i.join(",");var r=x;fish.ajax({url:"/youlun/AjaxCall_Cruise.aspx?Type=GenerateSpecialStatisticKey",data:"LineIds="+n+"&lid="+w+"&v="+(new Date).getTime(),type:"json",timeout:8e3,fn:function(e){if(e&&e.length>0)for(var s=0,i=e.length;i>s;s++)for(var n=0,o=a.length;o>n;n++)if(a[n].lid==e[s].LineId&&e[s].Key){var l=t[a[n].ind].getAttribute("href");if(t[a[n].ind].getAttribute("href").indexOf("Key")>-1)continue;var c=l.addParams({Key:e[s].Key}).addParams(r);t[a[n].ind].setAttribute("href",c)}},err:function(){},onTimeout:function(){}})}};window.bindLid=function(e){if(e&&e.length)for(var t=0,s=e.length;s>t;t++){var i=e[t],a=i.getAttribute("href");if(a){var n=a.addParams({lid:w});i.setAttribute("href",n)}}},fish.ready(function(){var e=fish.one(".searchConditonLab"),t=e.attr("data-tcspeicalflag");e&&1==e.length&&t&&"1"==t&&(fish.one(".pre_tc i").removeClass("none"),fish.one(".pre_tc").attr("attr-chiose",1)),f(),j(),y()}),fish.one(".top_link").on("click",function(){window.scrollTo(0,0)}),window.onscroll=function(){var e=document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop,t=fish.one(".cond_tab"),s=t.offset().top;fish.one(".box_tab");e>s?(fish.one(".cond_tab_filterbox").css({position:"fixed",top:0,"z-index":10}),fish.one(".box_tab").css({position:"fixed",top:0,"z-index":10})):(fish.one(".cond_tab_filterbox").css({position:""}),fish.one(".box_tab").css({position:""})),fish.one(window).scrollTop()>50?fish.one(".top_link").removeClass("none"):fish.one(".top_link").addClass("none")},fish.one(".wx_link").on("mouseover",function(){fish.one(".app_fix").removeClass("none")}).on("mouseout",function(){fish.one(".app_fix").addClass("none")}),fish.one(".back").mFix({showType:"top",bottom:150,right:50});var I=(new Date).getTime(),P=new Date("2016/05/21").getTime();P>I?fish.one("#search").val("有爱❤出发").css("color:#333"):""==k&&fish.one("#search").val(fish.one("#search").attr("attr-value")),n(),fish.one("#search").on("blur",function(){var e=fish.trim(fish.one(this).val()),t=fish.one(this).attr("attr-value");
""==e?fish.one(this).val(t).css("color:#999;"):fish.one(this).css("color:#333;")}).on("keyup",function(e){var t=fish.getEvent(e),s=t.keyCode?t.keyCode:e.which;13==s&&(o(),trackEventUseCookie({lable:"/sbox/k"}));var i=this.value,a=new RegExp("[/\\~!@#$%^&*_={}[];:'\"|,.<>?！￥……——｛｝【】；：‘“’”、《》，。、？]","g");this.value=i.replace(a,"");var n=encodeURIComponent(this.value);""==n?(fish.one(this).css("color:#999;"),fish.one(".hotCity").removeClass("none"),fish.one(".autoComplete").addClass("none")):(fish.one(".hotCity").addClass("none"),fish.one(this).css("color:#333;"),fish.one(".autoComplete").removeClass("none"),l(n))}),fish.one(".toSearch").on("click",function(){trackEventUseCookie({lable:"/sbox/k"}),o()}),fish.all(".hotword a").on("click",function(){var e=fish.one(this).attr("href"),t=encodeURIComponent(fish.one(this).html());r(e,t)}),fish.all(".cond_tab_conbox dl").each(function(){"hxid"==fish.one(this).attr("attr-param")&&(fish.one(this).height()>41?(fish.one(".pack_up",this).css("display:block").html("更多<em></em>"),fish.one(".pack_up",this).addClass("pack_down"),fish.one("dd",this).addClass("hidden_dd")):fish.one(".pack_up",this).css("display:none")),"companyid"==fish.one(this).attr("attr-param")&&(fish.one(this).height()>41?(fish.one(".pack_up",this).css("display:block").html("更多<em></em>"),fish.one(".pack_up",this).addClass("pack_down"),fish.one("dd",this).addClass("hidden_dd")):fish.one(".pack_up",this).css("display:none")),"cruiseid"==fish.one(this).attr("attr-param")&&(fish.one(this).height()>41?(fish.one(".pack_up",this).css("display:block").html("更多<em></em>"),fish.one(".pack_up",this).addClass("pack_down"),fish.one("dd",this).addClass("hidden_dd")):fish.one(".pack_up",this).css("display:none")),"harbourid"==fish.one(this).attr("attr-param")&&(fish.one(this).height()>41?(fish.one(".pack_up",this).css("display:block").html("更多<em></em>"),fish.one(".pack_up",this).addClass("pack_down"),fish.one("dd",this).addClass("hidden_dd")):fish.one(".pack_up",this).css("display:none")),"dateid"==fish.one(this).attr("attr-param")&&(fish.one(this).height()>41?(fish.one(".pack_up",this).css("display:block").html("更多<em></em>"),fish.one(".pack_up",this).addClass("pack_down"),fish.one("dd",this).addClass("hidden_dd")):fish.one(".pack_up",this).css("display:none"))}),fish.all(".cond_tab_conbox a").on("click",function(){if(!fish.one(this).hasClass("on")){var e=fish.dom(this).parentNode,t=fish.dom(e).parentNode,s=(fish.one(this).attr("id"),fish.one(t).attr("attr-param")),i=(fish.one("dt",t).html(),fish.one(this).attr("title"));fish.all("a",e).removeClass("on"),fish.one(this).addClass("on"),c("全部"==i?s:s)}}),fish.all(".a_chioce").on("click",function(e){if(searchTrackEvent("/sort",{k:encodeURIComponent(fish.one(".searchConditonLab").attr("data-dest"))}),fish.one(this).hasClass("rank")||!fish.one(this).hasClass("active")){var t=fish.getTarget(e),s=t.className;s&&s.indexOf("salessort")>-1?(fish.all(".a_chioce").removeClass("active"),fish.one(".salesPrice").addClass("active"),"价格从低到高"==t.innerHTML?(fish.one(".salesPrice").attr("price_info",1),fish.one(".salesPrice font").html("价格从低到高")):(fish.one(".salesPrice").attr("price_info",0),fish.one(".salesPrice font").html("价格从高到低")),fish.one(".comment").html("满意度"),fish.one(".dates").attr("price_info",1),fish.one(".dates font").html("航期<i></i>"),f()):s&&s.indexOf("comment")>-1?(fish.all(".a_chioce").removeClass("active"),fish.one(".comment").addClass("active").html("满意度从高到低"),fish.one(".salesPrice").attr("price_info",0),fish.one(".salesPrice font").html("价格<i></i>"),fish.one(".dates").attr("price_info",1),fish.one(".dates font").html("航期<i></i>"),f()):s&&s.indexOf("datessort")>-1?(fish.all(".a_chioce").removeClass("active"),fish.one(".dates").addClass("active"),"航期从近到远"==t.innerHTML?(fish.one(".dates").attr("date_info",0),fish.one(".dates font").html("航期从近到远")):(fish.one(".dates").attr("date_info",1),fish.one(".dates font").html("航期从远到近")),fish.one(".comment").html("满意度"),fish.one(".salesPrice").attr("price_info",0),fish.one(".salesPrice font").html("价格<i></i>"),f()):s&&s.indexOf("all")>-1&&(fish.all(".a_chioce").removeClass("active"),fish.one(".all").addClass("active"),fish.one(".comment").html("满意度"),fish.one(".salesPrice").attr("price_info",0),fish.one(".salesPrice font").html("价格<i></i>"),fish.one(".dates").attr("price_info",1),fish.one(".dates font").html("航期<i></i>"),f())}}).on("mouseover",function(){fish.one("ul",this).removeClass("none")}).on("mouseout",function(){fish.one("ul",this).addClass("none")}),fish.one(".pre_tc").on("click",function(){fish.one("i",this).hasClass("none")?(fish.one("i",this).removeClass("none"),fish.one(this).attr("attr-chiose",1)):(fish.one("i",this).addClass("none"),fish.one(this).attr("attr-chiose",0)),f()}),fish.all(".pre_tc .pre_icon").hover(function(){fish.one(".pre_tcW").removeClass("none")},function(){fish.one(".pre_tcW").addClass("none")}),fish.one(".tehui").on("click",function(){fish.one("i",this).hasClass("none")?(fish.one("i",this).removeClass("none"),fish.one(this).attr("attr-chiose",1)):(fish.one("i",this).addClass("none"),fish.one(this).attr("attr-chiose",0)),f()}),fish.one(".cond_tab_filterbox").delegate("em","click",function(e){var t=fish.getTarget(e);fish.all("i",t).hasClass("none")?(fish.one("i",t).removeClass("none"),fish.one(t).attr("attr-chiose",1)):(fish.one("i",t).addClass("none"),fish.one(t).attr("attr-chiose",0)),"I"==t.tagName.toUpperCase()&&(fish.one(t).parent().attr("attr-chiose",0),fish.one(t).addClass("none")),fish.one(".hide_sale").removeClass("show"),f()});var S={};S.year=[],u(),fish.one("#bqContent").on("click",function(e){var t=fish.getTarget(e);do{var s=t.className;if(s&&s.indexOf("more")>-1){var i=fish.one(t);if(i.hasClass("up")){if(i.removeClass("up").addClass("down").html("收起<i></i>"),fish.one(".calendar",i.parent(".line_info")).removeClass("none"),""==fish.one(".calendar",i.parent(".line_info")).html()){var a=i.attr("_attr-id");v(i,a)}return}if(i.hasClass("down"))return i.removeClass("down").addClass("up").html("更多<i></i>"),void fish.one(".calendar",i.parent(".line_info")).addClass("none");break}if(s&&s.indexOf("mainLeft")>-1)break}while(t=t.parentNode)}),S.tmpl='<a class="dayjh" href="{dataHref}" target="{dataTarget}"><span class="date">{dateStr}</span><span class="dataprice">{priceStr}</span></a>',S.build=function(e,t,s,i,a){for(var n,o,l,r=t.getTime(),c=[],h=0,d=i.length-1;d>=h;h++){n=i[h];var f=Date.parse(n.LineDate.replace(/\-/gi,"/"));if(f>=r&&r+864e5>f){o=n;break}}o||(o={}),o.dateStr=s?s:t.getDate(),o.LineDate?(o.priceStr="&yen;"+o.MinPrice,o.dataHref=a.split(".html")[0]+"_"+i[h].LineDate+".html"+a.split(".html")[1],o.dataTarget="_blank"):(c.push("invalid-day"),o.dataHref="javascript:void(0);",o.dataTarget="_self"),l=this.tmpl.replace(/{(\w+)}/g,function(e,t){return o[t]||""}),e.innerHTML=l,fish.one(e).addClass(c.join(" "))},fish.browser("webkit")?fish.all("#active a").hover(function(){fish.one(".active_bg",this).anim("opacity: 1;",300)},function(){fish.one(".active_bg",this).anim("opacity: 0;",300)}):fish.browser("ms")&&fish.all("#active a").hover(function(){fish.one(".active_bg",this).anim("filter:alpha(opacity=50);",300)},function(){fish.one(".active_bg",this).anim("filter:alpha(opacity=0);",300)}),fish.one(".hot_search").on("click",function(){fish.one(".search_cont").removeClass("none")}),fish.one("body").on("click",function(e){var t=fish.getTarget(e);do{var s=t.className;if(s&&s.indexOf("hot_search")>-1)break;if(fish.dom("body")==t){fish.one(".search_cont").addClass("none");break}}while(t=t.parentNode)}),fish.all(".download_raiders",fish.one(".l_center")).on("click",function(){g()})}(),function(e){function t(e){var t={showCon:fish.one(""),shadowBg:fish.one(""),clickBgClose:!0,closeBut:fish.one(""),closeAfterFn:function(e,t){},showBeforeFn:function(e,t){}};fish.lang.extend(t,e);var s=t,i={show:function(){s.showBeforeFn(s.showCon,s.shadowBg),s.shadowBg.removeClass("none"),s.showCon.removeClass("none")},close:function(){s.shadowBg.addClass("none"),s.showCon.addClass("none"),s.closeAfterFn(s.showCon,s.shadowBg)}};return s.closeBut.on("click",function(){i.close()}),s.clickBgClose===!0&&s.shadowBg.on("click",function(){i.close()}),i}function s(e){if(!e||!e[0])return!1;var t=e.width(),s=e.height();e.css("position:fixed;left:50%;top:50%;marginLeft:"+-t/2+"px;marginTop:"+-s/2+"px;")}fish.admin.config({Calendar:{v:"0.3",css:"0.3",g:2015032101}});var i={init:function(){this.formConBox=t({showCon:fish.one(".tj_con_box"),shadowBg:fish.one(".tj_shadow"),closeBut:fish.one(".tj_con_box .s_close"),showBeforeFn:function(e,t){s(e)}}),this.msgForm=t({showCon:fish.one(".tj_alert_box"),shadowBg:fish.one(".tj_shadow"),closeBut:fish.one(".tj_alert_box .alert_close"),showBeforeFn:function(e,t){s(e)}}),this.cruiseObj.init(),this.tripDateObj.init(),this.codeObj.init(),this.bindEvent()},restAllInput:function(){for(var e=fish.all(".dl_tj_cos dl dd input"),t=0,s=e.length;s>t;t++){var i=fish.one(e[t]);i.attr("_placeholder")?i.addClass("place_holder").val(i.attr("_placeholder")):i.val("")}fish.one(".dl_tj_cos dl dd span.no_enter").removeClass("checked"),this.tripDateObj.noDateflag=!1,fish.all(".dl_tj_cos dl dd").removeClass("has_error"),this.codeObj.resetCode()},bindEvent:function(){var e=this,t=fish.one(".dl_tj_cos a.sub_data"),s=fish.all(".dl_tj_cos dl.eve_yusuan dd input,.dl_tj_cos dl.cust_name dd input,.dl_tj_cos dl.cust_mobile dd input,.dl_tj_cos dl.code dd input");this.inputObj.bindPlaceHolder(s),this.inputObj.filterKeyUp(fish.one(".dl_tj_cos dl.travel_num dd input"),"[^\\d]",3),this.inputObj.filterKeyUp(fish.one(".dl_tj_cos dl.eve_yusuan dd input"),"[^\\d]",13),t.on("click",function(){return t.hasClass("sub_no_act")?!1:void(e.subCheck()&&(t.addClass("sub_no_act").html("提交中..."),fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx",data:"action=SpecialReserOrder&"+e.getInputDataToStr(),openType:"post",type:"json",fn:function(s){if(t.removeClass("sub_no_act").html("提交"),!s)return e.alertMsgFn(0),!1;switch(s.ResultCode){case-100:i.msgCtrl.show(fish.dom(".dl_tj_cos dl.code dd input"),"验证码输入错误！");break;case 1:e.alertMsgFn(1),e.restAllInput();break;case 8:e.alertMsgFn(2),e.restAllInput();break;default:e.alertMsgFn(0)}}})))}),fish.one(".tj_alert_box .s_con").delegate(".close_but","click",function(){e.msgForm.close()}),fish.one(".l_box .but_tjyy").on("click",function(){var t=fish.dom(".ylc-nav .ylc-special-price");return t?(t.click(),e.statcClick(),!1):(e.cruiseObj.drawLine(),e.formConBox.show(),void e.statcClick())}),fish.all(".dl_tj_cos dl.cust_name dd input,.dl_tj_cos dl.cust_mobile dd input,.dl_tj_cos dl.code dd input").on("focus",function(){e.msgCtrl.close(this)})},inputObj:{bindPlaceHolder:function(e){return e&&e[0]?void e.on("focus",function(){var e=fish.one(this);thisVal=e.val(),thisPlaceHolder=e.attr("_placeholder"),thisVal==thisPlaceHolder&&e.hasClass("place_holder")&&e.val("").removeClass("place_holder")}).on("blur",function(){var e=fish.one(this);thisVal=e.val(),thisPlaceHolder=e.attr("_placeholder"),thisVal.length<=0&&e.val(thisPlaceHolder).addClass("place_holder")}):!1},filterKeyUp:function(e,t,s){if(!(e&&e[0]&&t&&s))return!1;var i=new RegExp(t,"g");e.on("keyup",function(){var e=fish.one(this),t=e.val().substr(0,s).replace(i,"");e.val(t)})}},msgCtrl:{show:function(e,t){return!e||!t||t.length<=0?!1:($parent=fish.one(e).parent("dd"),$parent.addClass("has_error"),void fish.one(".err_msg",$parent[0]).html("<i></i>"+t))},close:function(e){return e?($parent=fish.one(e).parent("dd"),$parent.removeClass("has_error"),void fish.one(".err_msg",$parent[0]).html("<i></i>")):!1}},cruiseObj:{init:function(){this.bindEvent()},bindEvent:function(){var e=fish.one(".dl_tj_cos dl.route_port  dd .s_line_con"),t=fish.one(".dl_tj_cos dl.route_port dd input");t.addClass("scon_tar_show"),t.on("click",function(){e.removeClass("none")}),e.addClass("scon_tar_show").delegate(".line_con_body .as_s","click",function(s){var i=fish.one(fish.getTarget(s));t.removeClass("place_holder").val(i.attr("_value")),e.addClass("none")}),fish.one(document).on("click",function(t){var s=fish.getTarget(t),i=fish.one(s),a=i.parent(".scon_tar_show");return i.hasClass("scon_tar_show")||a.length>=1?!0:void e.addClass("none")}),fish.one(".line_con_head .sps_close",e[0]).on("click",function(){e.addClass("none")})},drawLine:function(){return this.drawLineHasData?!1:(this.drawLineHasData=!0,void fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx?action=SearchRouteData",type:"json",fn:function(e){if(!e||!e[0])return!1;for(var t="",s=0,i=e.length;i>s;s++)t+='<span class="as_s" _value="'+e[s].CrName+'">'+e[s].CrName+"</span>";fish.one(".dl_tj_cos dl.route_port  dd .s_line_con .line_con_body").html(t)}}))}},tripDateObj:{init:function(){this.bindEvent(),this.noDateflag=!1},bindEvent:function(){var e=this,t=fish.one(".dl_tj_cos dl.tour_date dd input.input_start_date"),s=fish.one(".dl_tj_cos dl.tour_date dd input.input_end_date"),i=fish.one(""),a=fish.one("");fish.one(".dl_tj_cos dl dd span.no_enter").on("click",function(){var i=fish.one(this);i.hasClass("checked")?(i.removeClass("checked"),e.noDateflag=!1):(i.addClass("checked"),t.val(t.attr("_placeholder")).addClass("place_holder"),s.val(s.attr("_placeholder")).addClass("place_holder"),e.noDateflag=!0)}),fish.require("Calendar",function(){var n=new Date;n.setFullYear(n.getFullYear()+5),t.on("focus",function(o){if(e.noDateflag)return!1;i.html("remove");var l=new fish.Calendar({skin:"white",style:"show",wrapper:fish.all(".dl_tj_cos dl.tour_date dd .s_show_div")[0],elem:this,startDate:new Date,endDate:s.val()&&s.val()!=s.attr("_placeholder")?new Date(new Date(s.val().replace(/-/g,"/")).getTime()-864e5):n,fn:function(o,l,r,c,h){i.addClass("none"),t.removeClass("place_holder"),s.removeClass("place_holder");var d=new Date(o+"/"+l+"/"+r).getTime()+864e5;a.html("remove");var f=new fish.Calendar({skin:"white",style:"show",wrapper:fish.all(".dl_tj_cos dl.tour_date dd .s_show_div")[1],startDate:new Date(d),endDate:n,elem:s[0],currentDate:[new Date(d)],fn:function(e,t,s,i,n){a.addClass("none")}});a=fish.one(f.panel),a.parent(".s_show_div").addClass("tar_cal_jenvent"),a.css("position:absolute;top:30px;left:0;z-index:2;"),e.setCalPosition(a)}});i=fish.one(l.panel),i.parent(".s_show_div").addClass("tar_cal_jenvent"),i.css("position:absolute;top:30px;left:0;z-index:2;"),e.setCalPosition(i)}),s.on("focus",function(i){if(e.noDateflag)return!1;var o=t.val()&&t.val()!=t.attr("_placeholder")?new Date(new Date(t.val().replace(/-/g,"/")).getTime()+864e5):new Date((new Date).getTime()+864e5);a.html("remove");var l=new fish.Calendar({skin:"white",style:"show",wrapper:fish.all(".dl_tj_cos dl.tour_date dd .s_show_div")[1],elem:this,startDate:o,endDate:n,fn:function(e,t,i,n,o){s.removeClass("place_holder"),a.addClass("none")}});a=fish.one(l.panel),a.parent(".s_show_div").addClass("tar_cal_jenvent"),a.css("position:absolute;top:30px;left:0;z-index:2;"),e.setCalPosition(a)})}),fish.one(document).on("click",function(e){var t=fish.one(fish.getTarget(e)),s=t.parent(".tar_cal_jenvent");return t.hasClass("tar_cal_jenvent")||s.length>=1?!1:(i.addClass("none"),void a.addClass("none"))}),t.on("click",function(e){a.addClass("none")}),s.on("click",function(e){i.addClass("none")})},setCalPosition:function(e){var t=e.parent(".tj_con_box"),s=fish.one(window).width(),i=t.width(),a=e.width(),n=e.offset().left+a-t.offset().left-i,o=(s-i)/2-n;0>o&&e.css("left:"+o+"px;")}},calCreateFn:function(e){},codeObj:{init:function(){this.getCodeFlag=!0,this.bindEvent()},bindEvent:function(){var e=this;fish.one(".dl_tj_cos dl.code dd span.get_code").on("click",function(){i.checkObj.checkPhone()&&e.getCodeFlag===!0&&(e.getCode(),e.timerCode(6e4))})},getCode:function(){fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx",data:"action=GetSmsAuthCode&custMobile="+fish.one(".dl_tj_cos dl.cust_mobile dd input").val(),fn:function(){}})},timerCode:function(e){var t=this,s=fish.one(".dl_tj_cos dl.code dd span.get_code"),i=fish.one("span i",s[0]),a=e||3e4,n=500;this.timerD=setInterval(function(){0>=a&&(t.getCodeFlag=!0,s.removeClass("no_active"),clearInterval(timerD)),i.html(Math.round(a/1e3)),a-=n},n),i.html(Math.round(a/1e3)),this.getCodeFlag=!1,s.addClass("no_active")},resetCode:function(){var e=fish.one(".dl_tj_cos dl.code dd span.get_code"),t=fish.one("span i",e[0]);this.getCodeFlag=!0,e.removeClass("no_active"),t.html("0"),this.timerD&&clearInterval(this.timerD)}},subCheck:function(){return this.checkObj.checkName()&this.checkObj.checkPhone()&this.checkObj.checkCode()},checkObj:{checkName:function(){var e=fish.one(".dl_tj_cos dl.cust_name dd input"),t=/^[^@\/\'\\\"#$%&\^\*\(!\^\*\;\:\>\<\-\|]+$/,s=fish.trim(e.val()),a=fish.trim(e.attr("_placeholder"));return s=e.hasClass("place_holder")&&s==a?"":s,s.length<=0?(i.msgCtrl.show(e[0],"请填写联系人姓名！"),!1):t.test(s)?(i.msgCtrl.close(e[0]),!0):(i.msgCtrl.show(e[0],"姓名中包含非法字符！"),!1)},checkPhone:function(){var e=fish.one(".dl_tj_cos dl.cust_mobile dd input"),t=/^(13[0-9]|15[0-9]|17[0-9]|18[0-9]|147)\d{8}$/,s=fish.trim(e.val()),a=fish.trim(e.attr("_placeholder"));return s=e.hasClass("place_holder")&&s==a?"":s,s.length<=0?(i.msgCtrl.show(e[0],"请输入手机号！"),!1):t.test(s)?(i.msgCtrl.close(e[0]),!0):(i.msgCtrl.show(e[0],"请输入正确的手机号！"),!1)},checkCode:function(){var e=fish.one(".dl_tj_cos dl.code dd input"),t=fish.trim(e.val()),s=fish.trim(e.attr("_placeholder"));return t=e.hasClass("place_holder")&&t==s?"":t,t.length<=0?(i.msgCtrl.show(e[0],"请输入验证码！"),!1):(i.msgCtrl.close(e[0]),!0)}},getInputDataToStr:function(){for(var e=fish.all(".dl_tj_cos input"),t="",s=0,i=e.length;i>s;s++){var a=fish.one(e[s]),n=a.attr("_placeholder"),o=a.hasClass("place_holder")&&a.val()==n?"":a.val(),l=a.attr("name");t+="&"+l+"="+encodeURIComponent(o)}return t.substr(1)},alertMsgFn:function(e){var t="";switch(e){case 2:t='<h4 class="h4_txt">亲~您已经提交过哦</h4>					        <p class="ps">客服将尽快联系您<br/>请不要拒接0512开头的电话</p>					        <span class="msg_dbg success_sbg"></span>					        <span class="close_but">关闭</span>';break;case 0:t='<h4 class="h4_txt">提交失败！</h4>					        <span class="msg_dbg fail_sbg"></span>					        <span class="close_but">关闭</span>';break;case 1:t='<h4 class="h4_txt">通知预约成功！</h4>					        <p class="ps">客服将尽快联系您<br/>请不要拒接0512开头的电话</p>					        <span class="msg_dbg success_sbg"></span>					        <span class="close_but">关闭</span>'}t.length>=0&&(fish.one(".tj_alert_box .s_con").html(t),this.formConBox.close(),this.msgForm.show())},statcClick:function(){var e=fish.one("#hidIsFinalPage").val();fish.ajax({url:"/youlun/CruiseRequireOrder/HomePageRequireOrder.ashx?action=SpecialReserClick&isFinal="+e,fn:function(){}})}};fish.one(document).ready(function(){i.init()})}(window),function(e){function t(e,t){if(t.k&&(t.k=decodeURIComponent(t.k)),t.ct&&(t.ct=decodeURIComponent(t.ct)),!e||!e.trim())return!1;var s="";for(key in t)null!==t[key]&&void 0!==t[key]&&""!==t[key]&&(s+="|*|"+key+":"+t[key]);try{s.length>0&&(s+="|*|"),_tcTraObj._tcTrackEvent("search","/cruises/list",e,s)}catch(i){}}function s(e){var s={type:1,lable:"",value:{}};fish.lang.extend(s,e);var i=s.lable.replace(/\//g,"_");1==s.type?fish.cookie.set(i,1):2==s.type&&1==fish.cookie.get(i)&&(fish.cookie.remove(i),t(s.lable,s.value))}String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},fish.all(".hotSearch a").each(function(e,s){this.index=s,fish.one(e).on("click",function(e){var s=this;$this=fish.one(this),t("/sbox/k/hot",{k:encodeURIComponent($this.html()),pos:s.index+1,jpTp:1})})}),fish.all(".hotword a").each(function(e,s){this.index=s,fish.one(e).on("click",function(e){var s=this;$this=fish.one(this),t("/sbox/k/hot",{k:encodeURIComponent($this.html()),pos:s.index+1,jpTp:1})})}),fish.one("body").delegate(".cond_tab_filterbox .tehui,.cond_tab_filterbox .pre_tc,#baochuan,.cond_tab_conbox dd a,.allSearchList a,.condition_box .scut_sty .link_sty","click",function(e){s({lable:"/filter"})}),fish.one("body").delegate(".line_info a.linebtn,.line_info .tit a","click",function(e){var i=e.target,a=fish.one(i).parent(".line_info");t("/detail",{k:encodeURIComponent(fish.one(".searchConditonLab").attr("data-dest")),pjId:"2007",resId:a.attr("_lineId")}),s({lable:"/show"})}),e.searchTrackEvent=t,e.trackEventUseCookie=s}(window);